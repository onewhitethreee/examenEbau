{
    "version": "https://jsonfeed.org/version/1",
    "title": "",
    "home_page_url": "https://onewhitethreee.github.io/examenEbau/",
    "description": "EXAMEN EBAU Blog",
    "items": [
        {
            "id": "use-nuxt3-build-api-server",
            "content_html": "<p>挺早之前就想写个 api 接口服务，封装下自己收集的一些 api 接口，以便调用，正好最近在接触 SSR 框架，所以就使用 <a href=\"https://v3.nuxtjs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Nuxt3</a> 来编写该项目。</p><p>在线地址: <a href=\"https://api.kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">KZ API</a></p><p>开源地址: <a href=\"https://github.com/kuizuo/api-service\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/api-service</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/KZ%20API.png\" alt=\"KZ API\" class=\"img_ev3q\"></p><p>如果你已经了解过 Nuxt3 与运行过程，那么可以直接跳转至 <a href=\"#%E5%AE%9E%E6%88%98\">实战</a></p><p><a href=\"https://v3.nuxtjs.org/getting-started/quick-start#new-project\" target=\"_blank\" rel=\"noopener noreferrer\">Quick Start</a></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npx nuxi init nuxt3-app</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可能会安装不上 会提示 <code>could not fetch remote https://github.com/nuxt/starter</code>，大概率就是本地电脑无法访问 github，这时候科学上网都不一定好使，这里建议尝试更换下网络或设置 host 文件。</p><p>安装完毕后，根据提示安装依赖与启动项目</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220714005704602.png\" alt=\"image-20220714005704602\" class=\"img_ev3q\"></p><p>初始的 nuxt3 项目及其简单，甚至没有 page、components、assets 等目录。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220714003726413.png\" alt=\"image-20220714003726413\" class=\"img_ev3q\"></p><p>关于 nuxt3 本文不做过多介绍，本文只对部分进行介绍。nuxt 已经发布快 1 年了，相信外面很多相关介绍文章。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nuxt3-介绍\">Nuxt3 介绍<a class=\"hash-link\" href=\"#nuxt3-介绍\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://v3.nuxtjs.org/guide/concepts/introduction#why-nuxt\" target=\"_blank\" rel=\"noopener noreferrer\">What is Nuxt? </a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自动导入\">自动导入<a class=\"hash-link\" href=\"#自动导入\" title=\"标题的直接链接\">​</a></h3><p>nuxt.js 与 next.js 极其相像，但 nuxt 却精简许多，这归功于 nuxt 的<a href=\"https://v3.nuxtjs.org/guide/concepts/auto-imports\" target=\"_blank\" rel=\"noopener noreferrer\">自动导入</a>，这可以让你无需导入像 vue 中的 ref 等等函数，导入组件等操作，不过前提是代码文件位置要符合 nuxt 规范。如果你尝试使用过 vite 的一些自动导入插件，其效果是一样的，只不过 nuxt 都已经配置好，开箱即用。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"文件路由\">文件路由<a class=\"hash-link\" href=\"#文件路由\" title=\"标题的直接链接\">​</a></h3><p>pages 为 nuxt 中页面所存放的位置，会将 pages 目录下的文件(<code>.vue</code>, <code>.js</code>, <code>.jsx</code>, <code>.ts</code> or <code>.tsx</code>) 与路由映射，像<code>pages/index.vue</code> 映射为 <code>/</code>，然后在 app.vue 中通过<code>&lt;NuxtPage/&gt;</code> 来展示 pages。</p><p>要注意，<strong>pages 下的文件一定要有根节点</strong>，不然在路由切换的时候可能会出现问题（事实上建议所以的 vue 组件都有根节点，虽说 vue3 允许多个根节点，但或多或少存在一定问题）</p><p>至于<a href=\"https://v3.nuxtjs.org/guide/directory-structure/pages\" target=\"_blank\" rel=\"noopener noreferrer\">动态路由与嵌套路由</a>，文档说明的比较详细了，这里就不费口舌了</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"服务引擎\">服务引擎<a class=\"hash-link\" href=\"#服务引擎\" title=\"标题的直接链接\">​</a></h3><p>Nuxt3 中的的 api 接口服务引擎使用的是<a href=\"https://nitro.unjs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">⚗️ Nitro</a> 的 JavaScript 服务，使用的是<a href=\"https://github.com/unjs/h3\" target=\"_blank\" rel=\"noopener noreferrer\">h3</a>的 http 框架（相当于 hook 版的 http 框架），不过文档不是特别详细，很多东西都要琢磨。（这个框架是真的相对冷门，之前都未曾听闻过）</p><p>关于 Nuxt3 的服务具体可以看 <a href=\"https://v3.nuxtjs.org/guide/features/server-routes/\" target=\"_blank\" rel=\"noopener noreferrer\">Nuxt 3 - Server Routes</a>，这里演示部分代码</p><p>创建一个服务，创建文件<code>server/api/hello.ts</code></p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/api/helloWord.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'hello nuxt'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>请求 http://localhost/api/hello 便可得到<code>hello nuxt</code>，在 event 可以得到 req 与 res 对象。不过在 req 身上是获取不到 query 和 body 的，这里需要使用 h3 提供的 hooks，如<code>useMethod()</code>,<code>useQuery()</code>,<code>useBody()</code>来获取，例如。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">eventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> body </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useBody</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">User updated!</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这与传统的 node 的 http 框架不同点就是 query,body 这些参数不是从函数的上下文(context)取，而是通过 hook 来获取，所以这就是我为什么我说这相当于 hook 版的框架。关于这些 api，可以<a href=\"https://www.jsdocs.io/package/h3#package-functions\" target=\"_blank\" rel=\"noopener noreferrer\">点我查看</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据获取\">数据获取<a class=\"hash-link\" href=\"#数据获取\" title=\"标题的直接链接\">​</a></h3><p>定义完了接口，那必然是要获取数据的，nuxt.js 有四种方式来获取数据，不过主要就二种<code>useFetch</code>与<code>useAsyncData</code>，另外两种是其懒加载形式。</p><p>像上面定义了 helloworld 接口就可以像下面这样使用</p><div class=\"language-vue codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-vue codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;script setup&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">const { data } = await useFetch('/api/hello')</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">console.log(data) // hello nuxt</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/script&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;template&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  {{ data }}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/template&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>useAsyncData</p><div class=\"language-vue codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-vue codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;script setup&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">const { data } = await useAsyncData('hello', () =&gt; $fetch('/api/hello'))</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">console.log(data) // hello nuxt</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/script&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;template&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  {{ data }}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/template&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>至于 useAsyncData 与 useFetch 有什么区别的话，如果请求的是 url 资源，那么建议使用 useFetch，如果请求的是其他来源的资源，就使用 useAsyncData。可以说在请求 url 资源时，两者是等价的，如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">useFetch(url) &lt;==&gt; useAsyncData(url, () =&gt; $fetch(url))</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>那么如何 SSR(服务端渲染)呢？ <code>nuxt3</code> 默认是全 <code>SSR</code> 的渲染模式，也就是说在上面的数据请求后就是 SSR 渲染，客户端接受到的也就是带有数据页面。</p><p>如果要使用传统的客户端渲染只需要填加一个 options 的 server 参数为 false 即可，如</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> data </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useFetch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'/api/hello'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> server</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>自己尝试下将 server 切换，然后打开控制台-&gt;网络中查看 Fetch/XHR 中是否有和数据相关的请求便可知道是在服务端发送的请求数据，还是客户端发送的数据。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实战\">实战<a class=\"hash-link\" href=\"#实战\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"模板\">模板<a class=\"hash-link\" href=\"#模板\" title=\"标题的直接链接\">​</a></h3><p>这个项目所使用的模板是 <a href=\"https://github.com/antfu/vitesse-nuxt3\" target=\"_blank\" rel=\"noopener noreferrer\">Vitesse for Nuxt 3</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/vitesse-nuxt3.png\" alt=\"vitesse-nuxt3\" class=\"img_ev3q\"></p><p>该模板中集成了一些 vue 生态的相关模块(vueuse, pinia, unocss)，开发者可以不必自行封装这些模块。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"页面设计\">页面设计<a class=\"hash-link\" href=\"#页面设计\" title=\"标题的直接链接\">​</a></h3><p>页面设计的话其实没啥好说的，主要使用到了原子类的一个框架<a href=\"https://github.com/unocss/unocss\" target=\"_blank\" rel=\"noopener noreferrer\">unocss</a>。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"接口转发\">接口转发<a class=\"hash-link\" href=\"#接口转发\" title=\"标题的直接链接\">​</a></h3><p>这里我会以通过<a href=\"https://v1.hitokoto.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">每日一言</a>的 api 例子来给你演示其功能实现，请求该 api 可以得到</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5233</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"uuid\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"9504a2a2-bab7-4c7d-b643-a6642ed5c55e\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"hitokoto\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"人间没有单纯的快乐，快乐总夹带着烦恼和忧虑。\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"d\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"from\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"杨绛\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"from_who\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"我们仨\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"creator\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"a632079\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"creator_uid\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1044</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"reviewer\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4756</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"commit_from\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"web\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"created_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1583786494\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"length\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">22</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里创建<code>server/api/one.ts</code>文件</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/api/one.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useQuery</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">fetch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'https://v1.hitokoto.cn/'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'json'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> data</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setHeader</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'Content-Type'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text/html;charset=utf-8'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">hitokoto</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这样，这个接口就已经定义完毕了，此时访问 <a href=\"http://localhost:3000/api/one\" target=\"_blank\" rel=\"noopener noreferrer\">/api/one</a> 所得到的就是一句短语。默认状态下返回文本，如需要 json 数据等额外信息，则可添加<code>type=json</code>。例请求<code>/api/one?type=json</code>，得到的完整数据如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">7173</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"uuid\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"49eff9ca-7145-4c5f-8e62-d3dca63537fa\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"hitokoto\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"即使人生是一场悲剧，也应该笑着把人生演完。\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"k\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"from\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"查拉图斯特如是说\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"from_who\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"尼采\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"creator\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Kyanite\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"creator_uid\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8042</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"reviewer\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"commit_from\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"web\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"created_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1614946509\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"length\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">21</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>而这整个过程也就是其实也就是接口转发，将访问 <code>/api/one</code> 的请求转发给目标 url <a href=\"https://v1.hitokoto.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">https://v1.hitokoto.cn/</a> 的过程，然后对其数据进行抽取和封装，最终展示给调用方。</p><p>然而这只是完成了接口的转发，那么接口的文档又该如何实现呢？</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"接口文档\">接口文档<a class=\"hash-link\" href=\"#接口文档\" title=\"标题的直接链接\">​</a></h3><p>要存储接口文档的数据，就需要使用 CMS(内容管理系统)或者 Database(数据库)，一开始我原本打算使用<code>strapi</code>来作为 CMS，毕竟没尝试过<code>strapi</code>，而且 SSR 框架也会搭配<code>strapi</code>来使用，不需再自建后端。但就在我刷<a href=\"https://modules.nuxtjs.org/?category=CMS&amp;version=3.x\" target=\"_blank\" rel=\"noopener noreferrer\">官方模块</a>的时候，无意间发现个官方模块 <a href=\"https://content.nuxtjs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">content</a>。简单了解了一下，发现这个模块有点意思，并且能很简单的满足我当下的需求，于是就选择使用它。也可以使用官方提供的<a href=\"https://codesandbox.io/s/github/nuxt/starter/tree/content\" target=\"_blank\" rel=\"noopener noreferrer\">codesandbox</a>来尝试</p><p>不过<code>content</code>能实现的功能比较有限，没有<code>strapi</code>那么丰富，有多有限呢，基本的 CURD 只能实现查，无法增删改（至少官方文档是没有提供相应的函数）。不过<code>content</code>也不用像<code>strapi</code>那样自建一个服务，可以说是贼简洁了。</p><p>这里省略模块的导入的步骤，在根目录下创建 content 目录，目录下的文件可以是<code>markdonw</code>，<code>json</code>，<code>yaml</code>，<code>csv</code>。和 pages 一样，这里的文件都会映射对应的路由，不过这里需要映射的路由前缀是<code>/api/_content/query/</code>。举个例子</p><div class=\"tabs-container tabList__CuJ\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs\"><li role=\"tab\" tabindex=\"0\" aria-selected=\"true\" class=\"tabs__item tabItem_LNqP tabs__item--active\">content/hello.json</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LNqP\">output</li></ul><div class=\"margin-top--md\"><div role=\"tabpanel\" class=\"tabItem_Ymn6\"><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Hello Content v2!\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"The writing experience for Nuxt 3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"announcement\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div><div role=\"tabpanel\" class=\"tabItem_Ymn6\" hidden=\"\"><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_path</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/hello'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_draft</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_partial</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">title</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Hello Content v2!'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">description</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'The writing experience for Nuxt 3'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">category</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'announcement'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'content:hello.json'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'json'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_source</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'content'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_file</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'hello.json'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">_extension</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'json'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div></div></div><p>访问<code>/api/_content/query/hello</code>所得到的就是 output 的内容。</p><p>这里只演示 json 数据，是因为该项目主要用到 json 数据来渲染，如果是 markdown 的话，还有一些自带的组件 ContentDoc 来展示 markdown 数据。所提供的功能可以说非常适合用于文档类，或者博客类的站点。</p><p>回到该实战本身，来说明实际数据及其如何请求，上面的例子所对应的 api 文档数据如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"one\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"一言\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"desc\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"一言指的就是一句话，可以是动漫中的台词，也可以是网络上的各种小段子\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"path\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/api/one\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"method\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"GET\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"params\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"type\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"value\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"json\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"string\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"desc\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"数据格式(text,json,img)\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"required\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"dataType\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"text\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"example\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/api/one\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后这些数据通过 content 提供的<a href=\"https://content.nuxtjs.org/api/composables/query-content\" target=\"_blank\" rel=\"noopener noreferrer\">queryContent()</a>来获取，这里来看其渲染页面<code>pages/apidoc/[id].vue</code>的部分代码</p><div class=\"language-vue codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">pages/apidoc/[id].vue</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-vue codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;script setup lang=\"ts\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">const { data } = await useAsyncData(id, () =&gt; queryContent(id).findOne())</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">const { name, desc, params, path, method, returnType, example } = data.value</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">// ...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/script&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>获取到数据，然后渲染到 vue 上，这些就不过多叙述了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"接口限流\">接口限流<a class=\"hash-link\" href=\"#接口限流\" title=\"标题的直接链接\">​</a></h3><p>假设现在上线了这些接口，但是不做任何限制，那么调用方就可以无限次调用获取接口，这对服务器压力来说是十分巨大的，所以就需要对接口进行限流。</p><p>一般要做限流操作都需要涉及到中间件，在 Nuxt 中有<a href=\"https://v3.nuxtjs.org/guide/directory-structure/middleware\" target=\"_blank\" rel=\"noopener noreferrer\">路由中间件</a>，和<a href=\"https://v3.nuxtjs.org/guide/features/server-routes#server-middleware\" target=\"_blank\" rel=\"noopener noreferrer\">服务中间件</a> ，这里由于是要处理后端接口的，所以就需要使用服务中间。</p><p>创建<code>server/middleware/limit.ts</code> 文件</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/middleware/limit.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token builtin\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">limit</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这时候，只要是 Fetch 请求都将打印<code>limit</code>，既然请求能拦截到，那限流就简单了（其实并不简单，因为这个 h3 的文档与相关库实在是少的可怜）。</p><p>不过由于没有使用到用户鉴权等功能（在这个项目中也没打算上），所以限流的操作只有从 IP 的手段下手。这里我选用的是<a href=\"https://github.com/animir/node-rate-limiter-flexible\" target=\"_blank\" rel=\"noopener noreferrer\">node-rate-limiter-flexible</a>这个库，下面是实现代码</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/middleware/limit.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> RLWrapperBlackAndWhite</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> RateLimiterMemory </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'rate-limiter-flexible'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> rateLimiter </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">RLWrapperBlackAndWhite</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  limiter</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">RateLimiterMemory</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    points</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    duration</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getIP</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'x-forwarded-for'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">socket</span><span class=\"token operator\" style=\"color:#66d9ef\">?.</span><span class=\"token plain\">remoteAddress </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">replace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'::ffff:'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">^\\/api\\/[A-Za-z0-9].*</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">url </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> ip </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getIP</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> rateLimiter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">consume</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">statusCode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">429</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> statusCode</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">429</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> statusMessage</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'请求太快了,请稍后再试'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>自行阅读代码即可，设置的限制是 1 秒内只能请求 1 条接口。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"接口缓存\">接口缓存<a class=\"hash-link\" href=\"#接口缓存\" title=\"标题的直接链接\">​</a></h3><p>除了接口限流外，对于实时性不高的接口可以开启缓存，这样可以防止过度调用导致接口匮乏。并且对于重复调用的接口响应速度更快，性能更佳。</p><p>可 nuxt 的中间件好像只能拦截用户端发送的请求数据，而服务端发送的给用户端的数据貌似无法拦截，也就无法在中间件中获取到数据或者处理数据了？</p><p>是的，nuxt 的服务层并不像<a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">nest</a>有 Middleware(中间件),Guards(守卫),Interceptors(拦截器)，而这里所要拦截的部分也就是 nest 中的 Interceptors。</p><p><img loading=\"lazy\" src=\"https://docs.nestjs.com/assets/Interceptors_1.png\" alt=\"img\" class=\"img_ev3q\"></p><p>不过 nuxt 只提供了中间件，这够实现接口缓存的功能了，不过需要一些“技巧”，关于这个技巧我写过的一篇文章 <a href=\"https://kuizuo.cn/js/JS%E5%87%BD%E6%95%B0hook\" target=\"_blank\" rel=\"noopener noreferrer\">JS 函数 hook</a> 比较详细的介绍该技巧，这里简单说下。</p><p>假设有个 add 函数，我并不想破坏 add 的参数与内部代码结果，但是我又像在调用 add 函数时，查看传入的参数，以及计算的结果，那该如何做？来看下面代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> original_add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> add</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> original_add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> result</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>首先重新定义了与 add 相同作用的函数，名为 original_add，然后将 add 修改，同时修改像成上面的代码。这时尝试调用 add 就可以发现输出了传入的参数及计算后的结果。</p><p>知道了这个修改 add 函数的技巧，要拦截 nuxt 的服务端数据也就不难了。只需要将这里的 add 函数替换成 http 框架的返回函数即可，也就是<code>res.end()</code>。大致逻辑如下</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/middleware/cache.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> original_res_end </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">end</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function-variable function\" style=\"color:#e6db74\">end</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">args</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 这里的args的第一个参数就是 res.end 调用的参数，即返回给客户端的数据</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token builtin\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 最后可别忘了调用原始的 res.end，不然客户端一直处于等待状态</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">original_res_end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里所使用到的缓存库是<a href=\"https://github.com/isaacs/node-lru-cache\" target=\"_blank\" rel=\"noopener noreferrer\">lru-cache</a>，其实现代码如下</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/middleware/cache.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> ServerResponse </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'h3'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> defaultContentType </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'h3'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">LRU</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'lru-cache'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> options </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  max</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">500</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ttl</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1000</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">60</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 缓存1min</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  allowStale</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  updateAgeOnGet</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  updateAgeOnHas</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> cache </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name constant\" style=\"color:#e6db74\">LRU</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">options</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">defaultContentType</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text/plain; charset=utf-8'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">^\\/api\\/[A-Za-z0-9].*</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">url </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> key </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">url</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> cached </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cached</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cached</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> original_res_end </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">end</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function-variable function\" style=\"color:#e6db74\">end</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">args</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> ServerResponse </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> args</span><span class=\"token operator\" style=\"color:#66d9ef\">?.</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">original_res_end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>现在缓存是实现了，但所有的接口都被强行缓存 1 分钟，像有些接口（如随机图片）要是也这样设定，那就失去了这个接口的实时性了（我明明要随机，你却偏偏返回都是同一张图片）。所以就要对不同的接口进行不同的接口缓存处理，这里就可以使用到上下文 context。</p><p>定义接口代码</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/api/test.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">defineEventHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">cache </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> ttl</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1000</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 缓存5s</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ... 其他代码 ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>定义缓存代码</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server/middleware/cache.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ... 其他代码 ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> options </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">cache</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> options</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这样就可以为不同的接口，设置不同的缓存配置。（不过这样还是不够优雅，其实可以上装饰器的，但是想了想这也非 AOP 设计，于是就没尝试了）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"异常捕获\">异常捕获<a class=\"hash-link\" href=\"#异常捕获\" title=\"标题的直接链接\">​</a></h3><p>这个功能主要用途是有些接口可能失效了，就需要捕获这些异常接口信息然后停止或者修改该接口。如果要在每个接口上都定义 try catch，接口数量一多将难以维护，所以需要一个服务端全局异常捕获。</p><p>不过目前 Nuxt3 还不支持捕获服务端的异常，这里是<a href=\"https://v3.nuxtjs.org/guide/features/error-handling/#errors-during-api-or-nitro-server-lifecycle\" target=\"_blank\" rel=\"noopener noreferrer\">官网说明</a>。所以该功能暂时未实现，后续也有可能通过 Test 来测试接口可靠性，而不是全局捕获异常接口。</p><p>不过 Nuxt3 对客户端的错误处理做得比较好，有个<a href=\"https://v3.nuxtjs.org/examples/app/error-handling#error-handling\" target=\"_blank\" rel=\"noopener noreferrer\">演示示例</a>。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"后续功能\">后续功能<a class=\"hash-link\" href=\"#后续功能\" title=\"标题的直接链接\">​</a></h3><p>由于 content 模块，以及 Nuxt3 后端服务的一些限制，导致一些功能就暂未实现，后续再考虑引入其他方案来实现</p><ul class=\"contains-task-list containsTaskList_mC6p\"><li class=\"task-list-item\"><input type=\"checkbox\" disabled=\"\"> <!-- -->接口计次</li><li class=\"task-list-item\"><input type=\"checkbox\" disabled=\"\"> <!-- -->接口分类</li><li class=\"task-list-item\"><input type=\"checkbox\" disabled=\"\"> <!-- -->代码示例</li><li class=\"task-list-item\"><input type=\"checkbox\" disabled=\"\"> <!-- -->ip 白名单</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"收集接口\">收集接口<a class=\"hash-link\" href=\"#收集接口\" title=\"标题的直接链接\">​</a></h3><p>就此整个项目的核心功能就已经实现完毕了，接下来要做的就是收集 api 接口，写 api 文档了。然而这部分也是最头疼的部分，因为在互联网上很难有免费的资源。</p><p>像大部分的 api 接口，如果数据来源不是自己的，名义上“免费”的，那大概率就是有限制，例如一天只能 100 条，1 分钟只能请求几次等等，而且这类接口多半是需要填写一个 app_ey 的参数。而需要登录才能获取，当然，你可以选择加钱来增加限额，那么就不再是免费的了。总之就是各种不方便</p><p>如果真想实现免费无限制，那么数据来源只能在自己身上，至于数据来源如何转化成自己的，懂得都懂好吧。</p><p>所以在本项目仅可能的收集一手文档的资源接口或是自行封装的功能接口，但也会存在一些调用别人封装过的接口，服务端的接口信息可自行在<code>server/api</code>中查看，由于一些接口的安全性而言，线上的部分接口代码并未公布，这很正常，因为我并不想泄露一些关键数据。</p><p>如果接口调用有涉及侵权相关的还请直接联系作者删除。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署项目\">部署项目<a class=\"hash-link\" href=\"#部署项目\" title=\"标题的直接链接\">​</a></h2><p>本地打包</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run build</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>等待打包完毕，将打包后生成的.output 文件夹放到服务器上（依赖都无需安装，.output 文件里有 node_modules），执行</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">node .output/server/index.mjs</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>即可运行项目，或者也可以使用 pm2，总之和常见的 node 部署没什么差异。</p><p>此外也可部署到云提供商，像 AWS，Netlify，Vercel 等，所支持的<a href=\"https://v3.nuxtjs.org/guide/deploy/presets#supported-hosting-providers\" target=\"_blank\" rel=\"noopener noreferrer\">服务商</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"坑点\">坑点<a class=\"hash-link\" href=\"#坑点\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"打包失败\">打包失败<a class=\"hash-link\" href=\"#打包失败\" title=\"标题的直接链接\">​</a></h3><p>cherrio中的parse5包无法打包至生成环境，提示如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">WARN  Could not resolve import \"parse5/lib/parser/index.js\" in ~\\.pnpm\\hast-util-raw@7.2.1\\node_modules\\hast-util-raw\\lib\\index.js using exports defined in ~\\parse5\\package.json.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>我猜测是因为hast-util-raw包和cheerio的parse5冲突，而nuxt服务端的nitro在用rollup打包时没有将两者冲突部分合并，而是选择前者，这就导致生产环境下cheerio无法使用。我尝试搜索没有得到一个很好结果，而我的解决方案是降级cherrio版本至0.22.0，因为这个版本中没有引入parse5。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"版本切换\">版本切换<a class=\"hash-link\" href=\"#版本切换\" title=\"标题的直接链接\">​</a></h3><p>在我最终准备上线的时候，发现nuxt又有新版本了，于是我将项目从rc.4升级到rc.6，然后再次测试的时候，发现在动态路由页面切换的时候，无法正常的向后端发送请求，甚至都监听不到路由变化，相当于页面被缓存了。</p><p>其实这也侧面说明了，目前 Nuxt3 的兼容性是比较差的。</p><p>实际上还有一些，不过解决相对比较迅速，就没写上。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>体验了一周的 Nuxt3，整个的开发过程不敢说特别顺利，因为存在一定的兼容和Bug。目前 Nuxt3 的目前还处于 rc 版，实际项目还得考虑上线。不过个人还是非常推荐 Nuxt 这个框架，在代码编写与开发体验上实在是太香了，不出意外后续的 web 项目都会采用 Nuxt3 来构建，期待正式版的发布。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/use-nuxt3-build-api-server",
            "title": "基于Nuxt3的API接口服务网站",
            "summary": "挺早之前就想写个 api 接口服务，封装下自己收集的一些 api 接口，以便调用，正好最近在接触 SSR 框架，所以就使用 Nuxt3 来编写该项目。",
            "date_modified": "2022-07-20T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "nuxt",
                "vite",
                "vue",
                "ssr"
            ]
        },
        {
            "id": "next.js-build-and-deploy",
            "content_html": "<p>官方文档 <a href=\"https://nextjs.org/docs/getting-started\" target=\"_blank\" rel=\"noopener noreferrer\">Getting Started | Next.js (nextjs.org)</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装\"><a href=\"https://nextjs.org/docs/getting-started#automatic-setup\" target=\"_blank\" rel=\"noopener noreferrer\">安装</a><a class=\"hash-link\" href=\"#安装\" title=\"标题的直接链接\">​</a></h2><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npx create-next-app@latest --ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># or</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">yarn create next-app --typescript</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># or</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">pnpm create next-app --ts</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>运行</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run dev</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>访问 http://localhost:3000</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目结构\">项目结构<a class=\"hash-link\" href=\"#项目结构\" title=\"标题的直接链接\">​</a></h2><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220712030637300.png\" alt=\"image-20220712030637300\" class=\"img_ev3q\"></p><table><thead><tr><th>文件</th><th>内容</th></tr></thead><tbody><tr><td>pages</td><td>页面文件</td></tr><tr><td>pages/api</td><td>api 数据接口</td></tr><tr><td>public</td><td>静态资源文件</td></tr><tr><td>styles</td><td>样式文件</td></tr><tr><td>next-env.d.ts</td><td>确保 typescript 支持</td></tr><tr><td>next.config.ts</td><td>next 配置文件</td></tr></tbody></table><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"路由\">路由<a class=\"hash-link\" href=\"#路由\" title=\"标题的直接链接\">​</a></h2><p>nextjs 有一个基于页面概念的文件系统路由器，存放在 pages 下<code>.js</code>, <code>.jsx</code>, <code>.ts</code>, <code>.tsx</code> 文件都将作为组件，即<strong>文件路径 → 页面路由</strong>，例如这里的 index.tsx 映射为 index，<code>pages/about.js</code> 将映射为 <code>/about</code>。</p><p>同时还支持动态路由，创建<code>pages/user/[id].tsx</code>文件，然后访问<code>user/1</code>，<code>user/2</code></p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">[id].tsx</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> useRouter </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'next/router'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> router </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useRouter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> router</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">query</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">User id:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">User</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此时访问 http://localhost:3000/user/1 便可得到 <code>User ID: 1</code></p><p>在 router 对象下没有 param 属性，都是存放在 query 参数中，例如访问 user/1?username=kuizuo，此时的 query 值为 <code>{username: 'kuizuo', id: '2'}</code></p><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</h5></div><div class=\"admonition-content\"><p>不过这里有个比较有意思的点，如果你在上方代码中使用 console.log 打印 query 的话，在 vscode 中会打印出空对象<code>{}</code>，而在浏览器中会打印一次空对象，一次真实的 query 对象（并且打印两遍）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220712191356587.png\" alt=\"image-20220712191356587\" class=\"img_ev3q\"></p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据渲染\">数据渲染<a class=\"hash-link\" href=\"#数据渲染\" title=\"标题的直接链接\">​</a></h2><p>如果你打开控制台，查看所返回的页面，你会发现响应中只有 User id:，这不就和 react 的 CSR(客户端)渲染没有区别吗，是的，确实是这样。因为上一部分的代码，并且从输出 query 也可以看的出来而不是 SSR(服务端)渲染。首先我要展示一下两者渲染的代码</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"csr-客户端渲染\">CSR 客户端渲染<a class=\"hash-link\" href=\"#csr-客户端渲染\" title=\"标题的直接链接\">​</a></h3><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">[id].tsx</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> useEffect</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> useState </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'react'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> useRouter </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'next/router'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> router </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useRouter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> router</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">query</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> setData</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useState</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    username</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    email</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">useEffect</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">fetch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">https://jsonplaceholder.typicode.com/users/</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">id</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">setData</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">catch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">username:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">email:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">email</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">User</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>经常写 react 的肯定对上面的代码不陌生，前端向后端发送数据请求，接受到数据后赋值给 data，然后渲染出来。因为请求数据是需要耗时的，所以在页面显示完之后，会停顿一会在显示出数据（主要是我这边没写 loadding），并且由于 id 并不是第一时间获取到的（从上面的 id）。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220712193009186.png\" alt=\"image-20220712193009186\" class=\"img_ev3q\"></p><p>从这里来看，客户端渲染不仅要获取页面组件，还要请求数据，最终再通过 js 渲染出来</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ssr-服务端渲染\">SSR 服务端渲染<a class=\"hash-link\" href=\"#ssr-服务端渲染\" title=\"标题的直接链接\">​</a></h3><p>next 中服务端渲染需要用到 getServerSideProps 函数，而后端的数据获取都是在该函数内来获取，并通过 prop 传入给前端组件中，来看实际代码</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">[id].tsx</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> data </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">username:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">email:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">email</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">User</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getServerSideProps</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> query</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">query</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 这里context.param也能获取到id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">fetch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">https://jsonplaceholder.typicode.com/users/</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">id</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    props</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果从页面显示来看，确实没什么区别，但如果打开控制台就能发现诸多不同。</p><p>首先就是请求的页面，是直接包含数据，相当于返回你一个页面，而在客户端渲染则是返回一个组件，需要自己去请求数据来展示。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220712192713634.png\" alt=\"image-20220712192713634\" class=\"img_ev3q\"></p><p>同时查看控制台中的 Fetch/XHR 的是看不到请求的数据，因为这些数据并不是由前端发送的,而是由后端发送的（故不受跨域请求的限制）。</p><p>从这就能看出客户端渲染与服务端渲染的的区别了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ssg-静态生成\">SSG 静态生成<a class=\"hash-link\" href=\"#ssg-静态生成\" title=\"标题的直接链接\">​</a></h3><p>不过还没完，还有一个静态生成，先来看看代码。</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">[id].tsx</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> data </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">username:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">email:</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">email</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain-text\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">p</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">User</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getStaticProps</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> params</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">params</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">fetch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">https://jsonplaceholder.typicode.com/users/</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">id</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    props</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getStaticPaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    paths</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name builtin\" style=\"color:#e6db74\">Array</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">20</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">fill</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> params</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">String</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">i </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    fallback</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'blocking'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>主要是 getServerSideProps 替换成 getStaticProps，同时增加了一个 getStaticPaths 用于生成静态页面的，而上面的 getStaticPaths 表示生成 id 1 到 20 的页面，那假设如果我访问 id 为 21 的 user 呢？由于这里设置<code>fallback: 'blocking'</code>，所以还是会走服务端渲染的那一部分。但如果设置<code>fallback: fasle</code>，访问 user/21 就会提示 404。</p><p>通俗点来说就就是生成一系列静态页面，不需要服务端处理，所以返回的速度更快，其缺点其实也比较明显，数据的任何更改都需要在服务端重新构建，而服务端渲染则是可以动态处理数据，不需要完全重建。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"isr-增量式静态生成\">ISR 增量式静态生成<a class=\"hash-link\" href=\"#isr-增量式静态生成\" title=\"标题的直接链接\">​</a></h3><p>不做过多介绍，详看文档 <a href=\"https://nextjs.org/docs/basic-features/data-fetching/incremental-static-regeneration\" target=\"_blank\" rel=\"noopener noreferrer\">Data Fetching: Incremental Static Regeneration | Next.js (nextjs.org)</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"api-接口\">api 接口<a class=\"hash-link\" href=\"#api-接口\" title=\"标题的直接链接\">​</a></h2><p>上面的数据都是调用 <a href=\"http://jsonplaceholder.typicode.com/\" target=\"_blank\" rel=\"noopener noreferrer\">JSONPlaceholder</a> 所提供的虚拟数据，在 next 中要提供数据接口的话，只需要在 pages/api 下编写即可，生成的路由规则和组件一样。例如 pages/api/hello.ts 映射为 api/hello，浏览器访问<a href=\"http://localhost:3000/api/hello\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:3000/api/hello</a> 就可以得到<code>{\"name\": \"John Doe\"}</code></p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">hello.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">NextApiResponse</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'next'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Data</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">handler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">NextApiResponse</span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token maybe-class-name\">Data</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'John Doe'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里的 req、res 就是同大部分 node 后端框架一样，而这里的写法与 serverless 一致（这里应该就是 serverless）。</p><p>上述是 get 请求，那 post 请求呢？无论什么 http 请求方法都将在 handler 处理，通过 req.method 来获取请求方法，要区分的话可以通过如下代码。</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">handler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">method</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'POST'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Process a POST request</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Handle any other HTTP method</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"写一个简单的-crud\">写一个简单的 CRUD<a class=\"hash-link\" href=\"#写一个简单的-crud\" title=\"标题的直接链接\">​</a></h3><p>既然知道了上述的一些作用，不妨来个熟悉的 CRUD。这里以文章 post 为例</p><p>这里数据端使用的时 sqlite，配置不做展示，只展示主要核心功能</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">api/post/index.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> NextApiResponse </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'next'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> db </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'../../../lib/db'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">handler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> NextApiResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">method</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GET'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">all</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">select * from post</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'POST'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> content </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">body</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">insert into post(title, content) values(?, ?)</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> content</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">500</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">api/post/[id].ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> NextApiResponse </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'next'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> db </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'../../../lib/db'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">handler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> NextApiRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> NextApiResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">query</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> content </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">body</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">method</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GET'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">select * from post where id=$id</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> $id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Put'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">update post set title=?,content=? where id=?</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> content</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'DELETE'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">delete from post where id=$id</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> $id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">err</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">rows</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">500</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里为了符合 RESTFUL 风格，所以 post 下编写了两个文件，这时候请求<a href=\"http://localhost:3000/api/post/2\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:3000/api/post</a> 就能获取到所有文章数据，基本的 CRUD 也就实现了。</p><p>这里写 sql 是真滴繁琐，没使用 str 或是 typeorm 主要是不想把这个 demo 搞得太复杂，实际项目还是用上比较好。</p><p>当然这里只是作为后端 api 接口的演示，至于前端的展示与编写就和普通前端开发没啥大的区别。基本后端框架能做的，next 能做后端很多事情，更多的使用还是作为接口转发，中间件等，毕竟 Next 主要的强项还是服务端渲染的能力。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"打包部署\">打包部署<a class=\"hash-link\" href=\"#打包部署\" title=\"标题的直接链接\">​</a></h2><p>既然说到部署，那肯定离不开 nextjs 的母公司<a href=\"https://vercel.com\" target=\"_blank\" rel=\"noopener noreferrer\">Vercel</a>了，关于 Vercel 之前也写过相关文章，关于 Vercel 就不过多介绍。</p><p>nextjs 部署到 vercel 实在简单，将项目推送到 github 仓库中，然后在 vercel 中 New Project，接着选择 nextjs 的仓库，点击 Deploy，静等部署即可。关于部署可以看这篇文章 <a href=\"https://kuizuo.cn/develop/Vercel%E9%83%A8%E7%BD%B2%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2\" target=\"_blank\" rel=\"noopener noreferrer\">Vercel 部署个人博客</a></p><p>现在你可以通过访问 <a href=\"https://kz-next-app-demo.vercel.app/\" target=\"_blank\" rel=\"noopener noreferrer\">kz-next-app-demo.vercel.app</a> 来访问该项目，并尝试访问<code>/api/post</code>，<code>user/1</code>来看看。</p><p>只能说不愧是母公司。</p><p>至于其他部署？既然都用 nextjs 了，还考虑自建服务器来部署吗？</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>这次的整体过程比较简单，后续应该会使用 nextjs 编写一个完整的项目（<del>也有可能是 nuxt.js</del>)。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/next.js-build-and-deploy",
            "title": "Next.js项目搭建与部署",
            "summary": "官方文档 Getting Started | Next.js (nextjs.org)",
            "date_modified": "2022-07-13T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "next",
                "react",
                "ssr",
                "vercel"
            ]
        },
        {
            "id": "vscode-plugin",
            "content_html": "<p>自从使用过 VSCode 后就再也离不开 VSCode，其轻量的代码编辑器与诸多插件让多数开发者爱不释手。同样我也不例外，一年前的我甚至还特意买本《Visual Studio Code 权威指南》的书籍，来更进一步了解与使用。</p><p>在购买这本书时就想写一个 vscode 插件（扩展），奈何当时事务繁忙加之不知做何功能，就迟迟未能动手。如今有时间了，就顺带体验下 vscode 插件开发，并记录整个开发过程。</p><p>插件地址：<a href=\"https://marketplace.visualstudio.com/items?itemName=kuizuo.vscode-extension-sample\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"VSCode-extension\">VSCode-extension</a></p><p>开源地址：<a href=\"https://github.com/kuizuo/vscode-extension\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/vscode-extension (github.com)</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220711195038039.png\" alt=\"vscode-extension\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vscode-相关\">Vscode 相关<a class=\"hash-link\" href=\"#vscode-相关\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://marketplace.visualstudio.com/vscode\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"vscode应用商店\">vscode 应用商店</a></p><p><a href=\"https://code.visualstudio.com/api\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"vscode插件官方文档\">vscode 插件官方文档</a></p><p><a href=\"https://github.com/microsoft/vscode-extension-samples\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"vscode 官方插件例子\">vscode 官方插件例子</a></p><p>关于 Vscode 及其插件就不过多介绍，相信这篇文章 <a href=\"https://www.cnblogs.com/liuxianan/p/vscode-plugin-overview.html\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"VSCode插件开发全攻略（一）概览 - 我是小茗同学 - 博客园\">VSCode 插件开发全攻略（一）概览 - 我是小茗同学 - 博客园</a>能告诉你 Vscode 插件的作用。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"工具准备\">工具准备<a class=\"hash-link\" href=\"#工具准备\" title=\"标题的直接链接\">​</a></h2><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</h5></div><div class=\"admonition-content\"><p><strong>在开发前，建议关闭所有功能性扩展，以防止部分日志输出与调试效率</strong>。</p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vscode-插件脚手架\">vscode 插件脚手架<a class=\"hash-link\" href=\"#vscode-插件脚手架\" title=\"标题的直接链接\">​</a></h3><p>vscode 提供插件开发的脚手架 <a href=\"https://github.com/Microsoft/vscode-generator-code\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"vscode-generator-code\">vscode-generator-code</a> 来生成项目结构，选择要生成的类型</p><div class=\"language-shell codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">We</span><span class=\"token string\" style=\"color:#a6e22e\">'re constantly looking for ways to make yo better!</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">May we anonymously report usage statistics to improve the tool over time?</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">More info: https://github.com/yeoman/insight &amp; http://yeoman.io</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">========================================================================== Yes</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"display:inline-block;color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">     _-----_     ╭──────────────────────────╮</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">    |       |    │   Welcome to the Visual  │</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">    |--(o)--|    │   Studio Code Extension  │</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">   `---------´   │        generator!        │</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">    ( _´U`_ )    ╰──────────────────────────╯</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">    /___A___\\   /</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">     |  ~  |</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">   __'</span><span class=\"token plain\">.___.'__</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> ´   </span><span class=\"token variable\" style=\"color:#f8f8f2\">`</span><span class=\"token variable\" style=\"color:#f8f8f2\">  </span><span class=\"token variable operator\" style=\"color:#66d9ef\">|</span><span class=\"token variable\" style=\"color:#f8f8f2\">° ´ Y </span><span class=\"token variable\" style=\"color:#f8f8f2\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? What </span><span class=\"token builtin class-name\" style=\"color:#e6db74\">type</span><span class=\"token plain\"> of extension </span><span class=\"token keyword\" style=\"color:#66d9ef\">do</span><span class=\"token plain\"> you want to create? </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">Use arrow keys</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> New Extension </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">TypeScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Extension </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">JavaScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Color Theme</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Language Support</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Code Snippets</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Keymap</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Extension Pack</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Language Pack </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">Localization</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Web Extension </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">TypeScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  New Notebook Renderer </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">TypeScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>根据指示一步步选择，这里省略勾选过程，最终生成的项目结果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_StiMqQrFCi.png\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"运行-vscode-插件\">运行 vscode 插件<a class=\"hash-link\" href=\"#运行-vscode-插件\" title=\"标题的直接链接\">​</a></h3><p>既然创建好了工程，那必然是要运行的。由于我这里选择的 ts ＋ webpack 进行开发，所以是需要打包，同时脚手架已经生成好了对应.vscode 的设置。只需要按下 F5 即可开始调试，这时会打开一个新的 vscode 窗口，<code>Ctrl+Shift+P</code>打开命令行，输入<code>Hello World</code>，右下角弹出提示框<code>Hello World from kuizuo-plugin!</code></p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>注意: 由于是 webpack 开发，在调用堆栈中可以看到有两个进程，一个是 webpack，另一个是新开的插件窗口的，同时在该调试窗口也能查看调试输出信息。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_Yv4X32qLE5.png\" class=\"img_ev3q\"></p><p><strong>切记一定要等到第二个调试进程加载完毕</strong>（时间根据电脑性能而定），再打开命令行输入 Hello World 才会有命令，否则会提示 没有匹配命令。</p></div></div><p>至此，一个 vscode 的开发环境就已经搭建完毕，接下来就是了解项目结构，以及 vscode 插件的 api 了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码解读\">代码解读<a class=\"hash-link\" href=\"#代码解读\" title=\"标题的直接链接\">​</a></h3><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> vscode </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vscode'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">activate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ExtensionContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> disposable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">commands</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">registerCommand</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo-plugin.helloWorld'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showInformationMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'Hello World from kuizuo-plugin!'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">subscriptions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">disposable</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">deactivate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>vscode.commands.registerCommand</code>用于注册命令，<code>kuizuo-plugin.helloWorld</code> 为命令 ID，在后续<code>package.json</code>中要与之匹配。第二个参数为一个回调函数，当触发该命令时，弹出提示框。</p><p>在 package.json 中关注 activationEvents 与 contributes</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"activationEvents\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"onCommand:kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"contributes\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"commands\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Hello World\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>activationEvents 激活事件，<code>onCommand:kuizuo-plugin.helloWorld</code>中<code>kuizuo-plugin</code>是插件 ID 要与 extension.ts 中的注册命令匹配，<code>helloWorld</code>则是命令标识，而 onCommand 则是监听的类型，此外还有<code>onView</code>、<code>onUri</code>、<code>onLanguage</code>等等。</p><p>contributes 则是配置那些地方来显示命令，像官方的例子中，就是在 Ctrl + Shift + P 命令行中输入 Hello World 来调用<code>kuizuo-plugin.helloWorld</code> 命令。此外还可以设置按键与菜单</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"keybindings\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ctrl+f10\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"mac\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cmd+f10\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"editorTextFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"menus\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"editor/context\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"editorFocus\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"group\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"navigation\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>设置完毕后，可以按 Ctrl + Alt + O 或者命令行中键入 reload 来重启 vscode</p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>这里也要注意，如果重启后并无生效，请查看 package.json 是否配置正确（多一个逗号都不行），或者尝试重新调试。如果还不行，那么很有可能就是代码报错，但日志输出并没有，那么在弹出的新窗口中打开开发人员工具（Ctrl+Alt+I 或帮助 → 切换开发人员工具），这里有报错相关的提示信息。</p><p>建议查看<a href=\"https://www.cnblogs.com/liuxianan/p/vscode-plugin-develop-tips.html\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"VSCode插件开发全攻略（六）开发调试技巧\">VSCode 插件开发全攻略（六）开发调试技巧</a></p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"功能\">功能<a class=\"hash-link\" href=\"#功能\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"首次启动弹窗与配置项\">首次启动弹窗与配置项<a class=\"hash-link\" href=\"#首次启动弹窗与配置项\" title=\"标题的直接链接\">​</a></h3><p>先说首次启动弹窗的实现，要实现该功能，肯定要保证插件在 VSCode 一打开就运行，而这取决于 vscode 触发插件的时机，也就是 activationEvents，所以<code>activationEvents</code>需要设置成<code>onStartupFinished</code>。想要更高的优先级，可以选择 <code>*</code> （但官方不建议，除非其他事件无法实现的前提下），这里为了演示就使用<code>*</code>。</p><p>其实现代码主要调用 <code>vscode.window.showInformationMessage</code> 函数如下</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> vscode </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vscode'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> exec </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'child_process'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">activate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ExtensionContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showInformationMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'是否要打开愧怍的小站？'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'是'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'否'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'不再提示'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'是'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">start 'https://kuizuo.cn'</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'不再提示'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 其他操作 后文会说</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此时重启窗口，就会有如下弹窗显示</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_9oqLzZl-wE.png\" class=\"img_ev3q\"></p><p>但如果你是 mac 用户的话，你会发现无法打开，其原因是 window 下打开链接的指令是 start，而 mac 则是 open，所以需要区分不同的系统。要区分系统就可以使用 node 中的 os 模块的 platform 方法获取系统，如下（省略部分代码）</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> os </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'os'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> commandLine </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> os</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">platform</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'win32'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">start https://kuizuo.cn</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">open https://kuizuo.cn</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">commandLine</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>当然了，当用户选择不再提示的时候，下次再打开 vscode 就别提示了，不然大概率就是卸载插件了。这里就需要设置全局参数了，在 package.json 中 contributes 设置 configuration，具体如下，注意<code>kuizuoPlugin.showTip</code> 为全局参数之一</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"contributes\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"configuration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"properties\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"kuizuoPlugin.showTip\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"boolean\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"default\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"是否在每次启动时显示欢迎提示！\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>该参数可以在设置 → 扩展中找到<code>kuizuo-plugin</code>插件来手动选择，也可以是通过 api 来修改</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_teNrxe9D9O.png\" class=\"img_ev3q\"></p><p>然后读取<code>vscode.workspace.getConfiguration().get(key)</code>和设置该参数<code>vscode.workspace.getConfiguration().update(key, value)</code></p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">activate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ExtensionContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> key </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuoPlugin.showTip'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> showTip </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">workspace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getConfiguration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">showTip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showInformationMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'是否要打开愧怍的小站？'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'是'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'否'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'不再提示'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'是'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> commandLine </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> os</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">platform</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'win32'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">start https://kuizuo.cn</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">open https://kuizuo.cn</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">commandLine</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'不再提示'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//最后一个参数，为true时表示写入全局配置，为false或不传时则只写入工作区配置</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">workspace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getConfiguration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">update</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>即便是调试状态下，重启也不会影响全局参数。最终封装完整代码查看源码，这里不再做展示了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"右键资源管理器快捷键新建测试文件\">右键资源管理器（快捷键）新建测试文件<a class=\"hash-link\" href=\"#右键资源管理器快捷键新建测试文件\" title=\"标题的直接链接\">​</a></h3><p>我日常开发中写的最多的文件就是 js/ts 了，有时候就会在目录下创建 demo.js 来简单测试编写 js 代码，那么我就要点击资源管理器，然后右键新建文件，输入 demo.js。于是我想的是将该功能<strong>封装成快捷键</strong>的方式，当然右键也有<strong>新建测试文件</strong>这一选项。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_3SRybBGaF1.png\" class=\"img_ev3q\"></p><p>功能其实挺鸡肋的，也挺高不了多少效率，这里可以说<strong>为了演示和测试这个功能而实现</strong>。</p><p>总之前面这么多废话相当于铺垫了，具体还是看功能实现吧。</p><p>首先就是注册命令，具体就不解读代码了，其逻辑就是获取调用<code>vscode.window.showQuickPick</code>弹出选择框选择 js 还是 ts 文件（自定义），接着获取到其目录，判断文件是否存在，创建文件等操作。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> vscode </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vscode'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> fs </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'fs'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">activate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ExtensionContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> disposable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">commands</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">registerCommand</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo-plugin.newFile'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">uri</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Uri</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showQuickPick</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'js'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ts'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">item</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">uri</span><span class=\"token operator\" style=\"color:#66d9ef\">?.</span><span class=\"token plain\">fsPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> filename </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">uri</span><span class=\"token template-string interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string interpolation\">fsPath</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">/demo.</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">item</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">existsSync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">filename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showErrorMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">文件</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">filename</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">已存在</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">writeFile</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">filename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showInformationMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">demo.</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">item</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">已创建</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">showTextDocument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Uri</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">file</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">filename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          viewColumn</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ViewColumn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Two</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 显示在第二个编辑器窗口</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">subscriptions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">disposable</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">deactivate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后再 keybindins 中添加一条</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"keybindings\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.newFile\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+n\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后就当我实现完功能的时候，我在想<strong>自带的新建文件是不是就是个 command？只是没有绑定快捷键？</strong> 于是我到键盘快捷方式中找到答案</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_nQu3Y8DWSw.png\" class=\"img_ev3q\"></p><p>图中的<code>explorer.newFile</code>就是资源管理器右键新建文件的命令，只是没有键绑定。所以我只需要简单的加上<code>shift + alt + n</code>即可实现我一开始想要的快捷键功能，此时再次右键资源管理器新建文件右侧就有对应的快捷键。</p><p>此时的我不知该哭该笑，折腾半天的功能其实只是设置个快捷键的事情。</p><div class=\"admonition admonition-note alert alert--secondary\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</h5></div><div class=\"admonition-content\"><p>这些命令在 vscode 中作为内置命令<a href=\"https://code.visualstudio.com/api/references/commands\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Built-in Commands\">Built-in Commands</a>。要查看 vscode 所有命令的话，也可以通过<code>vscode.commands.getCommands</code> 来获取所有命令 ID，要在插件中执行也只需要调用<code>vscode.commands.executeCommand(id)</code> </p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"键盘快捷键光标移动\">键盘快捷键（光标移动）<a class=\"hash-link\" href=\"#键盘快捷键光标移动\" title=\"标题的直接链接\">​</a></h3><p>接着我就在想，既然很多 vscode 功能都是命令的形式，那是不是在插件级别就能做键盘映射，而不用让用户在 vscode 设置，很显然是可以的。只需要在 package.json 中 contributes 的 keybindings 中设置，就可以实现组合键来进行光标的移动。下面是我给出的答案</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"keybindings\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorUp\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+i\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorDown\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+k\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorLeft\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+j\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorRight\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+l\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorHome\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+h\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"cursorEnd\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"shift+alt+;\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"textInputFocus\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_SnnPUABJN5.png\" class=\"img_ev3q\"></p><p>仔细看右侧来源就可以知道是没问题的，第一个为我之前设置的，而扩展则是通过上面的方法。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自定义扩展工作台\">自定义扩展工作台<a class=\"hash-link\" href=\"#自定义扩展工作台\" title=\"标题的直接链接\">​</a></h3><p>在 vscode 中有几个地方可以用于扩展，具体可看<a href=\"https://code.visualstudio.com/api/extension-capabilities/extending-workbench#status-bar-item\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Extending Workbench | Visual Studio Code Extension API\">Extending Workbench | Visual Studio Code Extension API</a></p><p><img loading=\"lazy\" src=\"https://code.visualstudio.com/assets/api/extension-capabilities/extending-workbench/workbench-contribution.png\" class=\"img_ev3q\"></p><ul><li><p>左侧图标（活动栏）：主要有资源管理器、搜索、调试、源代码管理、插件</p></li><li><p>编辑器右上角：代码分栏、code runner 的运行图标</p></li><li><p>底部（状态栏）：git、消息、编码等等</p></li></ul><p>在 contributes 添加 viewsContainers 与 views，注意，views 的属性要与 viewsContainers 的 id 对应。</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"viewsContainers\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"activitybar\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"demo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"愧怍\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"public/lollipop.svg\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token property\" style=\"color:#f92672\">\"views\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"demo\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"view1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"视图1\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"view2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"视图2\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>编辑器右上角是在 menus 中设置 editor/title，图标则是对应命令下设置，不然就是显示文字</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token property\" style=\"color:#f92672\">\"commands\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Hello World\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"light\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"public/lollipop.svg\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"dark\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"public/lollipop.svg\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token property\" style=\"color:#f92672\">\"menus\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"editor/title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"when\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"resourceLangId == javascript\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"command\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo-plugin.helloWorld\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"group\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"navigation\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>至于底部状态栏，这里借用官方例子<a href=\"https://github.com/microsoft/vscode-extension-samples/tree/main/statusbar-sample\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"vscode-extension-samples/statusbar-sample at main · microsoft/vscode-extension-samples (github.com)\">vscode-extension-samples/statusbar-sample at main · microsoft/vscode-extension-samples (github.com)</a>，最终效果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_yQRsMkT6f5.png\" class=\"img_ev3q\"></p><p>那个 🍭 就是所添加的图标，不过并不实际功能，这里只是作为展示。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自定义颜色图标主题\">自定义颜色、图标主题<a class=\"hash-link\" href=\"#自定义颜色图标主题\" title=\"标题的直接链接\">​</a></h3><p>在 vscode 中分别有三部分的主题可以设置</p><table><thead><tr><th>主题</th><th>范围</th><th>推荐</th></tr></thead><tbody><tr><td>文件图标主题</td><td>资源管理器内的文件前的图标</td><td><a href=\"https://marketplace.visualstudio.com/items?itemName=PKief.material-icon-theme\" target=\"_blank\" rel=\"noopener noreferrer\">Material Icon Theme</a></td></tr><tr><td>颜色主题</td><td>代码编辑器以及整体颜色主题</td><td><a href=\"https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme\" target=\"_blank\" rel=\"noopener noreferrer\">One Dark Pro</a></td></tr><tr><td>产品图标主题</td><td>左侧的图标</td><td><a href=\"https://marketplace.visualstudio.com/items?itemName=antfu.icons-carbon\" target=\"_blank\" rel=\"noopener noreferrer\">Carbon Product Icons</a></td></tr></tbody></table><p>不过关于主题美化就不做深入研究，上面所推荐的就已经足够好看，个人目前也在使用。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码片段\">代码片段<a class=\"hash-link\" href=\"#代码片段\" title=\"标题的直接链接\">​</a></h3><p>代码片段，也叫<code>snippets</code>，相信大家都不陌生，就是输入一个很简单的单词然后一回车带出来很多代码。平时大家也可以直接在 vscode 中创建属于自己的<code>snippets</code></p><p>代码片段相对比较简单，这里就简单跳过了</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"xxxlog--consolelogxxx包装\">xxx.log → console.log(xxx)包装<a class=\"hash-link\" href=\"#xxxlog--consolelogxxx包装\" title=\"标题的直接链接\">​</a></h3><p>功能描述：在一个变量后使用.log，即可转化为 console.log(变量)的形式就像 <code>xxx.log =&gt; console.log('xxx', xxx)</code> 有点像 idea 中的<code>.sout</code></p><p>这里我把 <a href=\"https://github.com/jaluik/dot-log\" target=\"_blank\" rel=\"noopener noreferrer\">jaluik/dot-log</a> 这个插件的实现逻辑给简化了，这里先给出基本雏形</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> vscode </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vscode'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">MyCompletionItemProvider</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">implements</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">CompletionItemProvider </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">constructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 提供代码提示的候选项</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">provideCompletionItems</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">document</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">TextDocument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> position</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> snippetCompletion </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">CompletionItem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">CompletionItemKind</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Operator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    snippetCompletion</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">documentation </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">MarkdownString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'quick console.log result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">snippetCompletion</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 光标选中当前自动补全item时触发动作</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">resolveCompletionItem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">item</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">CompletionItem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">activate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">ExtensionContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> disposable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">languages</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">registerCompletionItemProvider</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'html'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'javascript'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'javascriptreact'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'typescript'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'typescriptreact'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vue'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">MyCompletionItemProvider</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">'.'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 注册代码建议提示，只有当按下“.”时才触发</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">subscriptions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">disposable</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 vscode 插件中通过<code>vscode.languages.registerCompletionItemProvider</code>提供像补全，代码提示等功能，第一个参数为所支持的语言，第二个参数为提供的服务<code>vscode.CompletionItemProvider</code>\n这里只是封装成类的形式，目的是为了保存一些属性，例如光标位置 position，也可以传递对象形式\n<code>{ provideCompletionItems, resolveCompletionItem }</code> ，第三个参数则是触发的时机。</p><p><code>provideCompletionItems</code>\n需返回一个数组，成员类型为<code>vscode.CompletionItem</code>，可通过<code>new vscode.CompletionItem()</code>来创建。</p><p>当你尝试运行上述代码时，会发现在任何值后面输入<code>.</code>都会有<code>log</code>提示。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_-ZCy88xVyq.png\" class=\"img_ev3q\"></p><p>但是点击后只是满足了代码补全的功能，而选择 log 选项后所要执行的操作则是在 <code>resolveCompletionItem</code> 中实现，这里仅仅只是返回一个\nnull，即只有简单的补全功能，这里对整个过程进行描述（可以自行下个断点调试查看）：。</p><ol><li><p>当输入<code>.</code>时，程序进入到<code>provideCompletionItems</code>\n函数内，这里可以获取到当前正在编辑的代码文档（文件名，代码内容）对应第一个参数，以及光标所在位置也就是第二个参数。还有其他参数，但这里用不到。具体可看<a href=\"https://code.visualstudio.com/api/references/vscode-api#CompletionItemProvider%3CT%3E\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"CompletionItemProvider\">CompletionItemProvider</a></p></li><li><p>选择完毕后，便会进入到 resolveCompletionItem 里面，这里可以获取到用户所选的选项内容，然后执行一系列的操作。</p></li></ol><p>要做代码替换的话就需要注册文本编辑命令<code>vscode.commands.registerTextEditorCommand</code> ，内容如下</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> commandId </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo-plugin.log'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">commandHandler</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">editor</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">TextEditor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> edit</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">TextEditorEdit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> position</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> lineText </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">lineAt</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">line</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">text</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// match case name.log etc.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> matchVarReg </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">RegExp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">\\(\\[^\\\\s\\]*\\[^\\'\\\"\\`\\]\\).</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'log'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">$</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// match case 'name'.log etc.  /(['\"`])([^'\"])\\1.log/</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> matchStrReg </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">RegExp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">\\(\\[\\'\\\"\\`\\]\\)\\(\\[^\\'\\\"\\`\\]*\\)\\\\1\\.</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'log'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">$</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> matchFlag</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'var'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'str'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'var'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    quote </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"'\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    insertVal </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> lineText</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">match</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">matchVarReg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> quote</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> lineText</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">match</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">matchStrReg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    matchFlag </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'str'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// if matched</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> index </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> lineText</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">indexOf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    edit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">delete</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">Range</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> index</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> index </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">matchFlag </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'var'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">includes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"'\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      quote </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'\"'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// format like console.log(\"xxx\", xxx)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">matchFlag </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'var'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//  only console.log(xxx)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      insertVal </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'console.log'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">(</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">key</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">)</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// if key is string format like console.log(\"xxx\")</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">matchFlag </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'str'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      insertVal </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'console.log'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">(</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">quote</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">key</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">quote</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">)</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    edit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">insert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> index</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> insertVal</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">subscriptions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">commands</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">registerTextEditorCommand</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">commandId</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> commandHandler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>registerTextEditorCommand</code>不同于<code>registerCommand</code>，它只针对编辑器的命令，例如可以删除代码中的某个片段，增加代码等等。上面的代码就是为了找到.log\n前（包括.log）匹配的代码，进行正则提取，然后调用 edit.delete 删除指定范围，再调用 edit.insert\n来插入要替换的代码，以此达到替换的效果。</p><p>命令注册完毕了就需要调用了，也就到了 resolveCompletionItem 的时机</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">resolveCompletionItem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">item</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">CompletionItem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> item</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">label</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">position </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">typeof</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'string'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      item</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">command </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        command</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo-plugin.log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        title</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'refactor'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        arguments</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">translate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> label</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">length </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 这里可以传递参数给该命令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> item</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>将命令赋值给 item.command，会自动调用其 command 命令，同时把 arguments 参数传入给 command。最终达到替换的效果。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"position\">Position<a class=\"hash-link\" href=\"#position\" title=\"标题的直接链接\">​</a></h4><p>这里要说下 vscode 编辑器中的 Position，了解这个对代码替换、代码定位、代码高亮有很大帮助。</p><p>position 有两个属性<code>line</code>和<code>character</code>，对应的也就是行号和列号（后文以<code>line</code>和<code>character</code>\n为称），<strong>*<!-- -->*</strong>和<!-- -->*<strong>*<!-- -->都是从 0 开始算起，而在 vscode 自带的状态栏提示中则是从 1 开始算起</strong>，这两者可别混淆了。</p><p>其中 position 有如下几个方法</p><p><strong>position.translate</strong></p><p>根据当前坐标计算，例如当前 position 的 line 0，character1。<code>position.translate(1, 1)</code> 得到 line\n1，character 2，这不会改变远 position，这很好理解。但如果计算后得到的 line 与 character 有一个为负数则直接报错。</p><p><strong>position.with</strong></p><p>从自身创建一个新的 postion 对象</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"range\">Range<a class=\"hash-link\" href=\"#range\" title=\"标题的直接链接\">​</a></h4><p>知道了坐标信息，那么就可以获取范围了。可以通过 new vscode.Range() 来截取两个 position 之间的内容，得到的是一个 对象，有\nstart 与 end 属性，分别是传入的两个 position。</p><p>同样的 Range 和 Postion 方法都一致，这里就不多叙述了，可查看其声明文件。\n知道范围就可以通过 editor 来获取范围内的代码或是 edit 来删除代码等操作。</p><p>知道了这些内容，再看上面的代码也不难理解了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"选中变量并打印-consolelog\">选中变量并打印 console.log<a class=\"hash-link\" href=\"#选中变量并打印-consolelog\" title=\"标题的直接链接\">​</a></h3><p>这里在补充一个功能：选中一个变量的时候，按下快捷键在下方添加<code>console.log(变量)</code>，相关插件 <a href=\"https://marketplace.visualstudio.com/items?itemName=ChakrounAnas.turbo-console-log\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Turbo Console Log\">Turbo Console Log</a></p><p>补：只有编辑器有光标的情况下会传入当前光标属性 position，选中状态下是不会传入 postion\n属性，而是要通过<code>editor.selection</code>来获取选中内容，是一个 Selection 对象。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">extension.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">subscriptions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">commands</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">registerTextEditorCommand</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo-plugin.insertLog'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">editor</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">TextEditor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> edit</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">TextEditorEdit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取选中代码 在其下方插入 console.log(xxx)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> selections </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> editor</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 选中多个代码时</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">selections</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">length </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 如果不是当行代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">isSingleLine</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> value </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getText</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> insertVal </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">os</span><span class=\"token template-string interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string interpolation constant\" style=\"color:#e6db74\">EOL</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'console.log'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">('</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">value</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">', </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">value</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">)</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      edit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">insert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> insertVal</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selection </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">vscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">Selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> editor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 重置选中区域</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"悬停提示\">悬停提示<a class=\"hash-link\" href=\"#悬停提示\" title=\"标题的直接链接\">​</a></h3><p>这里也一笔带过，具体可看 hover.ts 中的代码。只要在 json 文件中，将鼠标悬停在<code>kuizuo</code>这个词中即可触发，试试看看。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_RUIjdDI90l.png\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"webview\">WebView<a class=\"hash-link\" href=\"#webview\" title=\"标题的直接链接\">​</a></h3><p>使用 webView 可以在 vscode 内显示自定义的网页内容，丰富 vscode 功能，但所消耗的性能是肯定有的，就有可能影响 vscode\n的运行速度。官方给出的建议是：</p><ul><li><p>这个功能真的需要放在<code>VSCode</code>中吗？作为单独的应用程序或网站会不会更好呢？</p></li><li><p>webview 是实现这个功能的唯一方法吗？可以使用常规 VS Code API 吗？</p></li><li><p>您的 webview 是否会带来足够的用户价值以证明其高资源成本？</p></li></ul><p>不过这里还只是作为一个演示，点击右上角的 logo 图标便可在 vscode 中打开网页。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_nVO_YmRit4.png\" class=\"img_ev3q\"></p><p>不过要注意一点。新开的 webview 的背景是对应主题颜色的背景，如果网站有黑白模式的话，那么可能会导致颜色不对，故这里设置了 webview 的背景为白色。</p><p>至于消息通信就不尝试了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"发布\">发布<a class=\"hash-link\" href=\"#发布\" title=\"标题的直接链接\">​</a></h2><p>大部分常用的 vscode 插件实现就此完毕，实际上有很多 api 还没尝试过，篇幅有限，就不一一列举了，后续若有开发实际作用插件再研究。具体可自行安装尝试一番，既然要让别人安装，这里就需要介绍发布了。</p><p>这里在打包前重构下命令 ID，从 kuizuo-plugin → vscode-extension，同时把 package.json 的 name 改成了 vscode-extension-sample，因为发布的时候这个 id 必须唯一，不能与已有重名，到时候生成的为 kuizuo.vscode-extension-sample。（demo 给取了，不然我也不想起名为 sample）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"本地打包\">本地打包<a class=\"hash-link\" href=\"#本地打包\" title=\"标题的直接链接\">​</a></h3><p>无论是本地打包还是发布到应用市场都需要借助<code>vsce</code>这个工具。</p><p>安装</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">npm</span><span class=\"token plain\"> i vsce -g</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>打包成<code>vsix</code>文件：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vsce package</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在打包时会提示一些信息，例如修改 README.md ，添加 LICENSE 等等，根据提示来操作即可。</p><p>生成好的 vsix 文件不能直接拖入安装，只能从扩展的右上角选择<code>Install from VSIX</code>安装：</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"发布到应用市场\">发布到应用市场<a class=\"hash-link\" href=\"#发布到应用市场\" title=\"标题的直接链接\">​</a></h3><p><strong>1、注册账号获取 token</strong></p><p>因为 Visual Studio Code 使用 <a href=\"https://azure.microsoft.com/services/devops/\" target=\"_blank\" rel=\"noopener noreferrer\">Azure DevOps</a>作为其 Marketplace 服务。所以需要登录一下<a href=\"https://dev.azure.com/\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Azure\">Azure</a>。登录后，如果之前没用过的话会要求创建一个组织，默认为邮箱前缀，这里如下点击</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/token1_JNXknLPQyJ.png\" class=\"img_ev3q\"></p><p><strong>2、新建一个 token</strong></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/token2_SCsFTU3mph.png\" class=\"img_ev3q\"></p><p>根据图片选择，其中 Scopes 也可以选择：Full access，即所有权限。生成后会得到一个 token，保存它，当你关闭时便不再显示。</p><p><strong>3、创建一个发布者</strong></p><p>先使用网页版创建发布账号：<a href=\"https://marketplace.visualstudio.com/manage\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"https://marketplace.visualstudio.com/manage\">https://marketplace.visualstudio.com/manage</a>填写一些基本信息，然后在使用</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vsce login </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">publisher name</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里的 publisher name 根据 package.json 中的 publisher，会要求你输入 Personal Access Token，把刚刚创建的 token 的值粘贴过来即可</p><p>提示\n<code>The Personal Access Token verification succeeded for the publisher 'kuizuo'.</code>\n就说明验证成功</p><p><strong>4、发布应用</strong></p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vsce publish</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"admonition admonition-warning alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>warning</h5></div><div class=\"admonition-content\"><p>这里要保证 package.json 的 name 在插件市场中唯一，否则会提示 The Extension Id already exist in the Marketplace. Please use the different Id。</p></div></div><p>运行完毕后，最终提示<code>Published kuizuo.vscode-extension-sample v1.0.0.</code> 就说明发布完毕，发布和 npm 包一样，都无需审核，但要求包名唯一。</p><p>可以在 <a href=\"https://marketplace.visualstudio.com/manage/publishers/kuizuo\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"Manage Extensions | Visual Studio Marketplace\">Manage Extensions | Visual Studio Marketplace</a> 中管理已发布的插件</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image_HssaMdar8f.png\" class=\"img_ev3q\"></p><p>这时在 vscode 扩展商店中搜索 <code>vscode-extension-sample</code>就能找到该插件<a href=\"https://marketplace.visualstudio.com/items?itemName=kuizuo.vscode-extension-sample\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"VSCode-extension\">VSCode-extension</a>，也可以通过<code>publisher:\"kuizuo\"</code>来找到我的所有 vscode 插件。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220711195038039.png\" alt=\"vscode-extension\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>整个开发过程的体验还是非常不错的，调试和代码提示都做得特别到位。不过有一点体验不好的，是大部分的配置信息都要写在 package.json 中，而在这里就不像 ts 那样有没有很好的代码提示了。不过当你填错命令 id 的时，vscode 还会提示命令 id 不存在，而不是不知道报错点。</p><p>浅浅吐槽下：说真的 vscode 插件开发相关的文章与教程少之又少，有时候一个功能的一个 api 实现只能去查阅文档，而不像 chrome 插件，通过搜索引擎就能很快得出结果，而 vscode 插件往往得到的是推荐...但这也说明 chrome 插件开发的人远多于 vscode 插件，或者说远多于 IDE 插件的开发，也很正常，大部分编程好用的功能，已有大牛实现了对应的插件，多数开发者没有一些特别的需求完全就没必要接触 vscode 插件开发。就如我一年前就想写 vscode 插件，但却迟迟拖到现在，其原因可能就这。</p><p>不过这类应用本就如此，就是不断翻阅文档，阅读前人的代码实现，再结合自身思路以完成最终目标。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"参考文章\">参考文章<a class=\"hash-link\" href=\"#参考文章\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://www.cnblogs.com/liuxianan/p/vscode-plugin-overview.html\" target=\"_blank\" rel=\"noopener noreferrer\" title=\"VSCode插件开发全攻略（一）概览 - 我是小茗同学 - 博客园 (cnblogs.com)\">VSCode 插件开发全攻略（一）概览 - 我是小茗同学 - 博客园 (cnblogs.com)</a></p><p><a href=\"https://code.visualstudio.com/api\" target=\"_blank\" rel=\"noopener noreferrer\">Extension API | Visual Studio Code Extension API</a></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/vscode-plugin",
            "title": "编写一个VSCode插件",
            "summary": "自从使用过 VSCode 后就再也离不开 VSCode，其轻量的代码编辑器与诸多插件让多数开发者爱不释手。同样我也不例外，一年前的我甚至还特意买本《Visual Studio Code 权威指南》的书籍，来更进一步了解与使用。",
            "date_modified": "2022-07-11T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "vscode",
                "plugin",
                "extension",
                "develop"
            ]
        },
        {
            "id": "autohotkey",
            "content_html": "<p>当我使用笔记本的时候，每次移动光标，都要大费周章，同时由于笔记本的缘故，导致键入Home与End都需要搭配Fn功能键来实现。所以我希望在任何情况下（敲代码，写文章）都可以将某些组合键绑定为上下左右键，在代码编辑器上有键盘映射可以设置，但脱离代码编辑器就不起作用了，在window下有个神器 <a href=\"https://www.autohotkey.com/\" target=\"_blank\" rel=\"noopener noreferrer\">AutoHotkey</a> 可以实现我想要的功能。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装\">安装<a class=\"hash-link\" href=\"#安装\" title=\"标题的直接链接\">​</a></h2><p>打开<a href=\"https://www.autohotkey.com/\" target=\"_blank\" rel=\"noopener noreferrer\">官网</a>，点击Download，安装即可。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用\">使用<a class=\"hash-link\" href=\"#使用\" title=\"标题的直接链接\">​</a></h2><p>安装完成后，右键新建会AutoHotKey Srcipt后缀为ahk。例如创建demo.ahk，其内容如下</p><div class=\"language-ahk codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-ahk codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!I::Send {Up} </span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!K::Send {Down} </span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!J::Send {Left} </span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!L::Send {Right} </span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!H::Send {Home} </span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;+&lt;!;::Send {End} </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后保存双击该文件，即可运行autohotkey，此时打开任意文本，键入<kbd>Shift</kbd> + <kbd>Ctrl</kbd> + <!-- -->[HIJKL;]<!-- --> 就可以看到光标上下左右移动。</p><p>这里对上面语法进行讲解</p><table><thead><tr><th>键名</th><th>热键标识</th></tr></thead><tbody><tr><td>Ctrl</td><td>^</td></tr><tr><td>Shift</td><td>+</td></tr><tr><td>Alt</td><td>!</td></tr><tr><td>Win</td><td>#</td></tr></tbody></table><p>如果要针对左右Ctrl或Shfit只需要在前面添加<code>&lt;</code> <code>&gt;</code> 。<code>::</code>则作为映射关系，左边的按键作用于何种指令，而右侧则是左侧按键所对应的指令，这里的指令相对简单，只是发送键盘上下左右的关系，指令还可以实现信息框MsgBox 启动应用等等。具体还有更多键盘与鼠标热键详情可在AutoHotkey Help手册中查看，非常详细，不过是英文。</p><p>具体要映射的快捷键可自行发挥，但要切记不建议与常用快捷键冲突，例如上面为何是IJKL而不是WASD，其原因会导致快捷键冲突。</p><p>此外AutoHotkey不仅能做键盘映射，实现宏定义，一键启动任务也不成问题，篇幅有限，就不做过多演示，有兴趣可自行研究。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/autohotkey",
            "title": "AutoHotkey键盘映射",
            "summary": "当我使用笔记本的时候，每次移动光标，都要大费周章，同时由于笔记本的缘故，导致键入Home与End都需要搭配Fn功能键来实现。所以我希望在任何情况下（敲代码，写文章）都可以将某些组合键绑定为上下左右键，在代码编辑器上有键盘映射可以设置，但脱离代码编辑器就不起作用了，在window下有个神器 AutoHotkey 可以实现我想要的功能。",
            "date_modified": "2022-07-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "工具",
                "keyMap"
            ]
        },
        {
            "id": "2022-summer-planning",
            "content_html": "<p>考试也结束了，这学期的任务也完成了，按照往常我通常就定制暑假的学习清单，将要学习的技术栈规划出来，借此来督促自己学习，这次也不例外。</p><p>但此次有点特殊，主要有以下情况</p><ul><li><p>老家疫情</p></li><li><p>主力电脑不在身边</p></li><li><p>暑期时间过短</p></li></ul><p>很不幸的是，我老家就在前几天发生疫情了，挺严重的，封城加方舱，其严重性可想而知（我都不知道我这个暑假能否返回老家）。而这就导致我的工作环境发生了巨变，我目前处于一个相对小巧的家中，没有一个完整的办公桌（只有一个茶几）来放置电脑键鼠外设，甚至没有 wifi。而通常情况下我会配置台显示屏作为更广阔的代码视野，以提升编程效率，然而这次并没有。</p><p>同时也是因为疫情，导致快递不易寄送，我就放弃了将我的台式主机寄回去的计划。而是只带了另一台轻薄本小新 Pro14（还有一台游戏本因特殊原因被迫不在我的手里 😭），所以又导致了开发环境不足，编程效率有所下降。</p><p>在 20 年 1 月疫情首次爆发的时候，足足给我了近 4 个月的时间“闭关修炼”（学校安排 5 月中旬开学，不然感觉还能更进一步），其效率远非日常学习所能堪比的，那段时间极大的充实了我的知识面，让我知道编程的无限可能。而这次暑假时间为期 7.7 ~ 8.19，时间上不再像往常那么充实。</p><p>即便诸多条件的影响下，假期也是我学习效率最高的时候。考试的折磨已经结束了，接下来就是享受学习的过程。只有在别人不在学习的时候学习，在最有可能比别人先行一步（卷就完事了）。于是下列为我的本次暑期学习计划，主要是针对一些主流热门框架的学习，优先按照顺序。不出意外的话，应该保证一周至少两篇的博文（笔记）</p><p><del>tip: 已经快两个月没更新技术类博客了（逃）</del></p><ul class=\"contains-task-list containsTaskList_mC6p\"><li class=\"task-list-item\"><p><input type=\"checkbox\" checked=\"\" disabled=\"\"> <a href=\"/examenEbau/develop/编写一个VSCode插件\">vscode 插件</a></p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" checked=\"\" disabled=\"\"> <a href=\"/examenEbau/project/基于Nuxt3的API接口服务网站\">nuxt.js</a></p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" checked=\"\" disabled=\"\"> <a href=\"/examenEbau/node/Next.js项目搭建与部署\">next.js</a></p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" disabled=\"\"> <!-- -->webGL three.js</p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" disabled=\"\"> <!-- -->rust</p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" disabled=\"\"> <!-- -->webassembly</p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" disabled=\"\"> <!-- -->tauri</p></li><li class=\"task-list-item\"><p><input type=\"checkbox\" disabled=\"\"> <!-- -->deno</p></li></ul><p>计划不是任务，不一定都要实现是吧。这里只是列举一系列下一阶段所要学习，至于能完成多少，取决于我的懒散和拖延。如果完成了我会在前面勾选，并附上相应文章(笔记)链接</p><p>不过由于开发环境与工作环境的限制，不太会在假期对以上技术栈有个整体的浏览以及项目展示，而是构建其 demo 及其相关实操过程的文章。同时在这期间也顺便写点人生感悟的语句，以及拖欠了的年终（中）总结。</p><p><strong>时刻保持学习，时刻保持清醒。</strong></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/2022-summer-planning",
            "title": "2022年暑期规划",
            "summary": "考试也结束了，这学期的任务也完成了，按照往常我通常就定制暑假的学习清单，将要学习的技术栈规划出来，借此来督促自己学习，这次也不例外。",
            "date_modified": "2022-07-07T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "规划"
            ]
        },
        {
            "id": "frontend-interview-experience",
            "content_html": "<p>考试终于结束了，也将近一个月没怎么写代码和文章了，准备调整下自身状态，开始进一步的学习。然后在前段时间我的一个同校同学拿到了 xx 公司的 offer，然后该公司正好有招前端开发实习，就问我有没有兴趣尝试一下，但一开始我内心其实不是很想工作的，想着暑假去闭关学其他技术，同时加上我目前的身份<strong>准大三(休学一年)</strong>实习期可能也就 2 个月，毕竟这行业不同于打工，是需要长期工作和维护。不过一想毕竟没面试过，所以就蛮去尝试一下，至于最终的结果，阅读全文吧。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"简历\">简历<a class=\"hash-link\" href=\"#简历\" title=\"标题的直接链接\">​</a></h2><p>我的那位同学给我推了面试官的微信，于是加完微信，简单的几句招呼便直接开始找我要了一份<strong>简历</strong>，也就是整个面试过程中最重要的物件，即<strong>面试的前提</strong>。</p><p>很显然我压根就没有准备过这玩意，然后面试官叫我去准备一下（期间聊天强调过几次有空准备下简历），于是就去网上搜寻了关于简历说明、编写建议与简历模板，也了解到简历对面试者的一个重要性。</p><p><strong>简历是面试官了解面试者最快方式</strong>，甚至可以说对于大部分人群是非要不可。于是我花费了一天的时间去准备了一份属于自己的简历，主要内容为个人的基本信息、技术特长、个人描述、教育背景、工作经验、项目经验等，其内容一定要真实，同时也要在精简的同时，让面试官一眼就能看到你的亮点，以及将来你到贵公司工作能为其提供的帮助，这些在外面的大部分简历编写建议中也有提及，这里我也仅是简单总结。</p><p>关于我的简历就不展示了（毕竟暂时比较烂），不过关于简历模板的话，我倒是可以推荐下。我所使用的是 <a href=\"https://www.mujicv.com/\" target=\"_blank\" rel=\"noopener noreferrer\">木及简历</a>，此外还有 <a href=\"https://resume.mdnice.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Markdown 简历排版工具 (mdnice.com)</a> 与 <a href=\"https://resume.sugarat.top/\" target=\"_blank\" rel=\"noopener noreferrer\">简历自动生成 (sugarat.top)</a> ，这些都是我在搜寻资料中认为不错的在线简历模板。</p><p>最主要是丰富自身的阅历与技术，这样在简历编写时，其内容是一定能吸引到面试官的注意。要是什么技能都不会，什么项目都没有，一份不起眼的简历，作为面试官是很难给你一个面试的机会。</p><p>如果你已经看到这里了，并且你未来有找工作的需求，那么现在就可以着笔简历，而不是等到要找工作的时候在准备。同时在日常开发与学习中，也可以不断去完善自身简历。<strong>总之，越早写简历越好</strong>。</p><p>将简历提交给面试官后，如果叫你准备下面试，那么恭喜，已经进入第二步------<strong>面试</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"面试\">面试<a class=\"hash-link\" href=\"#面试\" title=\"标题的直接链接\">​</a></h2><p>这次预定为周六早上 10 点（即本文发布日期）<strong>线上面试</strong>（无屏幕共享，只单纯聊聊技术栈相关），正常来说知道自己要被面的话，应该来说会提前做些准备。然而我就不一样了，我<strong>没刷过任何面试题</strong>（八股文），所以我想看看我的知识储备能否回答出这些问题，结果也确实如此，这次面试大多数问题回答不出来或者回答的半知半解的。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"问技术\">问技术<a class=\"hash-link\" href=\"#问技术\" title=\"标题的直接链接\">​</a></h3><p>关于所问的问题，和外面主流的前端面试大致，这些就是考验基本功的问题，例如 HTML5 的新特性，JS 的一些语法等等，这些在八股文在面试过程中是必须要背的，因为这些决定计算机的基本功。此外面试官在了解你的大致技术栈后，必然会针对你简历上的内容，提出一些针对性的问题。比方说我在简历上写了一个后台管理系统 <a href=\"https://admin.kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">KzAdmin</a> 其中就有问到像 JWT，axios 封装，前端菜单展示等问题，然后和一个<a href=\"https://deobfuscator.kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">JavaScript 的混淆与还原</a>，就问这个主要功能，以及其中所涉及的一些技术栈相关的。</p><p>至于整个面试所关于技术的问题与细节就不一一列举了，不过令我意外的是，所问题的竟然没有算法题，不过事后想想也对线上面试还无共享屏幕的前提下，咋可能问算法题呢，最多也就是问问你对你的技术栈的了解程度与理解情况，整个过程与我预期所想符合。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"闲谈\">闲谈<a class=\"hash-link\" href=\"#闲谈\" title=\"标题的直接链接\">​</a></h3><p>最后就是表明他们的项目可能是需要长期的，然后我目前的情况又相对比较特殊，问我下学期课程的安排啥的。相对面试者比较在意的就是薪资，但在这次谈论期间是没有关于薪资的，我和面试官都没提，我自然是不敢提的，毕竟问题都回答的那么烂了，哪里还好意思提，同时这是实习岗位，自然薪资不会高到哪里去的。</p><p>当然了，整个面试过程最后一句话是<strong>回去等通知</strong></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"等待面试结果\">等待面试结果<a class=\"hash-link\" href=\"#等待面试结果\" title=\"标题的直接链接\">​</a></h3><p>通常面试都有以下三种结果。</p><p>第一、现场录用。第二、当场拒用。第三、回去等通知</p><p>大多数面试结果都是第三条，我自然不例外。至于有没有二面啥的，自我感觉有个 7 成左右。为何不敢说百分百呢？从整个面试的过程来看，其实我准备时间是充分的，但根本没怎么准备，甚至可以说全程是种摆烂的态度。再从回答问题上来看，我整个回答情况就表明告诉面试官我没准备好这次面试，加上一开始没准备好简历，就相当于我就是来面着玩的 😂。</p><p>公司面对这类面试者（求职意向不是很明确，情况特殊），大概率就是直接刷掉了。当然，这只是我的个人对此次面试的看法，如果有二面的话，我一定好好刷面试题，顺带锻炼下表达能力（现在在回想整个回答过程，我甚至都不好意思说我是学前端的了）。如果没有的话，算了不去想了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"面试结果\">面试结果<a class=\"hash-link\" href=\"#面试结果\" title=\"标题的直接链接\">​</a></h2><p>承接上文，直到考试结束任然没收到任何通知，即挂了。其原因其实我也在上文中说到，我的面试态度相对比较差，加上实习期限的原因。不过后话来说，即便我收到了这份offer我也不一定会去，当然这里说这种话确实有那么一点不好，但首先我是工作过（虽然不算一个体系的公司，只能算作工作室），而且给我分配的时间充裕，而且薪资还不低，并且当时涉及的业务还是我相对比较强项的协议复现和逆向（虽然我已经快半年没碰，而且大概率会在持续半年的时间不接触逆向相关的）。但每天的任务就是等待产品经理的需求，这时就需要停下手头的事情，来完成任务，大部分的时间都是在测试和维护。虽说和与搬砖打工有点区别，但本质无异，都是枯燥任务。同时我本身是挺反感重复任务与中断的，所以上一份的工作给我的感受就是（时间）充实但又夹杂着（任务）枯燥，但很多时候就不得不妥协，因为生活所迫，这里就不做感慨了。</p><p>总之，这次的面试结果也并不让我意外，甚至可以说是情理之中。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结与建议\">总结与建议<a class=\"hash-link\" href=\"#总结与建议\" title=\"标题的直接链接\">​</a></h2><p>对整个面试的过程对我而言就是要锻炼自身表达能力，在除了没刷八股文外，像一些问题，我很难用口语去告诉面试官我的意思，但使用屏幕共享加代码展示就不一样，但当时的面试官没提加上我也没主动申请，这是我认为整个过程比较可惜的一点。不过整个过程下来，我认为面试也没什么的，无非就是问问题，平常多刷面试题。</p><p>关于一些建议的话：</p><p>首先就是个人简历非常重要，最好添写个人<a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a>与<a href=\"https://kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">博客</a>，绝对是面试的加分项。尤其是博客，在上面所分享的内容，也可能会吸引到一些需要招聘你的 HR。至少告诉面试官你有在学习，并且懂得记录。其次就是简历上一定要有能亮眼的地方同时自己又很掌握的项目经验，这样面试官针对性的问题，对自身也有很好的作答。如果自己掌握程度不是很大的情况下，还是不建议编写，即便学过，但忘了，那就是不会（说的不就是我吗）。</p><p>一个好的简历谁都会写，但面试不是一纸千金，工作更不是纸上谈兵。简历是了解一个人的基本资料，而面试主要是考察一个人的工作能力与综合素质，即便你工作能力再强大，但你工作态度属于摸鱼的状态，同样是无法胜任此工作的。所以既然选择要工作，那就应该做足准备，拿出最好的工作态度给面试官。</p><p>所以我一开始的目的到底是什么呢？准备实习工作呢？还是闭关学习呢？又或者是...</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/frontend-interview-experience",
            "title": "记一次前端面试过程",
            "summary": "记录一次前端面试过程",
            "date_modified": "2022-06-25T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "面试",
                "fontend"
            ]
        },
        {
            "id": "learning-style",
            "content_html": "<p>临近考试周，又要开始准备复习，顺带总结下自己平常的学习方式与一些感慨。</p><p>我个人主要的两种学习方式，<strong>主动学习</strong>与<strong>被动学习</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"主动学习-\">主动学习 ✍<a class=\"hash-link\" href=\"#主动学习-\" title=\"标题的直接链接\">​</a></h2><p>通常来说，主动学习往往是一件痛苦的事情。就如考试周，平常的课该去在课堂上睡觉，该不去的在宿舍睡觉，到考试周，一学期的课没听，但一想到不复习就有可能面临挂科，或多或少都会复习。考试摆烂，挂科惨淡。</p><p>除了上面是会导致坏结果而去学习，那么还有一种则是与之相反，也就是所需，所感兴趣的去学习。</p><p>例如我想要实现一个酷炫功能，或者是一个需求时，而其中需要的知识点便会去了解与学习。</p><p>对于前者而言，其过程并不舒服，甚至可以说是逼自己学习不喜欢的东西，通常我是不如不学的，即便学了在以后也难以记起，除非不学的结果比较严重（如挂科）。而后者情况便不同，兴趣是最好的老师，甚至都不需要借助外界因素去激励，便能有一个很好的学习成果。</p><p>如果没有兴趣或需求的情况下，那么主动学习一定要定制一系列的目标，如果没有明确的目标，学习将会显得十分迷茫。我有很多时候便是这样，想去主动去学习诸多技术栈，不知从何下手。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"被动学习-\">被动学习 📘<a class=\"hash-link\" href=\"#被动学习-\" title=\"标题的直接链接\">​</a></h2><p>其实可以说是利用业余时间学习的一个方式，首先我会想我一天主要做的事情（通常是与学习无关），比如刷各个平台（b 站，抖音）的视频，刷知乎，qq 群闲聊等等，这里只是以我一天的大部分日常举例。</p><p>此事不妨关注一些与学习类的账号，包括但不限于加入一些技术交流群， up 主，公众号，博主等等，当你每次刷这类平台时，系统很自然就会给你推送相关内容，比方说 b 站，我日常会在上面刷一些鬼畜视频，生活娱乐视频，但也会关注一些技术类的账号，在娱乐的同时，还能不经意间刷到一些编程知识（知乎，微信公众号同理），这送上门的知识不香吗？</p><p>当然，这样学习肯定有一定弊端。首先所摄取的知识过于笼统，一般都是由别人推荐的，甚至有可能会浪费你人生中的几分钟，因为这些知识点可能你已经掌握了，或者这些知识确实没什么干货。其次所获取到的知识往往是整个知识面的冰上一角，或者是某些新型技术，但想要深入去学习还是得按上面的主动学习。</p><p>被动学习主要的作用能让你在不学习的状态下，还能获取相对应的知识。听起来可能觉得很卷，无时无刻的在学习，但我认为在娱乐中学习往往不会显得像主动学习那般有种疲惫感。</p><p>我在被动学习中就间接了解到许多的前沿的技术栈，以及了解到许多之前没使用过的语言、框架特性，而这些都是直接送上门的知识点，而我要做的只是关注一些账号，订阅一些文章或站点，而不用自己去茫茫知识海洋中去寻求。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"两者的权衡\">两者的权衡<a class=\"hash-link\" href=\"#两者的权衡\" title=\"标题的直接链接\">​</a></h2><p>我时常处于这类被动学习状态，因为我对很多技术点都很感兴趣，但又不知道从何下手，而当我刷到我所感兴趣的东西时，我才会开始转为主动学习。之所以会出现这样的学习状态转型，有很大一部分是因为<strong>兴趣感已经没有一开始所学的那么强烈，甚至可以说有些许乏味</strong>。</p><p>在一开始接触时，我是抱着强烈的兴趣感去学的，处于一种非常积极的主动学习状态，当时所获取的知识是无法用现在同等时间所堪比。然而在兴趣感消散，这种状态都为浮云。主动学习的频率减弱，每天都在做着与学习无关的事情，这期间与知识没有任何的往来。</p><p>直到将每天所要做的事情，间接的转为被动学习的方式，至少有在学习，而不是在停步，即便是行走 1 厘米，那也是米。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>无论是任何事情在任何时候下都应该保持的是一种不断坚持的状态，打游戏也好，学习也好。</p><p>一段时间不打游戏，手感生疏，再次接触就没状态。\n一段时间不学知识，容易忘记，再次使用就没印象。</p><p>大部分人都是如此，可谁又不希望保持一种不断坚持的状态。毕竟不是每个人都有充裕的个人资源与时间资源，很多时候这些资源并不是由自己分配的，有可能是亲朋好友，也有可能是上司老板，最有可能是生活所迫。。。</p><p><strong>唯愿此生，岁月静好</strong></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/learning-style",
            "title": "浅谈个人学习方式",
            "summary": "临近考试周，又要开始准备复习，顺带总结下自己平常的学习方式与一些感慨。",
            "date_modified": "2022-06-10T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "杂谈"
            ]
        },
        {
            "id": "vercel-deploy-serverless",
            "content_html": "<p>Vercel 除了能部署静态站点外，还能运行 Serverless Functions，也是本次的主题</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"创建接口\">创建接口<a class=\"hash-link\" href=\"#创建接口\" title=\"标题的直接链接\">​</a></h2><blockquote><p>To deploy Serverless Functions without any additional configuration, you can put files with extensions matching <a href=\"https://vercel.com/docs/concepts/functions/supported-languages\" target=\"_blank\" rel=\"noopener noreferrer\">supported languages</a> and exported functions in the <code>/api</code> directory at your project's root.</p></blockquote><p>vercel 约定在目录下 api 下创建接口路径，这里创建 api/hello.js 文件，当然也支持 ts 以及 ESmodule 写法</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">api/hello.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">handler</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">request</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> name </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">query</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Hello </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">name</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">!</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此时通过<code>vc --prod</code>生产环境部署后，在浏览器请求 vercel 提供的二级域名/api/hello?name=vercel 便可得到文本<code>Hello vercel</code>，而其函数写法与 express 类似</p><p>接口信息可以在 Functions 中查看</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220512155341109.png\" alt=\"image-20220512155341109\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-typescript\">使用 typescript<a class=\"hash-link\" href=\"#使用-typescript\" title=\"标题的直接链接\">​</a></h3><p>不过上面是使用 js 写法，vercel 更推荐<a href=\"https://vercel.com/docs/concepts/functions/serverless-functions/supported-languages#using-typescript\" target=\"_blank\" rel=\"noopener noreferrer\">使用 TypeScript</a></p><p>安装 <code>@vercel/node</code></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i -D @vercel/node</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>将上面的 hello.js 改为 hello.ts，内容为</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">api/hello.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> VercelRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> VercelResponse </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'@vercel/node'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> VercelRequest</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> response</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> VercelResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> name </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">query</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Hello </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">name</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">!</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此外还可以使用其他语言，这里为 Vercel 所支持的<a href=\"https://vercel.com/docs/concepts/functions/serverless-functions/supported-languages#supported-languages:\" target=\"_blank\" rel=\"noopener noreferrer\">语言</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"开发环境\">开发环境<a class=\"hash-link\" href=\"#开发环境\" title=\"标题的直接链接\">​</a></h3><p>上面创建的例子是在生产环境下进行的，vercel 官方非常贴心的提供了 vercel dev 来用于开发环境（本地调试）。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vercel dev</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>执行后，将会默认开启 3000 端口来启动服务，此时访问 http://localhost:3000/api/hello 就可调用该接口</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"verceljson\">vercel.json<a class=\"hash-link\" href=\"#verceljson\" title=\"标题的直接链接\">​</a></h2><p>在根目录创建<a href=\"https://vercel.com/docs/project-configuration\" target=\"_blank\" rel=\"noopener noreferrer\">vercel.json</a>，用于设置 Vercel 项目配置 ，其配置结构与 Nextjs 的 next.config.js 大体一致。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"headers\">headers<a class=\"hash-link\" href=\"#headers\" title=\"标题的直接链接\">​</a></h3><p>vercel 允许响应携带自定义的协议头，例如设置允许跨域的协议头。</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vercel.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"headers\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"source\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/(.*)\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"headers\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Access-Control-Allow-Origin\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"value\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"*\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Access-Control-Allow-Headers\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"value\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"content-type\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"key\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Access-Control-Allow-Methods\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"value\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"DELETE,PUT,POST,GET,OPTIONS\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"rewrites\">rewrites<a class=\"hash-link\" href=\"#rewrites\" title=\"标题的直接链接\">​</a></h3><p>Vercel 支持路由重写功能，因此我们可以实现反向代理。</p><p>例如将前缀为/proxy 的所有请求都代理到 <a href=\"http://127.0.0.1:5000%EF%BC%8C%E5%85%B6%E5%86%99%E6%B3%95%E5%A6%82%E4%B8%8B\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:5000，其写法如下</a></p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vercel.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"rewrites\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"source\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/proxy/:match*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"destination\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"http://127.0.0.1:5000/:match*\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>请求<code>/proxy/hello</code> 将会请求到 <code>http://127.0.0.1:5000/hello</code>（不带有<code>/proxy</code>）</p><div class=\"admonition admonition-caution alert alert--warning\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z\"></path></svg></span>caution</h5></div><div class=\"admonition-content\"><p>注意无法代理前缀为/api 的接口，即使设置了也无效。</p></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"redirects-和-rewrites-区别\">redirects 和 rewrites 区别<a class=\"hash-link\" href=\"#redirects-和-rewrites-区别\" title=\"标题的直接链接\">​</a></h4><p>除了 rewrites 还有一个 redirects，也就是重定向，response 返回 3xx 的状态码和 location 头信息。</p><p>而 rewrites 重写内部转发了请求，地址栏不会发生改变，并且状态码由转发的请求决定。</p><p>并且 redirects 是先被调用的，而 rewrites 是后被调用的。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"functions\">functions<a class=\"hash-link\" href=\"#functions\" title=\"标题的直接链接\">​</a></h3><p>可以设置指定接口分配的内存以及最大执行时间。默认下</p><ul><li>Memory: 1024 MB (1 GB)</li><li>Maximum Execution Duration: 5s (Hobby), 15s (Pro), or 30s (Enterprise)</li></ul><p>个人用户接口超时时间最长为 5 秒。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署-node-项目\">部署 Node 项目<a class=\"hash-link\" href=\"#部署-node-项目\" title=\"标题的直接链接\">​</a></h2><p>可以使用 vercel.json 配置来覆盖 vercel 默认行为，也就能使用 Vercel 部署 Node 项目。</p><p>假设要部署一个 Express 项目，则配置如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vercel.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"builds\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"src\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"app.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"use\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"@vercel/node\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>安装 <code>@vercel/node</code>包</p><div class=\"language-shell codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">npm</span><span class=\"token plain\"> i @vercel/node -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后运行 vercel，而不是<del>vercel --prod</del></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署-nestjs\">部署 Nest.js<a class=\"hash-link\" href=\"#部署-nestjs\" title=\"标题的直接链接\">​</a></h3><p>这里有个部署 Nest.js 项目的教程 <a href=\"https://juejin.cn/post/7023690214803505166\" target=\"_blank\" rel=\"noopener noreferrer\">基于 Vercel+Github Action 部署 Nest.js 项目 - 掘金 (juejin.cn)</a></p><p>其 vercel.json 如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vercel.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"builds\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"src\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"dist/main.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"use\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"@vercel/node\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"routes\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"src\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/(.*)\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"dest\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"dist/main.js\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后执行 vercel --prod（因为 nest 项目需要 build 打包）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>Vercel 十分良心，为个人用户提供了免费的爱好者计划，每个月提供 100G 流量，构建时间是 100 小时，50 个根域名绑定。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/vercel-deploy-serverless",
            "title": "Vercel部署Serverless",
            "summary": "Vercel 除了能部署静态站点外，还能运行 Serverless Functions，也是本次的主题",
            "date_modified": "2022-05-12T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "vercel",
                "serverless"
            ]
        },
        {
            "id": "use-github-action-to-auto-deploy",
            "content_html": "<p>如果有写过项目的经历，就免不了将代码上传到服务器上，安装依赖，然后输入启动命令的步骤。但是有的项目往往需要经常性的改动，如果还是照着上面的方式进行部署的话。先不说这样操作的效率，操作个几次就想罢工了。并且上面这样操作的往往容易误操作。而 Github Actions 正是该问题的良药。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"介绍\">介绍<a class=\"hash-link\" href=\"#介绍\" title=\"标题的直接链接\">​</a></h2><p>Github Actions 是 Github 提供的免费自动化构建实现，特别适用于持续集成和持续交付的场景，它具备自动化完成许多不同任务的能力，例如构建、测试和部署等等。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"概念\">概念<a class=\"hash-link\" href=\"#概念\" title=\"标题的直接链接\">​</a></h2><p>在进行操作前，先对 Github Actions 基础知识进行补充，具体可查看 <a href=\"https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Actions 入门教程 阮一峰</a></p><p>可以在 <a href=\"https://github.com/marketplace?type=actions\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Marketplace · Actions to improve your workflow</a> 中找到所有的 Actions。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实例将-vite-项目发布到-github-pages\">实例：将 VIte 项目发布到 GitHub Pages<a class=\"hash-link\" href=\"#实例将-vite-项目发布到-github-pages\" title=\"标题的直接链接\">​</a></h2><p>第一步：创建一个 Vite 工程，可在<a href=\"https://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project\" target=\"_blank\" rel=\"noopener noreferrer\">官网</a>中查看如何安装</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">pnpm create vite</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>选择对应的项目名（vite-project）与模板（vue-ts）</p><p>第二步：打开<code>package.json</code>文件，加一个<code>homepage</code>字段，表示该应用发布后的根目录（参见<a href=\"https://create-react-app.dev/docs/deployment#building-for-relative-paths\" target=\"_blank\" rel=\"noopener noreferrer\">官方文档</a>）。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">\"homepage\": \"https://[username].github.io/vite-project\",</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>上面代码中，将<code>[username]</code>替换成你的 GitHub 用户名。</p><p>第三步：在这个仓库的<code>.github/workflows</code>目录，生成一个 workflow 文件，名字可以随便取，这个示例是<code>ci.yml</code>。</p><p>workflow 文件如下</p><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Build and Deploy</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token key atrule\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> master</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Checkout</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Install and Build</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">|</span><span class=\"token scalar string\" style=\"color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token scalar string\" style=\"color:#a6e22e\">          yarn install</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token scalar string\" style=\"color:#a6e22e\">          yarn run build</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Deploy</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> peaceiris/actions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">gh</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">pages@v3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">personal_token</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> secrets.ACCESS_TOKEN </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">publish_dir</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> ./dist</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>上面这个 workflow 文件的要点如下</p><ol><li>整个流程在<code>master</code>分支发生<code>push</code>事件时触发。</li><li>只有一个<code>job</code>，运行在虚拟机环境<code>ubuntu-latest</code>。</li><li>第一步是获取源码，使用的 action 是<code>actions/checkout</code>。</li><li>第二步是安装依赖与构建，<code>yarn install</code>和<code>yarn run build</code></li><li>第三步是部署到 Github Page 上，使用的 action 是 <a href=\"https://github.com/marketplace/actions/github-pages-action\" target=\"_blank\" rel=\"noopener noreferrer\">peaceiris/actions-gh-pages@v3</a>。其中需要设置 secrets.ACCESS_TOKEN</li></ol><p>第四步：将项目上传置 Github 仓库中，</p><p>该 peaceiris/actions-gh-pages 支持三种 Token，这里使用 personal_token，其生成教程在<a href=\"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token\" target=\"_blank\" rel=\"noopener noreferrer\">官方文档</a>中有详细图文，这里就不贴其生成的图了。<strong>不过记得权限过期以及勾选上 workflow</strong></p><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>Tip</h5></div><div class=\"admonition-content\"><p>token 只会在生成的时候显示一次，如需要再次显示，则可以点击，但使用此令牌的任何脚本或应用程序都需要更新！</p></div></div><p>然后在<strong>Settings -&gt; Secrets -&gt; Actions 中 New repository secret</strong>中便可添加 secret。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511122017247.png\" alt=\"image-20220511122017247\" class=\"img_ev3q\"></p><p>这时候只要一调用 git push，就会触发对应的 workflows 文件配置。点击 Actions 便可看到 jobs 工作。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511122420135.png\" alt=\"image-20220511122420135\" class=\"img_ev3q\"></p><p>此时访问<a href=\"https://kuizuo.github.io/vite-project%E5%B0%B1%E5%8F%AF%E5%91%88%E7%8E%B0vite%E9%A1%B9%E7%9B%AE%EF%BC%88%E4%B8%8D%E8%BF%87%E6%88%91%E5%B7%B2%E7%BB%8F%E6%8A%8A%E4%BB%93%E5%BA%93%E7%BB%99%E5%85%B3%E9%97%AD%E4%BA%86%EF%BC%89%EF%BC%8C%E4%BD%86%E8%BF%9B%E5%85%A5%E4%BC%9A%E7%99%BD%E5%B1%8F%EF%BC%8C%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%8F%90%E7%A4%BA\" target=\"_blank\" rel=\"noopener noreferrer\">https://kuizuo.github.io/vite-project就可呈现vite项目（不过我已经把仓库给关闭了），但进入会白屏，控制台提示</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511122914534.png\" alt=\"image-20220511122914534\" class=\"img_ev3q\"></p><p>很显然，需要静态资源请求的路径错了，正确的应该是<a href=\"https://kuizuo.github.io/vite-project/assets/index.2435d274.js%EF%BC%8C%E6%A0%B9%E6%8D%AEVite%E4%B8%AD%E7%9A%84%5B%E6%9E%84%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%89%88%E6%9C%AC%5D(https://www.vitejs.net/guide/build.html#public-base-path)\" target=\"_blank\" rel=\"noopener noreferrer\">https://kuizuo.github.io/vite-project/assets/index.2435d274.js，根据Vite中的[构建生产版本](https://www.vitejs.net/guide/build.html#public-base-path)</a> 通过命令行参数 <code>--base=/vite-project/</code></p><p>稍加操作在 Install and Build 加上 base 参数</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      - name: Install and Build</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        run: |</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          yarn install</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          yarn run build --base=/vite-project/</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>git push 后，稍等片刻再次访问便可得到如下页面</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511125536189.png\" alt=\"image-20220511125536189\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"将项目发布到自有服务器上\">将项目发布到自有服务器上<a class=\"hash-link\" href=\"#将项目发布到自有服务器上\" title=\"标题的直接链接\">​</a></h2><p>那么现在在 Github Page 上搭建好了，但还要将编译后的文件还可以通过 FTP 协议添加自己的服务器上，这里我就以我的博客为例。</p><p>在服务器中开启 FTP，并添加一个用户名,密码以及根目录(这里我问选择为项目目录)</p><p>workflow 要做的就是新建一个 steps，这里选用 <a href=\"https://github.com/SamKirkland/FTP-Deploy-Action\" target=\"_blank\" rel=\"noopener noreferrer\">FTP-Deploy-Action</a>，以下是我的完整配置内容</p><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Build and Deploy</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Checkout</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Use Node.js 16</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> actions/setup</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">node@v3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">node-version</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'16.x'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> Build Project</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">|</span><span class=\"token scalar string\" style=\"color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token scalar string\" style=\"color:#a6e22e\">          yarn install</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token scalar string\" style=\"color:#a6e22e\">          yarn run build</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> FTP Deploy</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> SamKirkland/FTP</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">Deploy</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\">Action@4.0.0</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">server</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> secrets.ftp_server </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> secrets.ftp_user </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> secrets.ftp_pwd </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">local-dir</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> ./build/</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token key atrule\">server-dir</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> ./</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>相信第一个实例中的 workflow 应该已经明白了，其中 ftp_server，ftp_user，ftp_pwd 都是私密信息，所以需要 New repository secret 设置这三个变量。</p><p>但由于 build 下存在大量文件夹与文件，所以 FTP 速度上传速度堪忧，最终耗时 17 minutes 38.4 seconds。这里只是作为 FTP 演示。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>从上面的演示便可看出 Github Actions 的强大，但其实我挺早之前就了解到它能做这些事情，但迟迟没有动手尝试一番，因为这些自动化操作用人工也是能完成的。也许当时的我认为，用人工所花费的时间远比自动化操作的学习时间来的长，可又随着自己的个人应用增加，每次都需要手动发布，而此时前者的时间已远远大于后者，所以才会想去学习。</p><p>明知该技术是一定会接触的，为何不趁现在去了解学习呢？</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/use-github-action-to-auto-deploy",
            "title": "使用Github Action自动化部署",
            "summary": "如果有写过项目的经历，就免不了将代码上传到服务器上，安装依赖，然后输入启动命令的步骤。但是有的项目往往需要经常性的改动，如果还是照着上面的方式进行部署的话。先不说这样操作的效率，操作个几次就想罢工了。并且上面这样操作的往往容易误操作。而 Github Actions 正是该问题的良药。",
            "date_modified": "2022-05-11T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "github",
                "git"
            ]
        },
        {
            "id": "vercel-deploy-blog",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511170700075.png\" alt=\"image-20220511170700075\" class=\"img_ev3q\"></p><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>观前提醒</h5></div><div class=\"admonition-content\"><p>vercel 部署静态资源网站极其<strong>方便简单</strong>，并且有可观的<strong>访问速度</strong>，最主要的是<strong>免费部署</strong>。</p><p>如果你还没有尝试的话，强烈建议去使用一下。</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vercel-介绍\"><a href=\"https://zhuanlan.zhihu.com/p/452654619\" target=\"_blank\" rel=\"noopener noreferrer\">vercel 介绍</a><a class=\"hash-link\" href=\"#vercel-介绍\" title=\"标题的直接链接\">​</a></h2><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"注册账号\">注册账号<a class=\"hash-link\" href=\"#注册账号\" title=\"标题的直接链接\">​</a></h2><p>进入<a href=\"https://vercel.com\" target=\"_blank\" rel=\"noopener noreferrer\">Vercel</a>官网，先去注册一个账号，建议注册一个<a href=\"https://github.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a>账号后，使用 GIthub 账号来登录 Vercel。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署网站\">部署网站<a class=\"hash-link\" href=\"#部署网站\" title=\"标题的直接链接\">​</a></h2><p>进入 <a href=\"https://vercel.com/dashboard\" target=\"_blank\" rel=\"noopener noreferrer\">Dashboard</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511170233559.png\" alt=\"image-20220511170233559\" class=\"img_ev3q\"></p><p>点击 <a href=\"https://vercel.com/new\" target=\"_blank\" rel=\"noopener noreferrer\">New Project</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511165902993.png\" alt=\"image-20220511165902993\" class=\"img_ev3q\"></p><p>这里可以从已有的 git repository 中导入，也可以选择一个模板。</p><p>这里登录我的 Github 账号选择仓库，然后点击 blog 仓库旁的 Import 即可。当然，你也可以直接拉取我的仓库，仓库地址：<a href=\"https://github.com/kuizuo/blog\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/kuizuo/blog</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511165513526.png\" alt=\"image-20220511165513526\" class=\"img_ev3q\"></p><p>点击 Deploy，然后静等网站安装依赖以及部署，稍后将会出现下方页面。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511170700075.png\" alt=\"image-20220511170700075\" class=\"img_ev3q\"></p><p>此时网站已经成功搭建完毕了，点击图片即可跳转到 vercel 所提供的二级域名访问。</p><p>是不是极其简单？甚至不需要你输入任何命令，便可访问构建好的网站。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自定义域名\">自定义域名<a class=\"hash-link\" href=\"#自定义域名\" title=\"标题的直接链接\">​</a></h2><p>如果有自己的域名，还可以在 vercel 中进行设置。</p><p>首先进入 blog 的控制台，在 Settings -&gt; Domains 添加域名。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511171144240.png\" alt=\"image-20220511171144240\" class=\"img_ev3q\"></p><p>接着提示域名需要 DNS 解析到 vercel 提供的记录值</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511171359148.png\" alt=\"image-20220511171359148\" class=\"img_ev3q\"></p><p>登录所在的域名服务商，根据 Vercel 提供的记录值 cname.vercel-dns.com，添加两条记录</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511172741663.png\" alt=\"image-20220511172741663\" class=\"img_ev3q\"></p><p>此时回到 Vercel，可以看到记录值成功生效。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511172027570.png\" alt=\"image-20220511172027570\" class=\"img_ev3q\"></p><p>此时访问自己的域名，同样也能访问到页面，同时还有可观的访问速度。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自动颁发-ssl-证书\">自动颁发 SSL 证书<a class=\"hash-link\" href=\"#自动颁发-ssl-证书\" title=\"标题的直接链接\">​</a></h3><p>默认状态下，Vercel 将会颁发并自动更新 SSL 证书。（着实方便，不用自己手动去申请证书，同时配置证书）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511172240999.png\" alt=\"image-20220511172240999\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"持续集成ci持续部署cd\">持续集成（CI）/持续部署（CD）<a class=\"hash-link\" href=\"#持续集成ci持续部署cd\" title=\"标题的直接链接\">​</a></h2><blockquote><p>To update your Production Deployment, push to the \"main\" branch.</p></blockquote><p>当主分支有代码被推送，Vercel 将会重新拉取代码，并重新构建进行单元测试与部署（构建速度可观）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220511173442694.png\" alt=\"image-20220511173442694\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"serverless\">Serverless<a class=\"hash-link\" href=\"#serverless\" title=\"标题的直接链接\">​</a></h2><p>同时 vercel 还支持 serverless，也就是说，不仅能部署静态站点，还能部署后端服务，不过肯定有一定的限制。</p><p><a href=\"/examenEbau/develop/Vercel部署Serverless\">Vercel 部署 Serverless</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vercel-cli\">Vercel CLI<a class=\"hash-link\" href=\"#vercel-cli\" title=\"标题的直接链接\">​</a></h2><p>有时候并不想登录网页，然后新建项目，选择仓库，拉取部署，而是希望直接在项目下输入命令来完成部署。vercel 自然肯定提供相对应的脚手架 <strong><a href=\"https://vercel.com/docs/cli\" target=\"_blank\" rel=\"noopener noreferrer\">CLI</a></strong> 供开发者使用。</p><p>安装</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i -g vercel</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在项目根目录中输入</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vercel --prod</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>第一次将进行登录授权，选择对应平台，将会自动打开浏览器完成授权，接着将会确认一些信息，一般默认回车即可，下为执行结果</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Vercel CLI 24.2.1</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Set up and deploy “F:\\Project\\React\\online-tools”? [Y/n] y</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Which scope do you want to deploy to? kuizuo</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Link to existing project? [y/N] n</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? What’s your project’s name? online-tools</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? In which directory is your code located? ./</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Auto-detected Project Settings (Create React App):</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">- Build Command: react-scripts build</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">- Output Directory: build</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">- Development Command: react-scripts start</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Want to override the settings? [y/N] n</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">🔗  Linked to kuizuo12/online-tools (created .vercel and added it to .gitignore)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">🔍  Inspect: https://vercel.com/kuizuo12/online-tools/6t8Vt8rG3waGVHTKU7ZzJuGc6Hoq [2s]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">✅  Production: https://online-tools-phi.vercel.app [copied to clipboard] [2m]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">📝  Deployed to production. Run `vercel --prod` to overwrite later (https://vercel.link/2F).</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">💡  To change the domain or build command, go to https://vercel.com/kuizuo12/online-tools/settings</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>执行完毕后，将会在根目录创建.vercel 文件夹，其中 project.json 中存放 orgId 和 projectId，下面将会用到。此时在<a href=\"https://vercel.com/dashboard\" target=\"_blank\" rel=\"noopener noreferrer\">dashboard</a>中也能看到该项目被部署了。</p><p>不过这样部署上去的代码，并不会连接 git 仓库，需要到控制台中选择仓库即可。</p><p>如果想在 github actions 中使用，则新建一个 steps，设置好对应的变量。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    - name: Deploy to Vercel</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> &nbsp; &nbsp; &nbsp;  run: npx vercel --token ${{VERCEL_TOKEN}} --prod</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> &nbsp; &nbsp; &nbsp;  env:</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>还有一个 VERCEL_TOKEN 需要到 <a href=\"https://vercel.com/account/tokens\" target=\"_blank\" rel=\"noopener noreferrer\">Vercel Settings Tokens</a> 新建一个 Token。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/vercel-deploy-blog",
            "title": "Vercel部署个人博客",
            "summary": "image-20220511170700075",
            "date_modified": "2022-05-11T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "vercel",
                "blog"
            ]
        },
        {
            "id": "kz-admin",
            "content_html": "<p>当时初学 Web 开发的时候，除了写一个网页博客外，第二个选择无非就是一个后台管理系统，可以应用于多种需要数据管理类项目中。</p><p>基于<strong>NestJs + TypeScript + TypeORM + Redis + MySql + Vben Admin</strong>编写的一款前后端分离的权限管理系统</p><p>演示地址：<a href=\"https://admin.kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">KzAdmin</a> 管理员账号：admin 密码：123456</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505171231754.png\" alt=\"image-20220505171231754\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前端\">前端<a class=\"hash-link\" href=\"#前端\" title=\"标题的直接链接\">​</a></h2><p><strong>基于<a href=\"https://vvbin.cn/doc-next/\" target=\"_blank\" rel=\"noopener noreferrer\">Vben Admin</a>开发，使用 Vue3、Vite、TypeScript 等最新技术栈，内置常用功能组件、权限验证、动态路由。</strong></p><p>仓库地址：<a href=\"https://github.com/kuizuo/kz-vue-admin\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/kuizuo/kz-vue-admin</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目结构\"><a href=\"https://vvbin.cn/doc-next/guide/#%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E\" target=\"_blank\" rel=\"noopener noreferrer\">项目结构</a><a class=\"hash-link\" href=\"#项目结构\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── build # 打包脚本相关</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── config # 配置文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── generate # 生成器</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── script # 脚本</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   └── vite # vite配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── mock # mock文件夹</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── public # 公共静态资源目录</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── src # 主目录</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── api # 接口文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── assets # 资源文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── icons # icon sprite 图标文件夹</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── images # 项目存放图片的文件夹</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   └── svg # 项目存放svg图片的文件夹</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── components # 公共组件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── design # 样式文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── directives # 指令</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── enums # 枚举/常量</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── hooks # hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── component # 组件相关hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── core # 基础hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── event # 事件相关hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── setting # 配置相关hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   └── web # web相关hook</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── layouts # 布局文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── default # 默认布局</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── iframe # iframe布局</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   └── page # 页面布局</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── locales # 多语言</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── logics # 逻辑</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── main.ts # 主入口</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── router # 路由配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── settings # 项目配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── componentSetting.ts # 组件配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── designSetting.ts # 样式配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── encryptionSetting.ts # 加密配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── localeSetting.ts # 多语言配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   ├── projectSetting.ts # 项目配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   │   └── siteSetting.ts # 站点配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── store # 数据仓库</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   ├── utils # 工具类</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   └── views # 页面</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── test # 测试</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│   └── server # 测试用到的服务</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│       ├── api # 测试服务器</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│       ├── upload # 测试上传服务器</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">│       └── websocket # 测试ws服务器</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── types # 类型文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├── vite.config.ts # vite配置文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">└── windi.config.ts # windcss配置文件</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"启动项目\">启动项目<a class=\"hash-link\" href=\"#启动项目\" title=\"标题的直接链接\">​</a></h3><p>建议使用 pnpm 包管理器来管理 node 项目，使用<code>npm install -g pnpm</code>即可安装。</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">pnpm install</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">pnpm run dev</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>运行结果</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  vite v2.9.5 dev server running at:</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  &gt; Network:  https://192.168.184.1:3100/</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  &gt; Local:    https://localhost:3100/</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ready in 5057ms.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p>注: 开发环境下首次载入项目会稍慢(Vite 在动态解析依赖)</p></blockquote><p>更多关于前端项目规范可直接参考 <a href=\"https://vvbin.cn/doc-next/guide/introduction.html\" target=\"_blank\" rel=\"noopener noreferrer\">Vben Admin 文档 </a>，非常详细了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"后端\">后端<a class=\"hash-link\" href=\"#后端\" title=\"标题的直接链接\">​</a></h2><p><strong>基于 NestJs + TypeScript + TypeORM + Redis + MySql 编写的前后端分离权限管理系统</strong></p><p>仓库地址：<a href=\"https://github.com/kuizuo/kz-nest-admin\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/kuizuo/kz-nest-admin</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目结构-1\"><a href=\"https://blog.si-yee.com/sf-admin-cli/nest/usage.html#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E8%AF%B4%E6%98%8E\" target=\"_blank\" rel=\"noopener noreferrer\">项目结构</a><a class=\"hash-link\" href=\"#项目结构-1\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─setup-swagger.ts # Swaager文档配置</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─main.ts # 主入口</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─config # 配置文件</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─shared</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─redis # redisModule</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─redis.module.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─redis.interface.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─redis.constants.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─shared.module.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─services # 全局通用Provider</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─app.module.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─mission</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─mission.module.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─mission.decorator.ts # 任务装饰器，所有任务都需要定义该装饰器，否则无法运行</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─jobs # 后台定时任务定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─common # 系统通用定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─dto # 通用DTO定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─contants</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─error-code.contants.ts # 系统错误码定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─decorator.contants.ts # 装饰器常量</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─filters # 通用过滤器定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─interceptors # 通用拦截器定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─decorators # 通用装饰器定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─exceptions # 系统内置通用异常定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─class # Class Model 不使用Interface定义，使用Interface无法让Swagger识别</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─modules</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─admin</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─core # 核心功能</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | | |─interceptors # 后台管理拦截器定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | | |─decorators # 后台管理注解定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | | |─provider # 后台管理提供者定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | | |─guards # 后台管理守卫定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─system # 系统模块定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─account # 用户账户模块定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─login # 登录模块定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─admin.module.ts # 后台管理模块</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─admin.constants.ts # 后台管理模块通用常量</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| | |─admin.interface.ts # Admin通用interface定义</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">| |─ws # Socket模块</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|─entities # TypeORM 实体文件定义</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"启动项目-1\">启动项目<a class=\"hash-link\" href=\"#启动项目-1\" title=\"标题的直接链接\">​</a></h3><p>依赖安装与执行打包命令前端与后端一致，但需要提前修改.env.development 中数据库相关配置，并执行 sql/init.sql 来初始化数据。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实现\">实现<a class=\"hash-link\" href=\"#实现\" title=\"标题的直接链接\">​</a></h3><p>项目中大部分的目录结构设计参照与<a href=\"https://github.com/hackycy/sf-nest-admin\" target=\"_blank\" rel=\"noopener noreferrer\">sf-nest-admin</a>，但主要为了贴合自我的代码风格修改部分数据字段名，接口方法，接口响应格式等等。</p><p>同时对于大部分这类后台管理的 demo，通常都会定义用户，角色，菜单，部门。而我将部门相关代码删除，因为对于我后续项目大概率用不上这些部分，然后删了一些不相关的模块，主要写的这套模板还是用作自己后续的管理类项目。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"用户-角色-权限\">用户-角色-权限<a class=\"hash-link\" href=\"#用户-角色-权限\" title=\"标题的直接链接\">​</a></h4><p>这套系统中最为重要的一部分便是权限管理，不过在这套后台管理系统中这里的权限与菜单共用，前端路由渲染菜单，后端鉴权。后文的菜单表也就作为权限表而言。</p><p>在这三张表中关系如下（这里使用外键与数据库模型为例，实际项目并未用到外键，也不推荐使用）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220508235534026.png\" alt=\"image-20220508235534026\" class=\"img_ev3q\"></p><p>用户-角色 与 角色-权限都采用的多对多的关系，即新创建一个表用于映射两表关系。这些都属于 mysql 基础，不做过多赘述。</p><p>在权限管理中，最为重要的便是权限表了，由于这套后台管理系统中还涉及到前端的左侧菜单，所以将这里的 permission 表替换为 menu 表，字段 permission 表示权限值。数据库中的 menu 表如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220508234343594.png\" alt=\"image-20220508234343594\" class=\"img_ev3q\"></p><p>对于主要字段介绍：</p><ul><li><p><strong>parent</strong>：对于有父子关系的表，会创建一个 parent_id(这里为 parent)字段用于表示父节点，无则为顶级节点。</p></li><li><p><strong>permission</strong>：权限标识，根据后端接口而定，比如新增用户的 url 为<code>sys/user/add</code>，那么权限标识通常将/替换成:，也就是<code>sys:user:add</code>（主要防止和接口的 url 混淆）。</p></li><li><p><strong>type</strong>：0 目录 1 菜单(前端组件) 2 权限，由于是菜单与权限混用，所以用 type 来区分。</p></li><li><p><strong>icon</strong>：左侧菜单图标</p></li><li><p><strong>order_no</strong>：左侧菜单排序</p></li><li><p><strong>component</strong>：组件，目录为 LAYOUT，菜单则为对应组件，权限则无</p></li></ul><p>有了这些数据，要做的是将他们拼接为<strong>前端菜单管理</strong>，<strong>根据角色获取所有菜单</strong>，<strong>根据用户的所有权限</strong>的树结构数据。</p><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前端菜单管理\">前端菜单管理<a class=\"hash-link\" href=\"#前端菜单管理\" title=\"标题的直接链接\">​</a></h5><p>获取所有的菜单列表数据，通过递归生成对应的菜单树结构，具体递归代码在<code>src/modules/core/permission/index.ts</code>中的<code>generatorMenu</code>方法中。</p><p>具体拼接数据过多，可自行打开控制台(F12)-&gt;网络 到菜单管理页中获取数据可得，这里便不做展示（后文拼接数据同理）。</p><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"根据角色获取所有菜单\">根据角色获取所有菜单<a class=\"hash-link\" href=\"#根据角色获取所有菜单\" title=\"标题的直接链接\">​</a></h5><p>首先根据用户 id 找到该用户的所有角色 id，然后通过联表找到角色 id 所对应的菜单数据。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/**</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   * 根据角色获取所有菜单</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getMenus</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">uid</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">number</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">Promise</span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> roleIds </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">roleService</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getRoleIdByUser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">uid</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> menus</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> SysMenu</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">includes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">roleIds</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">rootRoleId</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      menus </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">menuRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> order</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> orderNo</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ASC'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      menus </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">menuRepository</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">createQueryBuilder</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">innerJoinAndSelect</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'sys_role_menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'role_menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'menu.id = role_menu.menu_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">andWhere</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'role_menu.role_id IN (:...roldIds)'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> roldIds</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> roleIds </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">orderBy</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'menu.order_no'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ASC'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getMany</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> menuList </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generatorRouters</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">menus</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> menuList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同样<code>generatorRouters</code>函数也在<code>src/modules/core/permission/index.ts</code>中。</p><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"根据用户的所有权限\">根据用户的所有权限<a class=\"hash-link\" href=\"#根据用户的所有权限\" title=\"标题的直接链接\">​</a></h5><p>与上例一样，不过这里主要获取的是 permission 字段，所以在条件上添加了<code>menu.type = 2</code>与<code>menu.permission IS NOT NULL</code>，将 permission 拼接为一个数组。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/**</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   * 获取当前用户的所有权限</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getPerms</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">uid</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">number</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">Promise</span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> roleIds </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">roleService</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getRoleIdByUser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">uid</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> permission</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">includes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">roleIds</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">rootRoleId</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">menuRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        permission</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">Not</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">IsNull</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">menuRepository</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">createQueryBuilder</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">innerJoinAndSelect</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'sys_role_menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'role_menu'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'menu.id = role_menu.menu_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">andWhere</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'role_menu.role_id IN (:...roldIds)'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> roldIds</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> roleIds </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">andWhere</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'menu.type = 2'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">andWhere</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'menu.permission IS NOT NULL'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getMany</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token function\" style=\"color:#e6db74\">isEmpty</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        permission </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">concat</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">permission</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">permission</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">split</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">','</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      permission </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">uniq</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">permission</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> permission</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>permission 的值如</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"sys:user:add\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"sys:user:delete\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"sys:user:update\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"sys:user:list\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"sys:user:info\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后在 auth.guard.ts 守卫中获取 permission，然后每次请求需要鉴权的接口时，将权限标识转为接口 url，判断是否包含该 url，不包含则无访问权限。</p><p>在<a href=\"https://admin.kuizuo.cn/#/system/menu\" target=\"_blank\" rel=\"noopener noreferrer\">菜单管理页</a>中可操作菜单，具体可自测。</p><p>至此，菜单表的数据被拆分为这 3 部分数据，以实现权限管理，动态路由的目的。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"后台-websocket-服务重启后导致前端-websocket-断开\">后台 webSocket 服务重启后，导致前端 webSocket 断开<a class=\"hash-link\" href=\"#后台-websocket-服务重启后导致前端-websocket-断开\" title=\"标题的直接链接\">​</a></h4><p>后台 webSocket 服务重启后，会导致 vite 下 dev 模式崩溃，报如下错误</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Error: read ECONNRESET</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at TLSWrap.onStreamRead (node:internal/stream_base_commons:220:20)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Emitted 'error' event on TLSSocket instance at:</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at emitErrorNT (node:internal/streams/destroy:157:8)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at emitErrorCloseNT (node:internal/streams/destroy:122:3)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at processTicksAndRejections (node:internal/process/task_queues:83:21) {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  errno: -4077,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  code: 'ECONNRESET',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  syscall: 'read'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其问题是由 vite 开发服务器的反向代理断连导致的。</p><p>但目前没有一个很好的解决方案，日常开发中会将 store/modules/user.ts 下的 getUserInfoAction 方法中 websocket 连接的代码给屏蔽了。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> wsStore </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useWsStore</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">wsStore</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">client </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> wsStore</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">initSocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他文档\">其他文档<a class=\"hash-link\" href=\"#其他文档\" title=\"标题的直接链接\">​</a></h4><p><a href=\"https://console-docs.apipost.cn/preview/33adde8eab3596f4/5667cbce79bf9c98\" target=\"_blank\" rel=\"noopener noreferrer\">apipost 文档</a> 密码: kz-admin</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"致谢\">致谢<a class=\"hash-link\" href=\"#致谢\" title=\"标题的直接链接\">​</a></h2><ul><li><a href=\"https://github.com/hackycy/sf-nest-admin\" target=\"_blank\" rel=\"noopener noreferrer\">sf-nest-admin</a></li><li><a href=\"https://github.com/buqiyuan/vite-vue3-admin\" target=\"_blank\" rel=\"noopener noreferrer\">vite-vue3-admin</a></li><li><a href=\"https://github.com/vbenjs/vue-vben-admin\" target=\"_blank\" rel=\"noopener noreferrer\">vue-vben-admin</a></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"写后感\">写后感<a class=\"hash-link\" href=\"#写后感\" title=\"标题的直接链接\">​</a></h2><p>其实一年多前我就想写一套相对完善的后台管理系统的模板，供自己后续的一些项目中使用。然而迟迟没有动手写套模板，而是不断根据业务需求，修修改改写了一套乱七八糟的代码，以至于维护的时候究极痛苦。就在不久前正好也用到，然而也是把之前写的屎山一样的代码拿来修改。</p><p><strong>我所遇到的问题：项目结构乱，代码风格乱，维护代码极其折磨</strong></p><p>所以今年寒假于是准备完善这套模板，然而当时只是创建完工程结构，到现在才正式把功能实现以及测试相关，部署搞定。说真的，非常拖延，甚至都快让我放弃写这个模板的打算。但拖也对我有一定的好处，为什么这么说？因为当时有这个想法时，市面上关于这套技术栈的实现还很少，而等我寒假再去搜索相关实现的时候，却有相关开源的代码，而这便可供我学习，使项目更加完善。</p><p>回顾整体项目的编写过程，所花费的时间可能一个月不到，甚至更少，但往往就是各种各样的拖延导致项目逾期，或者是学习某个技术栈。难以将精力集中起来完成任务，至于原因，也许是目标过于庞大，或许是日常生活中的各种琐事，不过我想多半是自我的懒惰。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/kz-admin",
            "title": "kz-admin后台管理系统",
            "summary": "当时初学 Web 开发的时候，除了写一个网页博客外，第二个选择无非就是一个后台管理系统，可以应用于多种需要数据管理类项目中。",
            "date_modified": "2022-05-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "project",
                "admin",
                "vue",
                "nest"
            ]
        },
        {
            "id": "about-open-source-license",
            "content_html": "<p>虽然知道开源有个许可证 LICENSE，但一直没给自己写的一些开源项目选择开源许可证。于是准备系统了解一下开源许可证，以及如何为 Github 项目添加 LICENSE。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"osiopen-source-initiative\">OSI(Open Source Initiative)<a class=\"hash-link\" href=\"#osiopen-source-initiative\" title=\"标题的直接链接\">​</a></h3><p>即开发源代码组织，是一个旨在推动开源软件发展的非盈利组织。可以在 <a href=\"https://opensource.org/licenses/alphabetical\" target=\"_blank\" rel=\"noopener noreferrer\">Open Source Initiative</a> 中查看所有的开源协议。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"开源许可证\">开源许可证<a class=\"hash-link\" href=\"#开源许可证\" title=\"标题的直接链接\">​</a></h2><p>关于开源许可证的简单区别</p><p><img loading=\"lazy\" src=\"https://www.ruanyifeng.com/blogimg/asset/201105/bg2011050101.png\" alt=\"img\" class=\"img_ev3q\"></p><p>至于如何选择，下图更加通俗易懂</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/2019-04-29-072557.png\" alt=\"快速选择协议\" class=\"img_ev3q\"></p><p>其中开源许可证可分为两大类</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"宽松式permissive许可证\">宽松式（permissive）许可证<a class=\"hash-link\" href=\"#宽松式permissive许可证\" title=\"标题的直接链接\">​</a></h3><p>宽松式许可证（permissive license）是最基本的类型，对用户几乎没有限制。用户可以修改代码后闭源。</p><p>它有三个基本特点。</p><p><strong>（1）没有使用限制</strong></p><p>用户可以使用代码，做任何想做的事情。</p><p><strong>（2）没有担保</strong></p><p>不保证代码质量，用户自担风险。</p><p><strong>（3）披露要求（notice requirement）</strong></p><p>用户必须披露原始作者。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"常见许可证\">常见许可证<a class=\"hash-link\" href=\"#常见许可证\" title=\"标题的直接链接\">​</a></h4><p>常见的宽松式许可证有四种。它们都允许用户任意使用代码，区别在于要求用户遵守的条件不同。</p><p><strong>（1）BSD（二条款版）</strong></p><p>分发软件时，必须保留原始的许可证声明。</p><p><strong>（2） BSD（三条款版）</strong></p><p>分发软件时，必须保留原始的许可证声明。不得使用原始作者的名字为软件促销。</p><p><strong>（3）MIT</strong></p><p>分发软件时，必须保留原始的许可证声明，与 BSD（二条款版）基本一致。</p><p><strong>（4）Apache 2</strong></p><p>分发软件时，必须保留原始的许可证声明。凡是修改过的文件，必须向用户说明该文件修改过；没有修改过的文件，必须保持许可证不变。</p><p>不难看出这类许可证要求相对宽松，市面上大部分的开源项目主要以 MIT 和 Apache 两者为主。使用 MIT 协议开源项目如 vue，react，bootstrap，vscode，electron，axios，terminal 等等，作为大多数开发者而言，MIT 无法是最好的选择。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"copyleft-许可证\">Copyleft 许可证<a class=\"hash-link\" href=\"#copyleft-许可证\" title=\"标题的直接链接\">​</a></h3><p>Copyleft 是<a href=\"https://www.ruanyifeng.com/blog/2005/03/post_112.html\" target=\"_blank\" rel=\"noopener noreferrer\">理查德·斯托曼</a>发明的一个词，作为 Copyright （版权）的反义词。</p><p>Copyright 直译是\"复制权\"，这是版权制度的核心，意为不经许可，用户无权复制。作为反义词，Copyleft 的含义是不经许可，用户可以随意复制。</p><p>但是，它带有前提条件，比宽松式许可证的限制要多。</p><blockquote><ul><li>如果分发二进制格式，必须提供源码</li><li>修改后的源码，必须与修改前保持许可证一致</li><li>不得在原始许可证以外，附加其他限制</li></ul></blockquote><p>上面三个条件的核心就是：修改后的 Copyleft 代码不得闭源。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"常见许可证-1\">常见许可证<a class=\"hash-link\" href=\"#常见许可证-1\" title=\"标题的直接链接\">​</a></h4><p>常见的 Copyleft 许可证也有四种（对用户的限制从最强到最弱排序）。</p><p><strong>（1）Affero GPL (AGPL)</strong></p><p>如果云服务（即 SAAS）用到的代码是该许可证，那么云服务的代码也必须开源。</p><p><strong>（2）GPL</strong></p><p>如果项目包含了 GPL 许可证的代码，那么整个项目都必须使用 GPL 许可证。</p><p><strong>（3）LGPL</strong></p><p>如果项目采用动态链接调用该许可证的库，项目可以不用开源。</p><p><strong>（4）Mozilla（MPL）</strong></p><p>只要该许可证的代码在单独的文件中，新增的其他文件可以不用开源。</p><blockquote><p>参考文章</p><p><a href=\"https://www.ruanyifeng.com/blog/2017/10/open-source-license-tutorial.html\" target=\"_blank\" rel=\"noopener noreferrer\">开源许可证教程 - 阮一峰的网络日志 (ruanyifeng.com)</a></p><p><a href=\"https://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html\" target=\"_blank\" rel=\"noopener noreferrer\">如何选择开源许可证？ - 阮一峰的网络日志 (ruanyifeng.com)</a></p><p><a href=\"https://juejin.cn/post/6844903925863153672\" target=\"_blank\" rel=\"noopener noreferrer\">五分钟看懂开源协议</a></p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"github-项目添加-license\">Github 项目添加 LICENSE<a class=\"hash-link\" href=\"#github-项目添加-license\" title=\"标题的直接链接\">​</a></h2><p>Github 官方专门制作了一个网站 <a href=\"https://choosealicense.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Choose a License</a> 帮助大家选择合适的开源，License。中文版也有 <a href=\"https://choosealicense.rustwiki.org/\" target=\"_blank\" rel=\"noopener noreferrer\">选择一个开源许可证</a>。不过我更推荐下面在 Github 仓库页中来新增 LICENSE。</p><p>在仓库页中，Add file-&gt; Create new file</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505190634653.png\" alt=\"image-20220505190634653\" class=\"img_ev3q\"></p><p>输入 LICENSE（建议大写），右侧将会弹出 Choose a license template，这里我选择 MIT 协议</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505190758791.png\" alt=\"image-20220505190758791\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505191409696.png\" alt=\"image-20220505191409696\" class=\"img_ev3q\"></p><p>点击 Review and submit，此时就会回到添加文件的地方，并且自动为你填写好 Message，接着点击 Commit new file 即可</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505200951047.png\" alt=\"image-20220505200951047\" class=\"img_ev3q\"></p><p>整个许可证内容如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">MIT License</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Copyright (c) 2022 kuizuo</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Permission is hereby granted, free of charge, to any person obtaining a copy</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">of this software and associated documentation files (the \"Software\"), to deal</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">in the Software without restriction, including without limitation the rights</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">copies of the Software, and to permit persons to whom the Software is</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">furnished to do so, subject to the following conditions:</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">The above copyright notice and this permission notice shall be included in all</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">copies or substantial portions of the Software.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">SOFTWARE.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>再次刷新便可看到效果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220505201138476.png\" alt=\"image-20220505201138476\" class=\"img_ev3q\"></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/about-open-source-license",
            "title": "关于开源许可证",
            "summary": "虽然知道开源有个许可证 LICENSE，但一直没给自己写的一些开源项目选择开源许可证。于是准备系统了解一下开源许可证，以及如何为 Github 项目添加 LICENSE。",
            "date_modified": "2022-05-05T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "open-source",
                "git"
            ]
        },
        {
            "id": "code-backup",
            "content_html": "<p>前段时间因为笔记本不在身边，导致一些本地磁盘代码数据没法直接同步过来。于是就准备把这些年写的代码重新整理一下，谈谈常用备份手段以及我的<a href=\"#%E6%9C%80%E4%BD%B3%E5%AE%9E%E7%8E%B0\">最佳手段</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"备份手段\">备份手段<a class=\"hash-link\" href=\"#备份手段\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"本地硬盘\">本地硬盘<a class=\"hash-link\" href=\"#本地硬盘\" title=\"标题的直接链接\">​</a></h3><p>大多数代码的存储方式，方便存取，我通常会新建一个驱动器 <strong>代码 (F:)</strong> 来将所有代码放在此处，可能还会自备一个移动硬盘来存储代码。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优点\">优点<a class=\"hash-link\" href=\"#优点\" title=\"标题的直接链接\">​</a></h4><p>无需网络，保存时间久，<strong>读写数据快</strong>。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"缺点\">缺点<a class=\"hash-link\" href=\"#缺点\" title=\"标题的直接链接\">​</a></h4><p>数据同步不方便，难以做到跨端跨设备共享。万一硬盘出了点问题，代码将难以恢复。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"网盘\">网盘<a class=\"hash-link\" href=\"#网盘\" title=\"标题的直接链接\">​</a></h3><p>例如某度网盘，Onedrive 等等，这类备份通常有一定的限制，例如下载限速严重，空间限制，保存期限等等，具体以实际使用网盘为例。</p><p>在某度网盘中，选择你的想备份的文件夹，是可以做到文件夹自动备份，但对于你项目中的依赖文件（例如 Node 的 node_module）那不小的空间也将备份，但有文件夹数量以及大小限制，如下图，这里只是简单一提，不作为备用手段。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220502153823417.png\" alt=\"image-20220502153823417\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优点-1\">优点<a class=\"hash-link\" href=\"#优点-1\" title=\"标题的直接链接\">​</a></h4><p>相比本地硬盘而已，<strong>网盘更易分享</strong>，在其他设备中只需要登录网盘账号或访问网盘所分享的链接。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"缺点-1\">缺点<a class=\"hash-link\" href=\"#缺点-1\" title=\"标题的直接链接\">​</a></h4><p>有些免费的网盘，必然有一定的限制，例如空间限制，下载限制，远不如本地硬盘。如果不付费的话，体验效果堪忧。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码托管平台\">代码托管平台<a class=\"hash-link\" href=\"#代码托管平台\" title=\"标题的直接链接\">​</a></h3><p>代码托管平台有很多，例如 Github、Gitee 等等，甚至可以自建一个像 GItLab 的代码托管平台。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优点-2\">优点<a class=\"hash-link\" href=\"#优点-2\" title=\"标题的直接链接\">​</a></h4><p><strong>代码实时性强</strong>，并且基于 Git 版本管理工具可以很方便查看代码的历史操作，对于项目类的而言非常方便。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"缺点-2\">缺点<a class=\"hash-link\" href=\"#缺点-2\" title=\"标题的直接链接\">​</a></h4><p>对于一些公有项目而言，一些私密信息（密码）不易于上传，在其他设备拉取代码就不存在这部分数据。同时<strong>对于大量代码就束手无策</strong>。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最佳实现\">最佳实现<a class=\"hash-link\" href=\"#最佳实现\" title=\"标题的直接链接\">​</a></h2><p>介绍完上面的几种代码备份手段，各自都有优缺点，至于如何选择就因人而异，这里就说说我是如何备份代码的。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"全部代码\">全部代码<a class=\"hash-link\" href=\"#全部代码\" title=\"标题的直接链接\">​</a></h3><p>对于全部代码而言，肯定是多备份远优于不备份的。所以我通常会在本地电脑硬盘中备份两份代码，一份就正常放在固态硬盘上，另一份则放在机械硬盘，同时再备份一份代码在网盘上。</p><p>但机械硬盘与网盘的备份时间一致，都是定期或阶段性的备份（甚至可能会忘记备份），所以这种对代码的实时性要求不高，通常这类代码为学习代码以及工具类相关代码。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目代码\">项目代码<a class=\"hash-link\" href=\"#项目代码\" title=\"标题的直接链接\">​</a></h3><p>对于项目代码而言，我是毫不犹豫的选择代码托管平台，使用到版本管理工具 Git，可以很好的查看代码的全部历史记录以及修改追踪能力。易于维护的同时，代码分享与同步也比网盘来的高效。设置好.gitignore 也不会将非必要的文件（依赖文件，打包后的文件，生产环境下的配置文件）上传上去。而 Github 便是我最好的选择，里面存放了或多或少的开源与私有项目，每次在其他设备上只需要登录 github，然后 clone 项目，便可开始 coding。</p><p><strong>通常来说备份项目代码就已经足够了，毕竟这类代码往往会有一定的价值性。</strong></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"文章笔记备份\">文章笔记备份<a class=\"hash-link\" href=\"#文章笔记备份\" title=\"标题的直接链接\">​</a></h3><p>除了代码备份外，此外笔记也十分重要，毕竟有时候自己写的代码，自己甚至都不一定明白。对于文章数据以及笔记，我通常会使用云端协作平台，这类产品有 wolai，notion，语雀等等，不过我个人还是相对倾向于使用 <a href=\"https://www.wolai.com/\" target=\"_blank\" rel=\"noopener noreferrer\">wolai</a>。可多端设备查看，实时编辑等等，体验还算 ok。</p><p>此外一些博客文章，就会同步在<a href=\"https://kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">个人博客</a>以及<a href=\"https://juejin.im/user/1565318510545901/activities\" target=\"_blank\" rel=\"noopener noreferrer\">掘金</a>上，当然博客的静态站点的代码仓库也是存放在<a href=\"https://github.com/kuizuo/blog\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a>上。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"不必要的代码不要备份\">不必要的代码不要备份<a class=\"hash-link\" href=\"#不必要的代码不要备份\" title=\"标题的直接链接\">​</a></h3><p>对于很多代码其实都没备份的必要，例如我在安卓学习的时候，涉及到的刷机包（少说 2 个 g），以及各种 apk。完全可以直接备份其下载地址，而不是选择备份。</p><p>像临时用脚手架创建的工程文件或是下载别人的代码，这类通常就临时使用（甚至不会再打开第二次），完全没有必要备份理由。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"请压缩后在备份\">请压缩后在备份<a class=\"hash-link\" href=\"#请压缩后在备份\" title=\"标题的直接链接\">​</a></h3><p>如果不压缩文件夹，备份时将逐个读取文件特别耗时，同时压缩完代码还可以节省一定的空间。也许在一开始备份时会相对麻烦，但在上传与下载以及多次备份时就一举两便。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p><strong>永远不要嫌备份麻烦，当你辛辛苦苦写的代码丢失时，那才是真正的麻烦。</strong></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/code-backup",
            "title": "代码备份方案",
            "summary": "前段时间因为笔记本不在身边，导致一些本地磁盘代码数据没法直接同步过来。于是就准备把这些年写的代码重新整理一下，谈谈常用备份手段以及我的最佳手段",
            "date_modified": "2022-05-02T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "code"
            ]
        },
        {
            "id": "gitlab-code-management-environment",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414235645607.png\" alt=\"image-20220414235645607\" class=\"img_ev3q\"></p><p>我只要有代码的项目，都会放到 Github 上，无论公开还是私有项目。一是相当于在云端备份了一份代码，二是可以很方便的分享给别人。但对于私有项目而言存放在别人那总归不好，而且Github 时常会出现无法访问的情况（即使搭了梯子）。所以就打算搭建一个私有的仓库，基于<a href=\"https://gitlab.com/\" target=\"_blank\" rel=\"noopener noreferrer\">GitLab</a>。</p><p>可以访问 <a href=\"https://gitlab.kuizuo.cn/kuizuo\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo · GitLab</a> 来查看搭建效果。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"页面概览\">页面概览<a class=\"hash-link\" href=\"#页面概览\" title=\"标题的直接链接\">​</a></h2><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220415013028002.png\" alt=\"image-20220415013028002\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前提\">前提<a class=\"hash-link\" href=\"#前提\" title=\"标题的直接链接\">​</a></h2><p>一台服务器，系统 Linux，内存 &gt;=4g</p><p>我的轻量应用服务器配置如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414210129510.png\" alt=\"image-20220414210129510\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"搭建\">搭建<a class=\"hash-link\" href=\"#搭建\" title=\"标题的直接链接\">​</a></h2><p>服务器我选择安装<a href=\"https://www.bt.cn/new/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">宝塔面板</a>，对于个人项目，还是很推荐安装的，集成了一些软件商店，包括本次的主角，同时提供可视化页面操作，能省下很多敲命令的时间，<del>同时也会增加忘记命令的记忆</del>。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-gitlab\">安装 GitLab<a class=\"hash-link\" href=\"#安装-gitlab\" title=\"标题的直接链接\">​</a></h3><p>进入宝塔面板，点击软件商店，找到<strong>GitLab 最新社区版</strong>，点击安装</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414204808143.png\" alt=\"image-20220414204808143\" class=\"img_ev3q\"></p><p>实测等了 8 分钟，安装完毕即可查看 GitLab 的访问地址，账号密码。默认端口号 8099，记得在防火墙开放下该端口</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414213002293.png\" alt=\"image-20220414213002293\" class=\"img_ev3q\"></p><p>进入访问地址就可以看到 GitLab 的登录页面了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"修改密码\">修改密码<a class=\"hash-link\" href=\"#修改密码\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docs.gitlab.com/ee/security/reset_user_password.html#reset-the-root-password\" target=\"_blank\" rel=\"noopener noreferrer\">Reset a user's password | GitLab</a></p><p>进入控制台（进入要稍等一段时间）</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">sudo gitlab-rails console</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>显示页面如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">[root@VM-4-5-centos ~]# sudo gitlab-rails console</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">--------------------------------------------------------------------------------</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> Ruby:         ruby 2.7.5p203 (2021-11-24 revision f69aeb8314) [x86_64-linux]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> GitLab:       14.9.3 (ec11aba56f1) FOSS</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> GitLab Shell: 13.24.0</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> PostgreSQL:   12.7</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">------------------------------------------------------------[ booted in 29.71s ]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Loading production environment (Rails 6.1.4.6)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):001:0&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>输入如下代码</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">u=User.find(1)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">u.password='a12345678'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">u.password_confirmation = 'a12345678'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">u.save!</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>输出结果</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):001:0&gt; u=User.find(1)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">=&gt; #&lt;User id:1 @root&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):002:0&gt; u.password='a12345678'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">=&gt; \"a12345678\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):003:0&gt; u.password_confirmation = 'a12345678'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">=&gt; \"a12345678\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):004:0&gt; u.save!</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">=&gt; true</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">irb(main):005:0&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最后输入<code>exit</code>退出控制台，然后输入下方代码重启 gitlab，密码就设置完毕了</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">gitlab-ctl restart</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"admonition admonition-info alert alert--info\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>info</h5></div><div class=\"admonition-content\"><p>若重启或修改端口等操作后出现 502 错误，您可能需要等待 3-5 分钟才能正常访问 GitLab</p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"修改语言\">修改语言<a class=\"hash-link\" href=\"#修改语言\" title=\"标题的直接链接\">​</a></h3><p>点击右上角的头像-&gt;Preferences 进入到设置，找到语言设置为简体中文，然后点击左小角的 Save changes。刷新网页语言就设置完毕了</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414215528543.png\" alt=\"image-20220414215528543\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置https\">配置HTTPS<a class=\"hash-link\" href=\"#配置https\" title=\"标题的直接链接\">​</a></h3><p>gitlab内部集成了letsencrypt，因此，这里只需要启用letsencrypt，并进行一些必要的配置</p><p>打开/opt/gitlab/etc/gitlab.rb.template，修改以下内容</p><ol><li><p>在32行左右，将external_url前面的#删掉，并在单引号中填写gitlab服务器的https地址，例如<a href=\"https://gitlab.kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://gitlab.kuizuo.cn</a></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> external_url 'https://gitlab.kuizuo.cn'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></li><li><p>gitlab默认占用nginx80端口，所以需要更改下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">nginx['listen_port'] = 8100</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></li><li><p>在2434行左右（可通过搜索letsencrypt定位），修改下面几项</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">letsencrypt['enable'] = true #删除前面的#号，并将值修改为true</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">letsencrypt['contact_emails'] = ['kuizuo12@gmail.com'] #删除前面的#号,修改为自己的邮箱</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">letsencrypt['auto_renew'] = true #删除前面的#号  自动更新</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></li></ol><p>然后重载配置（需要一点时间）</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">gitlab-ctl reconfigure</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后重启gitlab使配置生效</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">gitlab-ctl restart</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>gitlab就会通过letsencrypt自动签发免费的HTTPS证书，等证书签发成功，就可以通过上面指定的域名访问代码仓库了。</p><p><strong>其实也可以在nginx创建一个站点，然后该站点配置ssl，通过反向代理到127.0.0.1:8099 也是能实现配置HTTPS的。（推荐）</strong></p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>如果上面的操作的话，可能会导致gitlab的nginx无法启动（原因应该是修改了gitlab自带的nginx服务，或者与自带的冲突）。修改<code>/opt/gitlab/sv/nginx/run</code></p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">exec chpst -P /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 改为</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">exec chpst -P /opt/gitlab/embedded/sbin/gitlab-web -p /var/opt/gitlab/nginx</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>重启gitlab</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">gitlab-ctl start</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"管理中心\">管理中心<a class=\"hash-link\" href=\"#管理中心\" title=\"标题的直接链接\">​</a></h2><p>点击左上角的菜单选择管理员，可在管理中心设置GitLab的相关设置。例如</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"禁止注册\">禁止注册<a class=\"hash-link\" href=\"#禁止注册\" title=\"标题的直接链接\">​</a></h3><p>在设置-&gt;通用-&gt;注册限制，取消勾选 <strong>已启动注册功能</strong>，这样就可以禁止注册（页面无注册按钮）。当然也可以允许，然后需要批准以及确认邮箱。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220415004207174.png\" alt=\"image-20220415004207174\" class=\"img_ev3q\"></p><p>在概览-&gt;用户中可以查看相关用户信息。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220415012817311.png\" alt=\"image-20220415012817311\" class=\"img_ev3q\"></p><p>至于其他设置自行研究了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"创建项目\">创建项目<a class=\"hash-link\" href=\"#创建项目\" title=\"标题的直接链接\">​</a></h2><p>点击新建项目，这里就导入我的 blog 项目。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414220221480.png\" alt=\"image-20220414220221480\" class=\"img_ev3q\"></p><p>选择 Github 后，会提示使用 GitHub 身份验证，这里需要拿到 Github 的<a href=\"https://github.com/settings/tokens\" target=\"_blank\" rel=\"noopener noreferrer\">Token</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414220333437.png\" alt=\"image-20220414220333437\" class=\"img_ev3q\"></p><p>访问<a href=\"https://github.com/settings/tokens%EF%BC%8C%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AAToken%EF%BC%8C%E9%80%89%E6%8B%A9token%E6%9C%89%E6%95%88%E6%9C%9F%EF%BC%8C%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%9D%83%E9%99%90%EF%BC%88%E6%88%91%E8%BF%99%E8%BE%B9%E9%80%89%E6%8B%A9%E5%85%A8%E9%80%89%EF%BC%8Ctoken%E4%B8%8D%E8%BF%87%E6%9C%9F%EF%BC%89\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/settings/tokens，新建一个Token，选择token有效期，以及相关权限（我这边选择全选，token不过期）</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414220507016.png\" alt=\"image-20220414220507016\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414220738714.png\" alt=\"image-20220414220738714\" class=\"img_ev3q\"></p><p>生成完毕后复制该 Token 到 GitLab 上，就可以看到该 Github 账号下的所有仓库了，这里我选择 blog 进行导入（导入需要一点时间）。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414220858379.png\" alt=\"image-20220414220858379\" class=\"img_ev3q\"></p><p>导入完毕后与原仓库无特别区别</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414224639573.png\" alt=\"image-20220414224639573\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自动同步项目\">自动同步项目<a class=\"hash-link\" href=\"#自动同步项目\" title=\"标题的直接链接\">​</a></h3><p>点击项目中设置-&gt;仓库，找到镜像仓库。在 Git 仓库 URL 中填写格式如下</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 原仓库git</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token literal-property property\" style=\"color:#f92672\">https</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">github</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">com</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">kuizuo</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">blog</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在https://后加上username@</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token literal-property property\" style=\"color:#f92672\">https</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">kuizuo@github</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">com</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">kuizuo</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">blog</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>密码为上面的 Token（如果忘记的话，可以在 Github 的 Token 页中 Regenerate token），如下图所示</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414232028397.png\" alt=\"image-20220414232028397\" class=\"img_ev3q\"></p><hr><p>基本上github能实现的操作gitlab也都能实现。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他功能\">其他功能<a class=\"hash-link\" href=\"#其他功能\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"web-ide在线编辑代码\">Web IDE（在线编辑代码）<a class=\"hash-link\" href=\"#web-ide在线编辑代码\" title=\"标题的直接链接\">​</a></h3><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220415001914123.png\" alt=\"image-20220415001914123\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"运行状态\">运行状态<a class=\"hash-link\" href=\"#运行状态\" title=\"标题的直接链接\">​</a></h2><p>放几张图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414233435739.png\" alt=\"image-20220414233435739\" class=\"img_ev3q\"></p><p>输入 top 命令，按 M 按内存排序。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220414233416223.png\" alt=\"image-20220414233416223\" class=\"img_ev3q\"></p><p>还是挺吃内存的，毕竟安装的时候就要求 4g 内存以上。</p><p>有个轻量级的项目管理器 <a href=\"https://github.com/go-gitea/gitea\" target=\"_blank\" rel=\"noopener noreferrer\">gitea</a> 不妨也是一种选择，但功能上没有Gitlab这么丰富。</p><p>对于自建git服务的选择，这里有篇文章推荐阅读 <a href=\"https://zhuanlan.zhihu.com/p/486410391\" target=\"_blank\" rel=\"noopener noreferrer\">自建 Git 服务器：Gitea 与 Gitlab 部署踩坑经历与对比总结 - 知乎 (zhihu.com)</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>其实回到一开始的问题，既然Github有可能访问不了，为啥不要迁移到国内的<a href=\"https://gitee.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Gitee</a>上。</p><p><del>除了瞎玩瞎折腾外</del>，对于一些公司而言，他们不一定会使用这类开源的代码托管平台，而是自建一个像GitLab这样的代码仓库管理系统。此外别人的东西，多半都会有一定的限制，例如项目成员数量等等，所以才会有这次的尝试，整体体验感觉可玩性很大。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/gitlab-code-management-environment",
            "title": "搭建GitLab代码管理仓库",
            "summary": "image-20220414235645607",
            "date_modified": "2022-04-15T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "git",
                "gitlab"
            ]
        },
        {
            "id": "vite-vue3-build-uniapp-environment",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/uniapp.png\" alt=\"uniapp\" class=\"img_ev3q\"></p><p>最近想搞个移动端或小程序的 Vue3 项目，所以选择跨端开发平台就显得十分重要。在业内主要有两个跨端开发平台，Taro 与 uniapp，但 uniapp 貌似对 vue3 的支持不是特别友好。所以让我在 Taro 和 uniapp 之间抉择了一段时间，最终还是尝试选择相对熟悉的 uniapp 来进行开发。</p><div class=\"admonition admonition-caution alert alert--warning\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z\"></path></svg></span>前排提醒</h5></div><div class=\"admonition-content\"><p>目前 uniapp 对 Vue3 的支持还处于 alpha 版，即开发阶段，大概率是会遇到很多问题的。</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"开发环境搭建\">开发环境搭建<a class=\"hash-link\" href=\"#开发环境搭建\" title=\"标题的直接链接\">​</a></h2><p>建议安装 HBuilderX，主要是 uni cli 在 APP 平台仅支持生成离线打包的 wgt 资源包，不支持云端打包生成 apk/ipa，并且也不便配置一些打包后的参数。</p><p>这里建议安装 Alpha 版，后文会说明缘由。</p><div class=\"admonition admonition-caution alert alert--warning\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z\"></path></svg></span>注意</h5></div><div class=\"admonition-content\"><p>在 HBuilderX 正式版中是无法直接创建 Vue3 项目的，而 Alpha 版有 Vue2 和 3 可供选择，但创建的自带的模板大部分的写法还是 vue2 的写法（无 setup 语法糖），所以这时候要么改代码自建，要么使用官方所提供的 <a href=\"https://uniapp.dcloud.io/worktile/CLI.html#%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B\" target=\"_blank\" rel=\"noopener noreferrer\">Vue3 模板</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220327000608783.png\" alt=\"image-20220327000608783\" class=\"img_ev3q\"></p></div></div><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 创建以 javascript 开发的工程</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npx degit dcloudio/uni-preset-vue#vite my-vue3-project</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 创建以 typescript 开发的工程</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npx degit dcloudio/uni-preset-vue#vite-ts my-vue3-project</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>当然，有可能会下载失败，可以直接访问 <a href=\"https://gitee.com/dcloud/uni-preset-vue/repository/archive/vite-ts.zip\" target=\"_blank\" rel=\"noopener noreferrer\">gitee</a>下载模板。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目结构\">项目结构<a class=\"hash-link\" href=\"#项目结构\" title=\"标题的直接链接\">​</a></h2><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- src</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- env.d.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- main.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- manifest.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- pages.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- uni.scss</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- pages</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |   |-- index</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |       |-- index.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- static</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        |-- logo.png</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- index.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- package-lock.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- package.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- postcss.config.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- tsconfig.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- vite.config.ts</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>下载完毕，开始安装依赖，接着就可以开始测试了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"运行编译\">运行编译<a class=\"hash-link\" href=\"#运行编译\" title=\"标题的直接链接\">​</a></h2><p>在运行之前，首先将<strong>vuex</strong>包给移除，不然将会有如下提示，总之就是不推荐使用的意思，而且要使用状态管理也推荐使用 pinia。所以执行 <code>yarn remove vuex</code> 吧</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">(node:26968) [DEP0148] DeprecationWarning: Use of deprecated folder mapping \"./\" in the \"exports\" field module resolution of the package at F:\\Uniapp\\my-vue3-project1\\node_modules\\vuex\\package.json.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Update this package.json to use a subpath pattern like \"./*\".</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"h5\">H5<a class=\"hash-link\" href=\"#h5\" title=\"标题的直接链接\">​</a></h3><p>运行编译都正常</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"app\">APP<a class=\"hash-link\" href=\"#app\" title=\"标题的直接链接\">​</a></h3><p>使用<code>npm run dev:app</code>后就会发现，终端一直卡在如下界面无法继续。（后面测试发现，除了 H5 能正常运行，其他都会卡住）</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">编译器版本：3.4.3（vue3）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">请注意运行模式下，因日志输出、sourcemap 以及未压缩源码等原因，性能和包体积，均不及发行模式</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">。</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">正在编译中...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vite v2.8.6 building for development...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">DONE  Build complete. Watching for changes...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">ready in 1554ms.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后呢？？？</p><p>算了，就用 HBuilderX 的 cli 先运行到手机或模拟器，然后后打开 app 的时候提示如下错误，点击忽略后发现应用无法正常运行。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220326224649953.png\" alt=\"image-20220326224649953\" class=\"img_ev3q\"></p><p>查看了下我本地的 HBuilderX 版本是正式版 v3.3.13，而该 Vue3 的模板的 Alpha 版 v3.4.3</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220326225748608.png\" alt=\"image-20220326225748608\" class=\"img_ev3q\"></p><p>好家伙，官方提供的模板都直接使用 Alpha 版，无奈只好点击 <a href=\"https://ask.dcloud.net.cn/article/35627\" target=\"_blank\" rel=\"noopener noreferrer\">查看详情</a> 后问题解决办法。最终测试后，建议是使用最新版，即 Alpha 版本，于是替换了本地正式版的 HbuilderX，应用便能正常运行了。</p><p>既然开发环境下能正常运行，那就试下打包。由于 uniapp 打包安卓应用只能打包成 APP 资源，要打包成 apk，要么创建一个 Android Studio 工程，然后将 APP 资源放入并打包成 apk，要么使用云打包（而云打包又是只有 HBuilder 才有的功能）。如果本地没有 Android Studio 相关环境，建议还是使用云打包（简单方便），这里就不演示下打包过程了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"小程序\">小程序<a class=\"hash-link\" href=\"#小程序\" title=\"标题的直接链接\">​</a></h3><p>这里只测试了微信小程序，在上面 app 的处理完之后，微信小程序也是正常运行，不过至于与上面 Vue3 模板和 HbuilderX 正式版有无关系我就不得而知了，也懒得重装测试了。不过猜测应该与上面无关，毕竟是与手机的 SDK 有关。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"组件库\">组件库<a class=\"hash-link\" href=\"#组件库\" title=\"标题的直接链接\">​</a></h2><p>uniapp 官方中提供了一个 uni-ui 的组件库，但有一个 uniapp 相对知名的组件库 uview，并且相对前者来说更易上手实用，但当我尝试用 HBuilderX 导入时，却出现下方提示。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220327002827115.png\" alt=\"image-20220327002827115\" class=\"img_ev3q\"></p><p>很显然，uview 并不支持 vue3，但在社区中找到了份同时支持 Vue3.0 和 Vue2.0 的<a href=\"https://ext.dcloud.net.cn/plugin?name=vk-uview-ui\" target=\"_blank\" rel=\"noopener noreferrer\">uView</a>，但测试后最终已失败告终。</p><p>在社区中也搜到了 <a href=\"https://ext.dcloud.net.cn/plugin?id=556\" target=\"_blank\" rel=\"noopener noreferrer\">ThorUI 组件库</a> 但貌似需要会员收费，果断放弃且没有测试。</p><p>然后想到 Taro 中还有 nutui，于是我便开始尝试了一下，不出所料，支持 Vue3 组件库，肯定是支持的。演示如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220327005629618.png\" alt=\"image-20220327005629618\" class=\"img_ev3q\"></p><p>但很遗憾，这里的支持也只是局限于 h5 开发。官方也有声明只能开发 h5</p><blockquote><p>@nutui/nutui@next 基于 Vue3 视觉风格 JD APP 10.0 规范 ，只能开发 h5\n@nutui/nutui-taro 基于 Vue3 视觉风格 JD APP 10.0 规范 ，必须基于 taro + vue3 框架 进行开发多端（多端指一套代码 部署多端环境 微信小程序 h5、等第三方小程序）</p></blockquote><p>而且想要多端开发，也必须基于 taro + vue3 框架，所以在 uniapp 上的 app 与小程序上自然无法运行（已测试）</p><p>所以说一开始在 uniapp 和 taro 中的选择中，为啥不使用 Taro 呢？而且还支持 Vue3（相比 uniapp 而言）？</p><p>最终组件库的选择是 uniapp 官方的 uni-ui。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-vscode-开发\">使用 VSCode 开发<a class=\"hash-link\" href=\"#使用-vscode-开发\" title=\"标题的直接链接\">​</a></h2><p>HBuilder 给我代码编写体验并不友好，所以将 uniapp 的项目转 vscode 进行开发，并且使用到 npm 包。</p><p>首先创建一个 vite+vue3 项目（或者使用一开始介绍的官方提供的 Vue3 模板，主要是有 cli，需要自行在安装），然后将原 src 目录给删除，替换成 uniapp 创建的项目根目录。但还需要做以下操作</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-sass\">安装 sass<a class=\"hash-link\" href=\"#安装-sass\" title=\"标题的直接链接\">​</a></h3><p>vite 要支持 sass 只需要安装 sass 的依赖即可</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install sass</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"允许-js-文件\">允许 js 文件<a class=\"hash-link\" href=\"#允许-js-文件\" title=\"标题的直接链接\">​</a></h3><p>由于使用了 ts，如果项目中存在 js 文件，将会警告，可以在 tsconfig.json 中添加<code>\"allowJs\": true</code>即可</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"组件语法提示\">组件语法提示<a class=\"hash-link\" href=\"#组件语法提示\" title=\"标题的直接链接\">​</a></h3><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i @dcloudio/uni-helper-json @types/uni-app @types/html5plus -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但发现对于 uni-ui 组件库的代码提示并不友好，大概率是需要局部引用组件，我这里并未使用<a href=\"https://www.npmjs.com/package/@dcloudio/uni-ui\" target=\"_blank\" rel=\"noopener noreferrer\">npm 包</a>的方式导入，而是采用官方的 uni_modules，不过组件库的代码提示的问题不是很大，查阅文档即可解决。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"导入代码块\">导入代码块<a class=\"hash-link\" href=\"#导入代码块\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://github.com/zhetengbiji/uniapp-snippets-vscode\" target=\"_blank\" rel=\"noopener noreferrer\">uni-app 代码块（vscode） (github.com)</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"找不到模块appvue或其相应的类型声明\">找不到模块“./App.vue”或其相应的类型声明<a class=\"hash-link\" href=\"#找不到模块appvue或其相应的类型声明\" title=\"标题的直接链接\">​</a></h3><p>在 src 目录下创建<code>env.d.ts</code>文件，填入以下内容即可</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/// &lt;reference types=\"vite/client\" /&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">declare</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">module</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'*.vue'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> DefineComponent </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vue'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/ban-types</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> component</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> DefineComponent</span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> component</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后就是把一些<code>#ifndef VUE3</code>不是 vue3 的代码块，以及部分 js 文件改写成 ts 文件即可。这里把我修改后的模板上传到 github 上，有需要的可自行下载：<a href=\"https://github.com/kuizuo/vite-vue3-uniapp\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/vite-vue3-uniapp (github.com)</a></p><p>如果不想使用官方的 vue3 模板，这里也有篇文章介绍如何迁移</p><p><a href=\"https://zhuanlan.zhihu.com/p/268206071\" target=\"_blank\" rel=\"noopener noreferrer\">迁移 HbuilderX 的 uniapp 项目到主流的前端 IDE 开发（支持 VS Code 等编辑器/IDE）</a></p><p>不过最终如果要在 app 或小程序端运行，还是得打开 HBuilder。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>整个过程下来，其实还是 uniapp 对 Vue3 支持不够友好，加上生态没能及时更新。并且官方提供的 Vue3 模板也存在一定问题。</p><p>但最终还是使用 uniapp 来进行开发，一是对 Vue3 足够了解加上使用过 uniapp，二是 Taro 对 Vue3 是支持了，但是又该如何编译成 App 这是我主要需求的，最主要还是不想踩一遍 Taro 的坑了。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/vite-vue3-build-uniapp-environment",
            "title": "vite+vue3搭建uniapp开发环境",
            "summary": "uniapp",
            "date_modified": "2022-03-27T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "vue",
                "vite",
                "uniapp",
                "develop"
            ]
        },
        {
            "id": "remove-ts-code-type",
            "content_html": "<p>在<strong>短时间</strong>内有一个需求，原项目代码是 js，而我手里头的项目是 ts 的，需要将其合并。</p><p>按照以往，我通常会将 js 改写成 ts，但时间方面有限，<strong>只希望编译成 js 代码的时候把 ts 中的类型直接删除即可</strong>（最终目的，也就是标题所表明的意思），所以就准备深入了解 TypeScript 的编译配置，也顺带复习一下 tsconfig.json 的相关参数。</p><p><strong>毕竟会写代码，不会编译可就...</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-typescript\">安装 TypeScript<a class=\"hash-link\" href=\"#安装-typescript\" title=\"标题的直接链接\">​</a></h2><p>要编写 ts 代码，肯定要先安装其工具</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i -g typescript ts-node</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中<code>typescript</code>自带的 tsc 命令并不能直接运行 typescript 代码，而<code>ts-node</code>可以直接运行 ts 代码的能力，省去编译阶段。</p><p>但不代表<code>ts-node</code>等于 ts 版的 Node.js，本质上 Node.js 只是 JavaScript 的运行时环境，而 Deno 确实可以直接运行 TypeScript。</p><p>不过本次的主题不在 ts-node 与 deno，而在于将 TypeScript 代码编译到 JavaScript 代码。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"简单测试\">简单测试<a class=\"hash-link\" href=\"#简单测试\" title=\"标题的直接链接\">​</a></h2><p>安装完毕，编写一个<code>demo.ts</code>的文件，在里面编写如下代码</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">demo.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">a</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">number</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> b</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">number</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">number</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>使用命令 <code>tsc demo.ts</code>，将会在同级目录下生成<code>demo.js</code>，内容如下（默认是 ES5 标准）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">demo.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"tsconfigjson\">tsconfig.json<a class=\"hash-link\" href=\"#tsconfigjson\" title=\"标题的直接链接\">​</a></h2><p>可以发现上面转化的代码是 ES5 标准的，然而现在都已经步入到 ES6 阶段了，同时如果有大量 ts 文件需要编译，将十分繁琐，所以就有了 tsconfig.json 用于描述将 <strong>TypeScript</strong> 转为 <strong>JavaScript</strong> 代码的配置文件。</p><p>终端使用<code>tsc --init</code>，会在目录下生成 tsconfig.json 文件，默认配置如下（已删除原注释）。</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">tsconfig.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compilerOptions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"target\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"es5\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 编译</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"module\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"commonjs\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 模块导入与导出</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"esModuleInterop\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 支持合成模块的默认导入</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"forceConsistentCasingInFileNames\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 看不懂</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"strict\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 严格模式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"skipLibCheck\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 跳过.d.ts</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>假设我要编译 ES6 语法的，只需要将 es5 改为 es6，然后在终端输入<code>tsc</code>，生成的 js 代码就是 es6 规范的代码。</p><div class=\"admonition admonition-info alert alert--info\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>info</h5></div><div class=\"admonition-content\"><p>如果想要单纯的取出 ts 的类型，可以设置<code>\"target\": \"ESNext\"</code>，除了 ts 的一些特殊标准，如 enum，那么生成的 js 代码基本就是原 ts 代码移除类型的代码。（基本上就已经满足了我一开始的需求）</p></div></div><p>更多配置 =&gt; <a href=\"https://www.typescriptlang.org/tsconfig\" target=\"_blank\" rel=\"noopener noreferrer\">TypeScript: TSConfig Reference - Docs on every TSConfig option (typescriptlang.org)</a></p><p>更多相关 TS 编译配置和使用说明可以通过 <code>tsc -h</code> 查看。</p><p>这里有份 <a href=\"https://juejin.cn/post/7039583726375796749#heading-22\" target=\"_blank\" rel=\"noopener noreferrer\">tsconfig.json 全解析</a> 内容如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">tsconfig.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compilerOptions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 基本选项 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"target\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"es6\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定 ECMAScript 目标版本: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', or 'ESNEXT'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"module\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"commonjs\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定使用模块: 'commonjs', 'amd', 'system', 'umd' or 'es2015'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"lib\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定要包含在编译中的库文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"allowJs\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 允许编译 javascript 文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"checkJs\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 报告 javascript 文件中的错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"jsx\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"preserve\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定 jsx 代码的生成: 'preserve', 'react-native', or 'react'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"declaration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成相应的 '.d.ts' 文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"declarationDir\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./dist/types\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成的 '.d.ts' 文件保存文件夹</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"sourceMap\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成相应的 '.map' 文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"outFile\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将输出文件合并为一个文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"outDir\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./dist\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定输出目录</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"rootDir\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 用来控制输出目录结构 --outDir.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"removeComments\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 删除编译后的所有的注释</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noEmit\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 不生成输出文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"importHelpers\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 从 tslib 导入辅助工具函数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"isolatedModules\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将每个文件做为单独的模块 （与 'ts.transpileModule' 类似）.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 严格的类型检查选项 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"strict\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 启用所有严格类型检查选项</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noImplicitAny\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在表达式和声明上有隐含的 any类型时报错</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"strictNullChecks\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 启用严格的 null 检查</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noImplicitThis\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 当 this 表达式值为 any 类型的时候，生成一个错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"alwaysStrict\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 以严格模式检查每个模块，并在每个文件里加入 'use strict'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 额外的检查 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noUnusedLocals\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 有未使用的变量时，抛出错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noUnusedParameters\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 有未使用的参数时，抛出错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noImplicitReturns\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 并不是所有函数里的代码都有返回值时，抛出错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"noFallthroughCasesInSwitch\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 报告switch语句的fallthrough错误。（即，不允许switch的case语句贯穿）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 模块解析选项 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"moduleResolution\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 选择模块解析策略： 'node' (Node.js) or 'classic' (TypeScript pre-1.6)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"baseUrl\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 用于解析非相对模块名称的基础目录</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"paths\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 模块名到基于 baseUrl 的路径映射的列表</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"rootDirs\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根文件夹列表，其组合内容表示项目运行时的结构内容</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"typeRoots\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 包含类型声明的文件列表</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"types\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 需要包含的类型声明文件名列表</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"allowSyntheticDefaultImports\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 允许从没有设置默认导出的模块中默认导入。</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"esModuleInterop\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 支持合成模块的默认导入</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* Source Map Options */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"sourceRoot\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定调试器应该找到 TypeScript 文件而不是源文件的位置</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"mapRoot\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 指定调试器应该找到映射文件而不是生成文件的位置</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"inlineSourceMap\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成单个 soucemaps 文件，而不是将 sourcemaps 生成不同的文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"inlineSources\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将代码与 sourcemaps 生成到一个文件中，要求同时设置了 --inlineSourceMap 或 --sourceMap 属性</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 其他选项 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"experimentalDecorators\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 启用装饰器</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"emitDecoratorMetadata\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 为装饰器提供元数据的支持</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/* 指定编译文件或排除指定编译文件 */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"include\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"src/**/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"exclude\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"node_modules\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"**/*.spec.ts\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"files\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"index.ts\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"test.ts\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 从另一个配置文件里继承配置</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"extends\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"@tsconfig/recommended\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 让 IDE 在保存文件的时候根据 tsconfig.json 重新生成文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compileOnSave\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 支持这个特性需要Visual Studio 2015， TypeScript 1.8.4 以上并且安装 atom-typescript 插件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"常用配置\">常用配置<a class=\"hash-link\" href=\"#常用配置\" title=\"标题的直接链接\">​</a></h2><p>原本想自己总结一遍，但刷到了下面这篇文章，总结的太好了，以至于我都不是很想再写一遍主要的配置 🤩</p><p><a href=\"https://juejin.cn/post/7039583726375796749#heading-4\" target=\"_blank\" rel=\"noopener noreferrer\">会写 TypeScript 但你真的会 TS 编译配置吗？ - 掘金 (juejin.cn)</a></p><p>话虽说，但一些主要的功能还是得写一下</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置别名\">配置别名<a class=\"hash-link\" href=\"#配置别名\" title=\"标题的直接链接\">​</a></h3><p>在一些项目中经常能看到导入模块不是使用相对路径<code>./</code>，而是像<code>@/</code>，其中@表示 src，也就是项目的原代码目录下，也就是路径别名。要实现这样的配置，项目的脚手架肯定是需要修改的。这里我就以 vite 为例。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vite.config.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> defineConfig </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vite'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> resolve </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'path'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> defineConfig </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    resolve</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        alias</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"@\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">__dirname</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'src'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 路径别名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        extensions</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'.js'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'.json'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'.ts'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 使用路径别名时想要省略的后缀名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">tsconfig.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compilerOptions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"baseUrl\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\".\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 必写，用于设置解析非相对模块名称的基本目录</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"paths\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"@/*\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"src/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 用于设置模块名到基于baseUrl的路径映射</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"支持合成默认导入\">支持合成默认导入<a class=\"hash-link\" href=\"#支持合成默认导入\" title=\"标题的直接链接\">​</a></h3><p>在使用 ESM（ES module） 编写代码的时候，引入 CJS（CommonJS）的模块，通常需要写成 <code>import * as React from 'react'</code>的形式，若写成 <code>import React from 'react'</code> 将会提示 <strong>模块“\"http\"”没有默认导出</strong>。，如果将<code>esModuleInterop</code>设置为 true，同时<code>allowSyntheticDefaultImports</code> 也会自动设置为 true，则可以写成后者的形式。</p><p>这里有篇文章详细的说明缘由 <a href=\"https://zhuanlan.zhihu.com/p/148081795\" target=\"_blank\" rel=\"noopener noreferrer\">esModuleInterop 到底做了什么？</a></p><blockquote><p>所以，尽量不要用 default 导出。 ——借评论区的一条评论</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"声明浏览器全局对象-api\">声明浏览器全局对象 API<a class=\"hash-link\" href=\"#声明浏览器全局对象-api\" title=\"标题的直接链接\">​</a></h3><p>在代码中使用到浏览器的对象，如 window、document，这些对于<strong>TypeScript Complier</strong> 来说是不能识别。可以通过在 lib 字段中设置<code>\"DOM\"</code></p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compilerOptions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"target\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ES5\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"lib\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"ES5\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ES6\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"DOM\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"声明文件\">声明文件<a class=\"hash-link\" href=\"#声明文件\" title=\"标题的直接链接\">​</a></h3><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"compilerOptions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"declaration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成相应的`.d.ts`文件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"declarationDir\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"./dist/types\"</span><span class=\"token plain\"> 生成的 '.d.ts' 文件保存文件夹</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>",
            "url": "https://onewhitethreee.github.io/examenEbau/remove-ts-code-type",
            "title": "去除ts代码的类型",
            "summary": "在短时间内有一个需求，原项目代码是 js，而我手里头的项目是 ts 的，需要将其合并。",
            "date_modified": "2022-03-24T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "typescript"
            ]
        },
        {
            "id": "electron-vue3-development-environment",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220316204205165.png\" alt=\"image-20220316204205165\" class=\"img_ev3q\"></p><p>之前用 electron-vue 写过一个半成品的桌面端应用，但是是基于 Vue2 的，最近又想重写点桌面端应用，想要上 Vue3+TypeScript，于是便有了这篇文章总结下具体的搭建过程。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vue-cli\">Vue Cli<a class=\"hash-link\" href=\"#vue-cli\" title=\"标题的直接链接\">​</a></h2><p>Vue CLI 有一个插件<code>vue-cli-plugin-electron-builder</code>，可以非常方便的搭建 electron 环境。</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i @vue/cli -g</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vue create my-app</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>根据自己项目的需求选择对应的依赖（例如 Babel，TS，Vuex 等等）</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Vue CLI v5.0.3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Please pick a preset: Manually select features</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Check the features needed for your project: Babel, TS, Vuex, CSS Pre-processors, Linter</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Choose a version of Vue.js that you want to start the project with 3.x</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Use class-style component syntax? Yes</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Use Babel alongside TypeScript (required for modern mode, auto-detected polyfills, transpiling JSX)? Yes</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported by default): Sass/SCSS (with dart-sass)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Pick a linter / formatter config: Prettier</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Pick additional lint features: Lint on save</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Where do you prefer placing config for Babel, ESLint, etc.? In package.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">? Save this as a preset for future projects? No</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Vue CLI v5.0.3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">✨  Creating project in F:\\Electron\\my-app.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">🗃  Initializing git repository...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">⚙️  Installing CLI plugins. This might take a while...</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-vue-cli-plugin-electron-builder\">安装 vue-cli-plugin-electron-builder<a class=\"hash-link\" href=\"#安装-vue-cli-plugin-electron-builder\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://nklayman.github.io/vue-cli-plugin-electron-builder/\" target=\"_blank\" rel=\"noopener noreferrer\">Vue CLI Plugin Electron Builder (nklayman.github.io)</a></p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cd my-app</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vue add electron-builder</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>安装过程中会提示你选择 Electron 的版本，选择最新版本即可</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"启动项目\">启动项目<a class=\"hash-link\" href=\"#启动项目\" title=\"标题的直接链接\">​</a></h3><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run electron:serve</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>参考文章：<a href=\"https://juejin.cn/post/6983843979133468708\" target=\"_blank\" rel=\"noopener noreferrer\">Electron + Vue3 开发跨平台桌面应用【从项目搭建到打包完整过程】 - 掘金 (juejin.cn)</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"坑\">坑<a class=\"hash-link\" href=\"#坑\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">error  in ./src/background.ts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Module build failed (from ./node_modules/ts-loader/index.js):</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">TypeError: loaderContext.getOptions is not a function</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>我测试的时候，<code>@vue/cli-plugin-typescript</code>版本为<code>~5.0.0</code>，就会导致编译类型出错，将 package.json 中改为<code>\"@vue/cli-plugin-typescript\": \"~4.5.15\"</code>，即可正常运行（但还是会有 DeprecationWarning）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vite\">Vite<a class=\"hash-link\" href=\"#vite\" title=\"标题的直接链接\">​</a></h2><p>上面是使用 Vue Cli 脚手架进行开发，如果想上 Vite 的话，就需要用 Vite 来构建项目，然后安装 electron 的相关依赖。</p><p>这个不是作为重点，因为很多大佬都已经写了现成的模板，完全可以自行借鉴学习，就贴几个阅读过的几篇文章</p><p><a href=\"https://dev.to/brojenuel/vite-vue-3-electron-5h4o\" target=\"_blank\" rel=\"noopener noreferrer\">Vite + Vue 3 + electron + TypeScript - DEV Community</a></p><p><a href=\"https://zhuanlan.zhihu.com/p/424202065\" target=\"_blank\" rel=\"noopener noreferrer\">2021 年最前卫的跨平台开发选择！vue3 + vite + electron - 知乎 (zhihu.com)</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"现成的模板\">现成的模板<a class=\"hash-link\" href=\"#现成的模板\" title=\"标题的直接链接\">​</a></h3><p>均可在 github 上搜索到</p><ul><li><p><a href=\"https://github.com/caoxiemeihao/vite-react-electron\" target=\"_blank\" rel=\"noopener noreferrer\">vite-react-electron</a> (推荐)</p></li><li><p><a href=\"https://github.com/caoxiemeihao/electron-vue-vite\" target=\"_blank\" rel=\"noopener noreferrer\">electron-vue-vite</a> (推荐)</p></li><li><p><a href=\"https://github.com/cawa-93/vite-electron-builder\" target=\"_blank\" rel=\"noopener noreferrer\">vite-electron-builder</a></p></li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"electron-vite-脚手架推荐\">electron-vite 脚手架（推荐）<a class=\"hash-link\" href=\"#electron-vite-脚手架推荐\" title=\"标题的直接链接\">​</a></h3><p>当然也可以使用脚手架，可选择 React 与 Vue，实际上也就是创建上面的前两个模板</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm create electron-vite</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"现有项目使用-electron\">现有项目使用 electron<a class=\"hash-link\" href=\"#现有项目使用-electron\" title=\"标题的直接链接\">​</a></h2><p>TODO...</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>因为 Electron 本质上还是一个浏览器，无论是 Vue 还是 React 开发也好，在传统网页开发的时候都有对应的调试地址，如<a href=\"http://127.0.0.1:3000%EF%BC%8C%E8%80%8Celectron%E7%9A%84%E5%81%9A%E6%B3%95%E6%97%A0%E9%9D%9E%E5%B0%B1%E6%98%AF%E5%BC%80%E5%90%AF%E4%B8%80%E4%B8%AA%E6%B5%8F%E8%A7%88%E5%99%A8%EF%BC%8C%E7%84%B6%E5%90%8E%E5%92%8C%E6%AD%A3%E5%B8%B8%E7%9A%84%E7%BD%91%E9%A1%B5%E5%BC%80%E5%8F%91%E4%B8%80%E6%A0%B7%EF%BC%8C%E5%B9%B6%E6%8F%90%E4%BE%9B%E6%A1%8C%E9%9D%A2%E7%AB%AF%E7%9A%84api%E4%BD%BF%E7%94%A8%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:3000，而electron的做法无非就是开启一个浏览器，然后和正常的网页开发一样，并提供桌面端的api使用。</a></p><p>目前社区两大 Vue+Electron 的脚手架主要是<a href=\"https://github.com/SimulatedGREG/electron-vue\" target=\"_blank\" rel=\"noopener noreferrer\">electron-vue</a>和<a href=\"https://github.com/nklayman/vue-cli-plugin-electron-builder\" target=\"_blank\" rel=\"noopener noreferrer\">vue-cli-plugin-electron-builder</a>，更多 electron 的开源项目都遵循着前者的项目结构，像上面的模板也就是。</p><p>以上就是我所使用 Vue3 来开发 Electron 的环境搭建过程，总体来说从 Electron 除了应用体积过大，对于前端开发者来说是非常友好的，既然环境配置完，那么现在就可以开始好好的编写桌面端应用了。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/electron-vue3-development-environment",
            "title": "搭建Electron+Vue3开发环境",
            "summary": "image-20220316204205165",
            "date_modified": "2022-03-17T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "electron",
                "vue",
                "vite"
            ]
        },
        {
            "id": "sse-server-send-event",
            "content_html": "<p>先放一张 gif 图展示下效果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/sse.gif\" alt=\"sse\" class=\"img_ev3q\"></p><p>实现上面这个效果之前，先补充点前置知识</p><p>众所周知，在 HTTP 协议中，服务器无法向浏览器推送信息，可以使用 WebSocket 来实现两者双向通信。而在这里所要介绍的是 SSE（Server-Sent Events），在浏览器向服务器请求后，服务器每隔一段时间向客户端发送流数据（是单向的），来实现接收服务器的数据，例如在线视频播放，和像上面所演示的效果。</p><p><img loading=\"lazy\" src=\"https://www.ruanyifeng.com/blogimg/asset/2017/bg2017052702.jpg\" alt=\"img\" class=\"img_ev3q\"></p><p>关于 SSE 标准文档 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events\" target=\"_blank\" rel=\"noopener noreferrer\">MDN 文档</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优点\">优点<a class=\"hash-link\" href=\"#优点\" title=\"标题的直接链接\">​</a></h3><ul><li>SSE 使用 HTTP 协议，现有的服务器软件都支持。WebSocket 是一个独立协议。</li><li>SSE 属于轻量级，使用简单；WebSocket 协议相对复杂。</li><li>SSE 默认支持断线重连，WebSocket 需要自己实现。</li><li>SSE 一般只用来传送文本，二进制数据需要编码后传送，WebSocket 默认支持传送二进制数据。</li><li>SSE 支持自定义发送的消息类型。</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"服务器实现\">服务器实现<a class=\"hash-link\" href=\"#服务器实现\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据格式\">数据格式<a class=\"hash-link\" href=\"#数据格式\" title=\"标题的直接链接\">​</a></h3><p>服务器向浏览器发送的 SSE 数据，必须是 UTF-8 编码的文本，具有如下的 HTTP 头信息。</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Type: text/event-stream; charset=utf-8</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Cache-Control: no-cache</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>使用 Node 实现的代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> http </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'http'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">http</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createServer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">req</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> fileName </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'.'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">url</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">fileName </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'./stream'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">writeHead</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">'Content-Type'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text/event-stream'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">'Cache-Control'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'no-cache'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">Connection</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'keep-alive'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">'Access-Control-Allow-Origin'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'*'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">write</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'retry: 10000\\n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">write</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'event: connecttime\\n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">write</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'data: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'\\n\\n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">write</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'data: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'\\n\\n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      interval </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">setInterval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">write</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'data: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'\\n\\n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">connection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#a6e22e\">'close'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token function\" style=\"color:#e6db74\">clearInterval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">interval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">listen</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">8844</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'127.0.0.1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>通过 node server.js 运行服务端，此时浏览器访问 <a href=\"http://127.0.0.1:8844/stream\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:8844/stream</a> 得到的效果就是开头的 gif 所演示的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"客户端-api\">客户端 API<a class=\"hash-link\" href=\"#客户端-api\" title=\"标题的直接链接\">​</a></h2><p>像上面是直接向服务器请求，浏览器有<code>EventSource</code>对象，比如监听 SSE 连接，以及主动关闭 SSE 连接，具体的演示代码如下</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token doctype punctuation\" style=\"color:#f8f8f2;font-style:italic\">&lt;!</span><span class=\"token doctype doctype-tag\" style=\"color:#8292a2;font-style:italic\">DOCTYPE</span><span class=\"token doctype\" style=\"color:#8292a2;font-style:italic\"> </span><span class=\"token doctype name\" style=\"color:#8292a2;font-style:italic\">html</span><span class=\"token doctype punctuation\" style=\"color:#f8f8f2;font-style:italic\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">html</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">head</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">meta</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">charset</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">utf-8</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">meta</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">name</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">viewport</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">content</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">width=device-width</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">JS Bin</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">head</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">body</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">id</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">example</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">var</span><span class=\"token script language-javascript\"> source </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">new</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript class-name\" style=\"color:#e6db74\">EventSource</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'http://127.0.0.1:8844/stream'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">var</span><span class=\"token script language-javascript\"> div </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">getElementById</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'example'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      source</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method-variable function-variable method function property-access\" style=\"color:#e6db74\">onopen</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        div</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">innerHTML</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;p&gt;Connection open ...&lt;/p&gt;'</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      source</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method-variable function-variable method function property-access\" style=\"color:#e6db74\">onerror</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        div</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">innerHTML</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;p&gt;Connection close.&lt;/p&gt;'</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      source</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'connecttime'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">          div</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">innerHTML</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;p&gt;Start time: '</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">data</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;/p&gt;'</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript boolean\" style=\"color:#ae81ff\">false</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      source</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method-variable function-variable method function property-access\" style=\"color:#e6db74\">onmessage</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        div</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">innerHTML</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+=</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;p&gt;Ping: '</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> event</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">data</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'&lt;/p&gt;'</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">body</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">html</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>并且由于是调用浏览器 API，在开发者工具的网络面板上还能看到对应的 EventStream，像下面这样</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220316134321431.png\" alt=\"image-20220316134321431\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"参考链接\">参考链接<a class=\"hash-link\" href=\"#参考链接\" title=\"标题的直接链接\">​</a></h2><blockquote><p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Server-sent_events/Using_server-sent_events\" target=\"_blank\" rel=\"noopener noreferrer\">使用服务器发送事件 - Web API 接口参考 | MDN (mozilla.org)</a></p><p><a href=\"https://www.ruanyifeng.com/blog/2017/05/server-sent_events.html\" target=\"_blank\" rel=\"noopener noreferrer\">Server-Sent Events 教程 - 阮一峰的网络日志 (ruanyifeng.com)</a></p></blockquote>",
            "url": "https://onewhitethreee.github.io/examenEbau/sse-server-send-event",
            "title": "SSE 服务器发送事件",
            "summary": "先放一张 gif 图展示下效果",
            "date_modified": "2022-03-16T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "http"
            ]
        },
        {
            "id": "kz-online-tool",
            "content_html": "<p>之前学习的时候，都会看到网络上一些在线工具的网站，比如获取时间戳，编码转化，正则表达式等等，这些对于一些初学者在电脑上没有安装相对应的工具，往往就会百度搜索在线工具，然后就能实现自己所要完成的目的。</p><p>这些工具很是方便，或多或少都会用到。但一些在线工具并不能满足我日常开发中的个别需求，于是乎我也准备自己写一个这样的在线工具网站。不过这里肯定不会像其他网站那种搞得花里胡哨的，同时也不会去重复的造轮子，这样很没有意义。</p><p>顺便也记录下这类工具的编写以及用途</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"在线演示\">在线演示<a class=\"hash-link\" href=\"#在线演示\" title=\"标题的直接链接\">​</a></h2><p><a href=\"http://tools.kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">愧怍在线工具</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/tools.png\" alt=\"image-20220315182902482\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"技术栈\">技术栈<a class=\"hash-link\" href=\"#技术栈\" title=\"标题的直接链接\">​</a></h2><p>有一段时间没怎么写 React 了，同时对 mui 组件库感兴趣，于是这次的使用 React 和 material 设计风格的组件库来进行编写，使用到 create-react-app 脚手架进行开发，同时使用 TypeScript 进行编写。</p><p>该纯前端，无任何后端交互部分。</p><p>不做代码分析与演示，可自行在网站上测试与 clone 源码进行查看。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"功能\">功能<a class=\"hash-link\" href=\"#功能\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"查询字符串与-json-转化\">查询字符串与 json 转化<a class=\"hash-link\" href=\"#查询字符串与-json-转化\" title=\"标题的直接链接\">​</a></h3><p>如果是在协议复现的话，有些包的请求体是通过查询字符串来拼接的，也就是协议头<code>Content-Type：application/x-www-form-urlencoded</code>，请求体如 <code>username=kuizuo&amp;password=a123456</code>，一般情况下都不会采取字符串来进行替换，而是转成 json 格式，如 <code>{ \"username\":\"kuizuo\",\"password\",\"a123456\"}</code> 然后使用一些库（querystring）将 json 转成查询字符串的形式。</p><p>但是编写代码的时候，<strong>需要把抓包得到的查询字符串转成 json</strong>，而这也就是这部分的主要功能。</p><p>不过 js 本身是不支持 gbk 编码的，遇到使用 gbk 进行 url 编码的网站就需要自定义先将原文本进行 gbk 编码或解码然后才进行转化操作。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"cookie-与-json-转化\">Cookie 与 json 转化<a class=\"hash-link\" href=\"#cookie-与-json-转化\" title=\"标题的直接链接\">​</a></h3><p>和查询字符串与 json 转化功能类似，只不过是将 cookie 文本与 json 互转。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"url-utf8-与-gbk-编码\">URL UTF8 与 GBK 编码<a class=\"hash-link\" href=\"#url-utf8-与-gbk-编码\" title=\"标题的直接链接\">​</a></h3><p>有些国内网站上可能会使用 GBK 编码，但大多数语言默认都是 UTF8 编码，如果编码格式错误，后端接收到的请求必定失败。在这里我是使用到<a href=\"https://www.npmjs.com/package/gbk-nice\" target=\"_blank\" rel=\"noopener noreferrer\">gbk-nice</a>这个库，可以达到 gbk 版的<code>encodeURIComponent</code>与<code>decodeURIComponent</code>，与 js 自带的<code>encodeURIComponent</code>和<code>decodeURIComponent</code>也就是 gbk 与 utf-8 编码的区别。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"网站实现\">网站实现<a class=\"hash-link\" href=\"#网站实现\" title=\"标题的直接链接\">​</a></h2><p>上面所介绍的都是作为一个工具库的功能，我只是将其封装成一个在线工具使用，并非主要重点。而主要是对一些网站的功能实现，例如复制与下载等等。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"react-codemirror\">react-codemirror<a class=\"hash-link\" href=\"#react-codemirror\" title=\"标题的直接链接\">​</a></h3><p>在网页上展示代码，并有代码高亮的功能，首选的组件就是 codemirror 了，也是很多在线工具都使用的，我这里也不例外。</p><p><a href=\"https://uiwjs.github.io/react-codemirror/\" target=\"_blank\" rel=\"noopener noreferrer\">React CodeMirror</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"复制\">复制<a class=\"hash-link\" href=\"#复制\" title=\"标题的直接链接\">​</a></h3><p>复制的话其实是可以使用 npm 包的，但是之前在写其他项目的时候，看到封装过一个 copyToClipboard 的功能，这里也就是将其拷贝置 utils 下供外部使用。</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">interface</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Options</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  target</span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> HTMLElement</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">copyTextToClipboard</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">input</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> target </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">body </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> Options </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> element </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">createElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'textarea'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> previouslyFocusedElement </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">activeElement</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> input</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'readonly'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">style </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">contain </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'strict'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">position </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'absolute'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'-9999px'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">fontSize </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'12pt'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> selection </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getSelection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> originalRange</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">selection </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">rangeCount </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    originalRange </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getRangeAt</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  target</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">append</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">select</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selectionStart </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">selectionEnd </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> input</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">length</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> isSuccess </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    isSuccess </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">execCommand</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'copy'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">throw</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">remove</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">originalRange </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">removeAllRanges</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    selection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">addRange</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">originalRange</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">previouslyFocusedElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">previouslyFocusedElement </span><span class=\"token keyword\" style=\"color:#66d9ef\">as</span><span class=\"token plain\"> HTMLElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">focus</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> isSuccess</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>主要使用浏览器中的<code>document.execCommand('copy')</code></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"下载\">下载<a class=\"hash-link\" href=\"#下载\" title=\"标题的直接链接\">​</a></h3><p>在需要这个需求的时候，我一开始是懵的，因为之前我是没有写过原生的浏览器下载事件，都是使用外有已经封装好的的接口直接调用即可，于是这次我也是毫不意外的通过搜索引擎找到了个复制的代码</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">BlobPart</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> BufferSource </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> Blob </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">downloadByData</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> BlobPart</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> filename</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> mime</span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">string</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> bom</span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> BlobPart</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> blobData </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">typeof</span><span class=\"token plain\"> bom </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'undefined'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">bom</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> blob </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Blob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">blobData</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> mime </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'application/octet-stream'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> blobURL </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token constant\" style=\"color:#e6db74\">URL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">createObjectURL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">blob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> tempLink </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">createElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'a'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">display </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'none'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">href </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> blobURL</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'download'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> filename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">typeof</span><span class=\"token plain\"> tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">download </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'undefined'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'target'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'_blank'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">appendChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">removeChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">tempLink</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token constant\" style=\"color:#e6db74\">URL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">revokeObjectURL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">blobURL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>原理的话是创建<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Blob\" target=\"_blank\" rel=\"noopener noreferrer\">Blob</a>对象（类文件对象），将数据写入，然后创建一个 a 标签（隐藏任何样式），然后并点击创建后的 a 标签，最终移除 a 标签，已达到类似点击下载按钮来下载文件的目的。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"主题切换\">主题切换<a class=\"hash-link\" href=\"#主题切换\" title=\"标题的直接链接\">​</a></h3><p>我一开始实现这个功能是想使用自定义 hooks 的，但是在我编写的过程中，发现切换主题的组件与 codemirror 展示的组件，并不属于在一个组件内。也就是说，我如果写了个 useTheme（实际上我也真写了），我相当于在这两个组件内都使用了独立的状态，互不影响，也就是我点击了切换主题的按钮，但影响不到展示组件的代码。也算是加深了我对 hooks 的理解。</p><p>然后我就在想 Vue 的话是如何实现主题切换的，然后翻看了一些 vue 相关的代码，不出所料，使用到全局状态管理，也就是 Store。react 状态管理有 redux，还有官方提供的 useReducer，但我感觉都太繁琐了，于是我另寻其路。</p><p>我博客不是就是用 React 写的吗，我直接看源码是如何实现的，发现使用到了 React 的 useContext，也就是接下来我所要写的。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"usecontext\">useContext<a class=\"hash-link\" href=\"#usecontext\" title=\"标题的直接链接\">​</a></h4><p>首先要明确的是，theme 的状态应该是放在全局配置或者说最顶层的组件（当做父组件），然后子组件接收父组件的相关数据进行重新渲染组件。如果只是父子两层之间的关系还相对简单些，直接通过 props 传参即可，但是对于大部分组件关系，基本都是祖孙级别的关系，所以也就有了 Context。</p><p>并且 <a href=\"https://react.docschina.org/docs/context.html#reactcreatecontext\" target=\"_blank\" rel=\"noopener noreferrer\">官方文档</a> 中也是用主题切换作为 context 作为演示例子。而对于应用程序中许多组件都需要的属性，Context 无法是一个很好的选择。</p><p>首先我创建了一个 Context</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> createContext </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'react'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">ThemeContext</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token generic-function function\" style=\"color:#e6db74\">createContext</span><span class=\"token generic-function generic class-name operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token generic-function generic class-name builtin\" style=\"color:#e6db74\">any</span><span class=\"token generic-function generic class-name operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后在顶层组件中使用（Demo 仅作为演示），其中 value 需要是需要传入给子孙组件所要使用的状态或函数，比方这里 theme 和 toggleTheme。</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">ThemeContext</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'../contexts/theme-context'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">ThemeContext.Provider</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">value</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> theme</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> toggleTheme </span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">ThemeContext.Provider</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在子孙组件的话就可以使用 <code>useContext(ThemeContext)</code> 来获取父级传入的数据，在这里也就是 <code>{ theme, toggleTheme }</code></p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">ThemeContext</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'../contexts/theme-context'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">SwitchTheme</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> theme</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> toggleTheme </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">useContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token maybe-class-name\">ThemeContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接着就是切换主题的按钮点击，然后更改 theme，就会渲染对应的组件，至此切换主题的功能也就完成了</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keep-alive\">keep-alive<a class=\"hash-link\" href=\"#keep-alive\" title=\"标题的直接链接\">​</a></h2><p>在使用 mui 的 Tabs 组件库时，来回切换 Tab 会导致上一个页面的组件重新渲染，状态返回初始状态。这肯定不是我所希望的，由于我之前又有接触过 Vue，所以自然而然就联想到 keep-alive，然后我就去搜索 react 的 keep-alive 解决方案，找到了个<a href=\"https://github.com/CJY0208/react-activation\" target=\"_blank\" rel=\"noopener noreferrer\">react-activation</a>，并解决了的需求。</p><p>想做到的目的就是能把 Demo 组件缓存起来，像下面这样的写法</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">KeepAlive</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">KeepAlive</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>由于我使用的是 React17+，所以需要使用放置<code>&lt;AliveScope&gt;</code>外层，也就是上面的代码要改写成</p><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">AliveScope</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">KeepAlive</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Demo</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">KeepAlive</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">AliveScope</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过要注意: 当与<code>react-router</code>或<code>react-redux</code>一起使用时，你需要将<code>&lt;AliveScope&gt;</code>放在<code>&lt;Router&gt;</code>或<code>&lt;Provider&gt;</code>内</p><p>这些在官方文档中也有介绍，这里就不细说了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"webpack5-配置-node-相关库\">Webpack5 配置 Node 相关库<a class=\"hash-link\" href=\"#webpack5-配置-node-相关库\" title=\"标题的直接链接\">​</a></h2><p>由于使用的 create-react-app，就使用到了 Webpack5，但是 Webpack5 是不支持 Node 自带的一些库，例如我所需要使用到的 Buffer，所以就需要 npm run eject 把 webpack 配置暴露出来。</p><p>如果是要配置 Node 相关库是有一个插件 <a href=\"https://www.npmjs.com/package/node-polyfill-webpack-plugin\" target=\"_blank\" rel=\"noopener noreferrer\">NodePolyfillPlugin</a>，将会把 Node 的系统库的函数注册到 webpack 中供前端使用，相对简单，而且方便。但相对打包体积肯定有所提升，这里只是提提。</p><p>在 webpack5 官方有个测试 <a href=\"https://webpack.docschina.org/migrate/5/#test-webpack-5-compatibility\" target=\"_blank\" rel=\"noopener noreferrer\">兼容性</a> 的，就有提到 <code>Buffer: false</code></p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">node</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">Buffer</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">process</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>要解决 Buffer 也比较简单，直接通过如下代码即可</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">plugins</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">webpack</span><span class=\"token class-name punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token class-name\" style=\"color:#e6db74\">ProvidePlugin</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">Buffer</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'buffer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Buffer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>也有可能需要在 resolve 中设置下 fallback</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token literal-property property\" style=\"color:#f92672\">resolve</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">fallback</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">buffer</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'buffer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>实际编写过程其实并不轻松，但是好在很多坑与开发难点都有前人的遇到，所以搜索就已经帮我解决了很多问题。不过这期间也是不断的尝试，编译，最终实现结果是符合我一开始的期望的。</p><p>不过目前所编写的几个功能主要为我目前写协议复现所需要的，而对于大部分像时间戳，正则，加解密相关这些外面都有现成的，何必又要花费时间去造轮子呢。</p><p>后续的话应该还是会添加一些额外的功能，例如搞个代码框的配置页面，可供选择语言，代码框的高度，可视化表格的增删改。同时对代码进行一定的重构，对一些组件复用，已经完善持久化的配置。</p><p>最主要还是希望能成为我日常开发中常用的在线工具类，而不是简简单单 Demo 学习。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/kz-online-tool",
            "title": "愧怍在线工具",
            "summary": "之前学习的时候，都会看到网络上一些在线工具的网站，比如获取时间戳，编码转化，正则表达式等等，这些对于一些初学者在电脑上没有安装相对应的工具，往往就会百度搜索在线工具，然后就能实现自己所要完成的目的。",
            "date_modified": "2022-03-16T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "project",
                "react",
                "tool"
            ]
        },
        {
            "id": "http-config-client-ssl-certificate",
            "content_html": "<p>在学习安卓逆向的时候，遇到一个 APP，服务端检测请求的 SSL 证书，需要提交 SSL 证书上去才能正常发送请求。而在开启抓包和协议复现的时候，请求是能正常发出去，但是服务器会返回 400 错误。于是便有了这篇文章来记录下。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"说明\">说明<a class=\"hash-link\" href=\"#说明\" title=\"标题的直接链接\">​</a></h2><p>由于是服务端效验客户端发送的证书，所以使用代理服务器（FD，Charles 等）抓包是会替换本地证书，当服务器效验客户端发送的证书与服务器内的证书不一致，那么就直接返回 400 错误，实际上请求还是能够发送出去，只是被服务器给拒绝了。俗称<strong>双向认证</strong></p><p>所以解决办法就是在请求的时候，将正确的证书也一同发送过去，这样服务端效验时就会将正常的响应结果返回给客户端，也就是<strong>配置自定义证书</strong>。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"例子\">例子<a class=\"hash-link\" href=\"#例子\" title=\"标题的直接链接\">​</a></h3><p>APP 例子：隐约</p><p>具体如何拉取证书，就是安卓逆向相关的部分了，这里我也只提供证书文件，不提供 app。</p><p>贴上下载地址及密码</p><p>证书: <a href=\"https://img.kuizuo.cn/cert.p12\" target=\"_blank\" rel=\"noopener noreferrer\">https://img.kuizuo.cn/cert.p12</a></p><p>密码: <code>xinghekeji888.x</code></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"证书转化\">证书转化<a class=\"hash-link\" href=\"#证书转化\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://myssl.com/cert_convert.html\" target=\"_blank\" rel=\"noopener noreferrer\">证书格式转换 (myssl.com)</a></p><p><a href=\"https://www.ssleye.com/ssltool/jks_pkcs12.html\" target=\"_blank\" rel=\"noopener noreferrer\">SSL 在线工具-在线证书格式转换-证书在线合并-p12、pfx、jks 证书在线合成解析-SSLeye 官网</a></p><p>也可使用 OpenSSL 工具来进行转化证书</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"http-发送请求\">HTTP 发送请求<a class=\"hash-link\" href=\"#http-发送请求\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"node-的-axios\">node 的 axios<a class=\"hash-link\" href=\"#node-的-axios\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> axios </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'axios'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> fs </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'fs'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> https </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'https'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">axios</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">post</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">https://app.yyueapp.com/api/passLogin</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">mobile</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'15212345678'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">password</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'a123456'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">httpsAgent</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">https</span><span class=\"token class-name punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token class-name\" style=\"color:#e6db74\">Agent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">cert</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">readFileSync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'./cert.cer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">key</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">readFileSync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'./cert.key'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// pfx: fs.readFileSync('./cert.p12'),</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// passphrase: 'xinghekeji888.x,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">catch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果没有配置 httpsAgent，也就是没有配置证书，那么返回 400 错误 <code>400 No required SSL certificate was sent</code>。</p><p>配置成功将会得到正确的响应结果</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">code</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">998</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">msg</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'系统维护中...'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"python-的-requests\">python 的 requests<a class=\"hash-link\" href=\"#python-的-requests\" title=\"标题的直接链接\">​</a></h3><p>requests 不支持 p12 格式的证书，所以需要使用其他的证书格式，如下</p><div class=\"language-python codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-python codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> requests</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">r </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> requests</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">post</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'https://app.yyueapp.com/api/passLogin'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token string\" style=\"color:#a6e22e\">'mobile'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'15212345678'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'password'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'a123456'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> cert</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'./cert.cer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'./cert.key'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">print</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">r</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">status_code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">print</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">r</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>",
            "url": "https://onewhitethreee.github.io/examenEbau/http-config-client-ssl-certificate",
            "title": "HTTP请求配置客户端SSL证书",
            "summary": "在学习安卓逆向的时候，遇到一个 APP，服务端检测请求的 SSL 证书，需要提交 SSL 证书上去才能正常发送请求。而在开启抓包和协议复现的时候，请求是能正常发出去，但是服务器会返回 400 错误。于是便有了这篇文章来记录下。",
            "date_modified": "2022-02-17T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "http",
                "ssl"
            ]
        },
        {
            "id": "github-pr-experience",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"故事起因\">故事起因<a class=\"hash-link\" href=\"#故事起因\" title=\"标题的直接链接\">​</a></h2><p>博客正准备写一个项目展示的功能，其中 Docusaurus 中的<a href=\"https://docusaurus.io/zh-CN/showcase\" target=\"_blank\" rel=\"noopener noreferrer\">案例展示</a>就很适合改写成项目展示页面，然后无意间刷到我当时搭建博客所参考的博主<a href=\"https://zxuqian.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">峰华</a>的博客也在展示页面。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124214558.png\" alt=\"image-20220124214558772\" class=\"img_ev3q\"></p><p>于是脑海中就想：要不然提交一下我的博客试试看？然后便有了下文的故事</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"故事过程\">故事过程<a class=\"hash-link\" href=\"#故事过程\" title=\"标题的直接链接\">​</a></h2><p>当时具体提交的<a href=\"https://github.com/facebook/docusaurus/pull/6458\" target=\"_blank\" rel=\"noopener noreferrer\">Pull requests</a></p><p>展示页面中有个很明显的按钮 Please add your site，点击后就跳转到 Github 的编辑页面了，不过浏览器不方便操作代码，所以我就 clone 了项目，根据提示，修改了两份代码（一个是添加背景图片，一个是添加博客的 json 数据）提交了 PR（Pull requests）。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124215841.png\" alt=\"image-20220124215841410\" class=\"img_ev3q\"></p><p>一开始我是怀着尝试的态度去提交的，所以我不小心将代码格式化（也就是第 10 行 sortBy 两边的空格，原本代码风格是没有的），直到我已经提交上去的时候才发现 😂，甚至提交的时候我连 <em>description</em> 都没写（所以我当时真是怀着尝试的态度去提交的）。虽然这是我第二次提交 PR，但也告诉我以后 commit 提交，一定一定一定要比对前后代码变动的地方，不然就会像上面这样。</p><p>提交完之后，很快就有机器人给我回复</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124220731.png\" alt=\"image-20220124220731250\" class=\"img_ev3q\"></p><p>大致的意思：首先很感谢你为社区提交请求，但是呢，为了合并你的代码，我们必须要贡献者签署我们的贡献者许可协议</p><p>很显然我并没有签署过，于是它就把解决方案也告诉了我，叫我访问<a href=\"https://code.facebook.com/cla%EF%BC%8C%E5%8E%BB%E7%AD%BE%E7%BD%B2CLA%E7%AD%BE%E5%90%8D%EF%BC%88%E8%B4%A1%E7%8C%AE%E8%80%85%E8%AE%B8%E5%8F%AF%E5%8D%8F%E8%AE%AE%EF%BC%89%EF%BC%8C%E5%83%8F%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7%EF%BC%8C%E7%82%B9%E5%87%BBSubmit%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%8F%90%E4%BA%A4%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">https://code.facebook.com/cla，去签署CLA签名（贡献者许可协议），像下面这样，点击Submit就可以提交。</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124221203.png\" alt=\"image-20220124221203894\" class=\"img_ev3q\"></p><p>当时我看签署完毕后，返回 PR 页面还是提交要签署，所以我打算关掉这个 pr，准备重新提交一个新的 PR。（这种做法是真的愚蠢，尤其是在一个大型的开源项目）</p><p>就正当我关闭 pr 的时候，这时 Reviewers（审核人）给我回复了一条信息</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124221555.png\" alt=\"image-20220124221555614\" class=\"img_ev3q\"></p><blockquote><p>Hey, please don't close your PR if just because of the CLA. The bot will update your status soon after you signed it.</p></blockquote><p>意思就是：请不要在签署 CLA 签名前关闭 PR，机器人会自动在你签署后自动为你更改状态</p><p>然后我就灰溜溜的重新开放 PR，那时候感觉我是真小白，太尴尬了 😅。</p><p>然后等待了差不多有半个小时左右，机器人给了回复</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124222432.png\" alt=\"image-20220124222432479\" class=\"img_ev3q\"></p><blockquote><p>Thank you for signing our Contributor License Agreement. We can now accept your code for this (and any) Meta Open Source project. Thanks!</p></blockquote><p>意思：感谢您签署我们的贡献者许可协议。我们现在可以接受您的代码为这个(和任何)元开放源码项目。谢谢!</p><p>然后审核人为我的错误 commit 标题进行了修改<del>docs: Add Kuizuo's Personal Website to showcase page</del> docs: add Kuizuo's Personal Website to showcase，<strong>第一个单词 Add 不应该首字母大写</strong>，不符合规范。</p><p>然后为我提交的代码做了一些小调整 minor tweaks，也就是上面所提到的 sortBy 空格，然后为我提供的展示图裁剪成标准尺寸。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124222739.png\" alt=\"image-20220124222739483\" class=\"img_ev3q\"></p><p>审核人批准了我这两项修改，然后等待系统审核，具体审核的图我当时没截，现在没显示了，把已提交后的代码重新部署到 preview(预览)下，整个过程大约 5 分钟这样，接着审核人对我回复了一句 Great site, thanks! (很好的网站,谢谢)，然后这个 PR 状态就变成了 merged(合并)状态。</p><p>然后我犹豫了几分钟，不知道该怎么回复了，加上我英文表达不行，所以我原本中文是</p><p>谢谢,希望 Docusaurus 做的更好,一起努力 用软件翻译后 Thank you, Hope Docusaurus can do better. Let's go</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124222926.png\" alt=\"image-20220124222926032\" class=\"img_ev3q\"></p><p>虽然才过去两个小时，但是我现在回想起来都感觉贼丢人。</p><p>首先，我这个回复不是指定为他回复，而是相当于全体评论，贼不礼貌，然后这个蹩脚的英文翻译，我真像把 Let‘s go 改成 Let's work together，就算改了，感觉这个回复也太不礼貌了，这就已经不是英文表达能力，而是中文的表达能力了。</p><p>总之最后的结果是好的，我提交的 PR 已经成功合并到了 main 分支上，并且在下一个发布的版本中，案例展示中将会有我的博客显示在上面，现在访问<a href=\"https://deploy-preview-6458--docusaurus-2.netlify.app/showcase/?name=kuizuo\" target=\"_blank\" rel=\"noopener noreferrer\">preview 网站</a>，搜索 kuizuo 也能看到（B 格瞬间就上来了）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124223506.png\" alt=\"image-20220124223506489\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"事后思考\">事后思考<a class=\"hash-link\" href=\"#事后思考\" title=\"标题的直接链接\">​</a></h2><p>整个过程下来，审核员给我的印象太好了，我这小白式的 PR，现在回看下来都感觉太丢人了。然后我一看审核员的<a href=\"https://github.com/Josh-Cena\" target=\"_blank\" rel=\"noopener noreferrer\">Github 账号</a>，好家伙，竟然是一名在中国上海的高中生！还是团队的核心人员！太牛了！</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124225625.png\" alt=\"image-20220124225625869\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124225830.png\" alt=\"image-20220124225830338\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220124231207.png\" alt=\"image-20220124231207662\" class=\"img_ev3q\"></p><p>很难想象的到一位高中生竟能为默默的为开源项目做出贡献，而我的这次 PR 能提交成功，也与这位热心的国内学生有很大关系。（再次对我一开始报着尝试提交 PR 的态度表示抱歉）</p><p>但又回到我这边，这次提交 PR 的经过也让我学到了很多，commit 时一定要仔细对比更改前后的代码，提交的 commit 标题的规范，不必要的 closed，以及最重要的开源精神，让我看到一个实实在在开源者的样子，也是我梦寐以求的样子。</p><p>最后也祝 Docusaurus 能越做越好，也感谢这些默默为开源做出贡献的人们，正因为有你们世界才会变得更好。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/github-pr-experience",
            "title": "记一次Github提交PR过程",
            "summary": "故事起因",
            "date_modified": "2022-01-25T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "github",
                "blog"
            ]
        },
        {
            "id": "js-binary-data",
            "content_html": "<p>在我编写 js 代码中，关于处理二进制数据了解甚少，好像都是用数组表示，但是成员又很模糊。尤其是在遇到一些 http 的 post 请求或 websocket，发送二进制数据（字节）时，还有一些算法的翻译，数据的转化，协议的复现，都需要不断的从网络上查阅，并未系统的从文档教程中入手。于是写这篇的目的就是为了加固对二进制数据的理解，以及 JavaScript 中如何操作二进制数据的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"arraybuffer\">ArrayBuffer<a class=\"hash-link\" href=\"#arraybuffer\" title=\"标题的直接链接\">​</a></h2><p>其他语言 java，易所表示的是字节数组，字节集，而在 js 中则称二进制数组（都是用来表示二进制数据的），要注意的是这里的二进制数组并不是真正的数组，而是类似数组的对象。（后文会提到）</p><p>存储二进制数据用到的就是<code>ArrayBuffer</code>，但 <code>ArrayBuffer</code>不能直接读写，只能存储，需要通过视图来进行操作。</p><p>例如存储二进制数据的则是 ArrayBuffer 对象，例如请求图片时，就会指定参数 <code>responseType: 'arraybuffer'</code>表示返回二进制数据，也就是图片数据。</p><p><code>ArrayBuffer</code>也是一个构造函数，可以分配一段可以存放数据的连续内存区域。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> buffer </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ArrayBuffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">ArrayBuffer</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Uint8Contents</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">byteLength</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里的 buffer.byteLength 属性用于获取字节长度（返回 32），直接打印 buf 的结果</p><p>其中还有一个<code>slice</code>方法，允许将内存区域的一部分，拷贝生成一个新的<code>ArrayBuffer</code>对象。下面代码拷贝<code>buffer</code>对象的前 3 个字节（从 0 开始，到第 3 个字节前面结束）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> buffer </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ArrayBuffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> newBuffer </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">slice</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>除了<code>slice</code>方法，<code>ArrayBuffer</code>对象不提供任何直接读写内存的方法，只允许在其上方建立视图，然后通过视图读写。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"typedarray\">TypedArray<a class=\"hash-link\" href=\"#typedarray\" title=\"标题的直接链接\">​</a></h2><p>不过只有空数据可没用，肯定需要操作<code>ArrayBuffer</code>，也就要介绍下<code>TypedArray</code>。</p><p><code>ArrayBuffer</code>对象作为内存区域，可以存放多种类型的数据。同一段内存，不同数据有不同的解读方式，这就叫做“视图”（view），<code>ArrayBuffer</code>有两种视图，一种是<code>TypedArray</code>视图，另一种是<code>DataView</code>视图。这里只介绍<code>TypedArray</code></p><p><code>TypedArray</code>视图一共包括 9 种类型，每一种视图都是一种构造函数通过 9 个构造函数，可以生成 9 种数据格式的视图，比如<code>Uint8Array</code>（无符号 8 位整数，表示一个字节）数组视图，具体如下</p><table><thead><tr><th align=\"left\">数据类型</th><th align=\"left\">字节长度</th><th align=\"left\">含义</th><th align=\"left\">对应的 C 语言类型</th></tr></thead><tbody><tr><td align=\"left\">Int8</td><td align=\"left\">1</td><td align=\"left\">8 位带符号整数</td><td align=\"left\">signed char</td></tr><tr><td align=\"left\">Uint8</td><td align=\"left\">1</td><td align=\"left\">8 位不带符号整数</td><td align=\"left\">unsigned char</td></tr><tr><td align=\"left\">Uint8C</td><td align=\"left\">1</td><td align=\"left\">8 位不带符号整数（自动过滤溢出）</td><td align=\"left\">unsigned char</td></tr><tr><td align=\"left\">Int16</td><td align=\"left\">2</td><td align=\"left\">16 位带符号整数</td><td align=\"left\">short</td></tr><tr><td align=\"left\">Uint16</td><td align=\"left\">2</td><td align=\"left\">16 位不带符号整数</td><td align=\"left\">unsigned short</td></tr><tr><td align=\"left\">Int32</td><td align=\"left\">4</td><td align=\"left\">32 位带符号整数</td><td align=\"left\">int</td></tr><tr><td align=\"left\">Uint32</td><td align=\"left\">4</td><td align=\"left\">32 位不带符号的整数</td><td align=\"left\">unsigned int</td></tr><tr><td align=\"left\">Float32</td><td align=\"left\">4</td><td align=\"left\">32 位浮点数</td><td align=\"left\">float</td></tr><tr><td align=\"left\">Float64</td><td align=\"left\">8</td><td align=\"left\">64 位浮点数</td><td align=\"left\">double</td></tr></tbody></table><p>视图的构造函数可以接受三个参数：</p><ul><li>第一个参数（必需）：视图对应的底层<code>ArrayBuffer</code>对象。</li><li>第二个参数（可选）：视图开始的字节序号，默认从 0 开始。</li><li>第三个参数（可选）：视图包含的数据个数，默认直到本段内存区域结束。</li></ul><p>演示</p><p>不妨给它写入字符串 abc，对应的十进制 ASCII 码为 97,98,99，由于 ASCII 码占用一个字节存储，所以这里选择 Uint8Array 用于表示</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> buffer </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ArrayBuffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> buf </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Uint8Array</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">97</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">98</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">99</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出结果</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">ArrayBuffer</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Uint8Contents</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token number\" style=\"color:#ae81ff\">61</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">62</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">63</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">00</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">byteLength</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以看到 abc 确实存入了，并用十六进制的形式表示，为了验证，这里使用 NodeJS 中的 Buffer 来演示，当然也可以使用原生的<a href=\"https://es6.ruanyifeng.com/#docs/arraybuffer#ArrayBuffer-%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E4%BA%92%E7%9B%B8%E8%BD%AC%E6%8D%A2\" target=\"_blank\" rel=\"noopener noreferrer\">TextEncoder</a></p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// abc</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>你也可以直接通过数组下标的形式，来访问数据，如<code>buf[0]</code>返回的就是 97，但 buf 又有 length 与其他的属性方法，这种数组就统称为类数组。</p><p>buf 还有一些方法，无非就是操作字节复制，偏移就不做过多介绍与演示了，具体可查看<a href=\"https://es6.ruanyifeng.com/#docs/arraybuffer\" target=\"_blank\" rel=\"noopener noreferrer\">文档</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nodejs-的-buffer\">NodeJS 的 Buffer<a class=\"hash-link\" href=\"#nodejs-的-buffer\" title=\"标题的直接链接\">​</a></h2><p><a href=\"http://nodejs.cn/api/buffer.html#buffer_buffers_and_character_encodings\" target=\"_blank\" rel=\"noopener noreferrer\">buffer 缓冲区 | Node.js API 文档 (nodejs.cn)</a></p><p>在 Nodejs 中有专门的操作<code>ArrayBuffer</code> 的对象<code>Buffer</code>，<code>Buffer</code> 类是 JavaScript <a href=\"http://url.nodejs.cn/ZbDkpm\" target=\"_blank\" rel=\"noopener noreferrer\"><code>Uint8Array</code></a> 类的子类</p><p>所以<code>Uint8Array</code>有的属性方法 Buffer 也有，不过 Nodejs 对 Buffer 增加了额外的方法供开发者调用。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"bufferfrom\"><a href=\"http://nodejs.cn/api/buffer.html#static-method-bufferfromarray\" target=\"_blank\" rel=\"noopener noreferrer\">Buffer.from</a><a class=\"hash-link\" href=\"#bufferfrom\" title=\"标题的直接链接\">​</a></h3><p>上面的代码 <code>Buffer.from(buf.buffer).toString()</code>，也就是将<code>ArrayBuffer</code> 数据转为 utf8 编码文本。其中 toString 还能转为以下编码（toString 默认 utf8）</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">BufferEncoding</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ascii'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'utf8'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'utf-8'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'utf16le'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ucs2'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ucs-2'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'base64url'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'latin1'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'binary'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'hex'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过 Nodejs 不支持 gbk 编码，所以需要使用第三方包，如 iconv-lite</p><p><code>Buffer.from()</code>有多个方法实现，第一个参数可以传入 ArrayBuffer | Uint8Array | string，如果是 string 类型，第二个参数为编码格式，例如实现编码转化</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// base64</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将str转base64编码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将base64编码转str</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// hex</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'hex'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将str转hex编码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'hex'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将hex编码转str</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>封装 Base64 编码与解码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Base64</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function-variable function\" style=\"color:#e6db74\">encode</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function-variable function\" style=\"color:#e6db74\">decode</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"buftojson\"><a href=\"http://nodejs.cn/api/buffer.html#buftojson\" target=\"_blank\" rel=\"noopener noreferrer\">buf.toJSON()</a><a class=\"hash-link\" href=\"#buftojson\" title=\"标题的直接链接\">​</a></h3><p>将会得到 buf 的视图类型，与二进制数组。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// let buf = Buffer.from('abc');</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> buf </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">97</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">98</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">99</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// &lt;Buffer 61 62 63&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toJSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// { type: 'Buffer', data: [ 97, 98, 99 ] }</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 效果等同于 JSON.stringify(buf);</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">buf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">values</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// [ 97, 98, 99 ]   可以直接得到二进制数据</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>官方文档: <a href=\"http://nodejs.cn/api/buffer.html#buffer\" target=\"_blank\" rel=\"noopener noreferrer\">buffer 缓冲区 | Node.js API 文档 (nodejs.cn)</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"arraybuffer-和-buffer-区别\">ArrayBuffer 和 Buffer 区别<a class=\"hash-link\" href=\"#arraybuffer-和-buffer-区别\" title=\"标题的直接链接\">​</a></h2><p>上述对这两者进行了介绍，这里总结一下</p><p><code>ArrayBuffer</code> 对象用来表示通用的、固定长度的原始二进制数据缓冲区，是一个字节数组，可读但不可直接写。</p><p><code>Buffer</code> 是 Node.JS 中用于操作 <code>ArrayBuffer</code> 的视图，继承自<code>Uint8Array</code>，是 <code>TypedArray</code> 的一种。</p><p>通俗点来说（<strong>对我而言</strong>），<code>ArrayBuffer</code>相当于其他语言的字节数组、字节集，但不可写，而<code>Buffer</code> 对象则是操作<code>ArrayBuffer</code>的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"应用\">应用<a class=\"hash-link\" href=\"#应用\" title=\"标题的直接链接\">​</a></h2><p>与二进制数据有关的地方就有应用</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"编码转化\">编码转化<a class=\"hash-link\" href=\"#编码转化\" title=\"标题的直接链接\">​</a></h3><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"将请求图片转化成-base64-编码\">将请求图片转化成 base64 编码<a class=\"hash-link\" href=\"#将请求图片转化成-base64-编码\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">axios</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'图片url地址'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">responseType</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'arraybuffer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> base64Img </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'base64'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">base64Img</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 axios 请求图片数据的时候，指定<code>responseType: 'arraybuffer'</code>，返回的 data 就是一个 buffer 对象。（当时写成这样的代码 <code>Buffer.from(res.data).buffer</code>，不过不妨碍）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"http-发送二进制数据与-websocket\">http 发送二进制数据与 WebSocket<a class=\"hash-link\" href=\"#http-发送二进制数据与-websocket\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">post</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'http://example.com'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'abc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> socket </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'ws://127.0.0.1:8081'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">binaryType</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'arraybuffer'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Wait until socket is open</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'open'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Send binary data</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> typedArray </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Uint8Array</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">typedArray</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">buffer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Receive binary data</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> arrayBuffer </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ···</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"文件读写\">文件读写<a class=\"hash-link\" href=\"#文件读写\" title=\"标题的直接链接\">​</a></h3><p>等等。。。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"参考\">参考<a class=\"hash-link\" href=\"#参考\" title=\"标题的直接链接\">​</a></h2><blockquote><p><a href=\"https://es6.ruanyifeng.com/#docs/arraybuffer\" target=\"_blank\" rel=\"noopener noreferrer\">ArrayBuffer - ECMAScript 6 入门 (ruanyifeng.com)</a></p><p><a href=\"https://www.zhihu.com/question/26246195/answer/1231680251#ref_1\" target=\"_blank\" rel=\"noopener noreferrer\">ArrayBuffer 和 Buffer 有何区别？ - 知乎 (zhihu.com)</a></p></blockquote>",
            "url": "https://onewhitethreee.github.io/examenEbau/js-binary-data",
            "title": "JavaScript中的二进制数据",
            "summary": "在我编写 js 代码中，关于处理二进制数据了解甚少，好像都是用数组表示，但是成员又很模糊。尤其是在遇到一些 http 的 post 请求或 websocket，发送二进制数据（字节）时，还有一些算法的翻译，数据的转化，协议的复现，都需要不断的从网络上查阅，并未系统的从文档教程中入手。于是写这篇的目的就是为了加固对二进制数据的理解，以及 JavaScript 中如何操作二进制数据的。",
            "date_modified": "2022-01-24T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript"
            ]
        },
        {
            "id": "docusaurus-gitalk-plugin",
            "content_html": "<p>之前使用 vuepress 的时候，使用的评论系统是<a href=\"https://valine.js.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Valine</a>，可是匿名用户也能直接评论，虽说会过滤垃圾信息，但是后台查看评论与通知总感觉没有那么实在。</p><p>然后换到了 docusaurus，并没有内置评论相关的，原本是打算自己写一个评论系统，MongoDB 存储评论数据相对方便些。然后这一拖就是拖到了过年前。。。无意间发现有一个插件<a href=\"https://gitalk.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Gitalk</a>，基于 Github Issue 的，而我平常又经常刷 github，加上需要 github 账号才能评论，所以就使用<a href=\"https://gitalk.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Gitalk</a> 来作为博客的评论（注：Gitalk 是基于 react 编写的）。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"操作步骤\">操作步骤<a class=\"hash-link\" href=\"#操作步骤\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"1创建评论仓库\">1、创建评论仓库<a class=\"hash-link\" href=\"#1创建评论仓库\" title=\"标题的直接链接\">​</a></h3><p>首先需要 github 账号，创建一个仓库用于存放评论，由于我的博客是同步上传到<a href=\"https://github.com/kuizuo/blog\" target=\"_blank\" rel=\"noopener noreferrer\">github</a>上，所以就无需新建仓库</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"2开启-issues-功能\">2、开启 issues 功能<a class=\"hash-link\" href=\"#2开启-issues-功能\" title=\"标题的直接链接\">​</a></h3><p>默认开启，可在 Settings -&gt; Features -&gt; Issues 中设置</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220122141447.png\" alt=\"image-20220122141447919\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"3注册一个-github-applications\">3、注册一个 Github applications<a class=\"hash-link\" href=\"#3注册一个-github-applications\" title=\"标题的直接链接\">​</a></h3><p>点击<a href=\"https://github.com/settings/developers\" target=\"_blank\" rel=\"noopener noreferrer\">此处</a>创建或在 github 右上角路径 settings -&gt; Developer settings -&gt; OAuth Apps</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220121225106.png\" alt=\"image-20220121225059192\" class=\"img_ev3q\"></p><ul><li>Homepage URL：就是博客的网址（如果是 github.io 的 page）</li><li>Authorization callback URL: 就是 github 权限验证的回调地址，一般默认就是域名</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"4获取-client-id-和-client-secret\">4、获取 Client ID 和 Client Secret<a class=\"hash-link\" href=\"#4获取-client-id-和-client-secret\" title=\"标题的直接链接\">​</a></h3><p>创建成功后，就可以获取到 Client ID 和 Client Secret 了，保存下来。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220122130222.png\" alt=\"image-20220122130221871\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"5安装\">5、安装<a class=\"hash-link\" href=\"#5安装\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://github.com/gitalk/gitalk/blob/master/readme-cn.md#%E5%AE%89%E8%A3%85\" target=\"_blank\" rel=\"noopener noreferrer\">官方教程</a></p><ul><li>直接引入</li></ul><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">link</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">rel</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">stylesheet</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">href</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!-- or --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">link</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">rel</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">stylesheet</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">href</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://unpkg.com/gitalk/dist/gitalk.css</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://unpkg.com/gitalk/dist/gitalk.min.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>npm 安装</li></ul><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i --save gitalk</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'gitalk/dist/gitalk.css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">Gitalk</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'gitalk'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"6使用\">6、使用<a class=\"hash-link\" href=\"#6使用\" title=\"标题的直接链接\">​</a></h3><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">id</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">gitalk-container</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>用下面的 Javascript 代码来生成 gitalk 插件：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> gitalk </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Gitalk</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">clientID</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub Application Client ID'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">clientSecret</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub Application Client Secret'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">repo</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub repo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">owner</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub repo owner'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">admin</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub repo owner and collaborators, only these guys can initialize github issues'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">location</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">pathname</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Ensure uniqueness and length less than 50</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">distractionFreeMode</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Facebook-like distraction free mode</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">gitalk</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">render</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'gitalk-container'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"react-中使用\">react 中使用<a class=\"hash-link\" href=\"#react-中使用\" title=\"标题的直接链接\">​</a></h5><p>导入 Gitalk 组件与样式</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'gitalk/dist/gitalk.css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">GitalkComponent</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'gitalk/dist/gitalk-component'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>使用组件与配置参数</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">GitalkComponent</span><span class=\"token tag\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag\" style=\"color:#f92672\">  </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">options</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag script language-javascript\" style=\"color:#f92672\">    </span><span class=\"token tag script language-javascript literal-property property\" style=\"color:#f92672\">clientID</span><span class=\"token tag script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript string\" style=\"color:#a6e22e\">'...'</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag script language-javascript\" style=\"color:#f92672\">    </span><span class=\"token tag script language-javascript comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag script language-javascript\" style=\"color:#f92672\">    </span><span class=\"token tag script language-javascript comment\" style=\"color:#8292a2;font-style:italic\">// options below</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag script language-javascript\" style=\"color:#f92672\">  </span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag\" style=\"color:#f92672\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag\" style=\"color:#f92672\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>我的配置</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> options </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">clientID</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub Application Client ID'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">clientSecret</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'GitHub Application Client Secret'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">repo</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'blog'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">owner</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">admin</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">title</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">labels</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> labels</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">distractionFreeMode</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>具体参数<a href=\"https://github.com/gitalk/gitalk/blob/master/readme-cn.md#%E8%AE%BE%E7%BD%AE\" target=\"_blank\" rel=\"noopener noreferrer\">gitalk</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"问题\">问题<a class=\"hash-link\" href=\"#问题\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"error-not-found\">Error: Not Found<a class=\"hash-link\" href=\"#error-not-found\" title=\"标题的直接链接\">​</a></h3><p>options 有个选项 repo，填写的是仓库名称，不是链接，像上面我所填写的就是<code>blog</code>，而不是填写<a href=\"https://github.com/kuizuo/blog\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/kuizuo/blog</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"未找到相关的-issues-进行评论请联系-xxxxx-初始化创建\">未找到相关的 <a href=\"https://github.com/kuizuo/blog/issues\" target=\"_blank\" rel=\"noopener noreferrer\">Issues</a> 进行评论，请联系 @xxxxx 初始化创建<a class=\"hash-link\" href=\"#未找到相关的-issues-进行评论请联系-xxxxx-初始化创建\" title=\"标题的直接链接\">​</a></h3><p>这里的 xxxxx 就是选项 admin 的内容，首次载入文章的话需要用管理员账号登录初始化一下（也就是新建一个 issues），否则其他人访问也将会提示该信息。</p><p>目前暂时没找到有效办法一键加载所有博客的 issues，只要用登录 github 的管理员账号去访问每一篇博客。</p><p>其中在<a href=\"#3%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA-github-applications\">第 3 步</a>的 Authorization callback URL 地址一定要填写成现在博客线上环境 <a href=\"https://kuizuo.cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://kuizuo.cn</a> ，否则也无法正常使用</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"validation-failed\">Validation failed<a class=\"hash-link\" href=\"#validation-failed\" title=\"标题的直接链接\">​</a></h3><p>原因是 id 参数不能超过 50 个字符，但是默认是 location.href，有可能会导致长度超过。所以我的做法是 id: title，同时访问页面的时候，会自动为仓库创建一个 issue，标题为文章的标题。</p><p>也有可能是请求过于频繁，触发了 Github 的限流机制，需要等待几分钟后恢复。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"react-编译遇到的问题\">react 编译遇到的问题<a class=\"hash-link\" href=\"#react-编译遇到的问题\" title=\"标题的直接链接\">​</a></h3><p>插件中会使用到浏览器的 window 对象，开发时正常，但是编译就会报错（提示 window is not defined），这边引用了 docusaurus 的<a href=\"https://docusaurus.io/zh-CN/docs/docusaurus-core#browseronly\" target=\"_blank\" rel=\"noopener noreferrer\">BrowserOnly</a>，将代码封装成如下便可正常编译</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">BrowserOnly</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">fallback</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag script language-javascript tag\" style=\"color:#f92672\">div</span><span class=\"token tag script language-javascript tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag script language-javascript tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag script language-javascript tag\" style=\"color:#f92672\">div</span><span class=\"token tag script language-javascript tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">GitalkComponent</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">options</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\">options</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">BrowserOnly</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><a href=\"https://github.com/kuizuo/blog/blob/main/src/theme/BlogPostPage/index.jsx\" target=\"_blank\" rel=\"noopener noreferrer\">查看完整源码点我</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"github-api\">Github Api<a class=\"hash-link\" href=\"#github-api\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://docs.github.com/cn\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub Documentation</a></p><p>通过 github api 还可以获取 issues 列表</p><p>访问 <a href=\"https://api.github.com/repos/kuizuo/blog/issues%EF%BC%8C%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B\" target=\"_blank\" rel=\"noopener noreferrer\">https://api.github.com/repos/kuizuo/blog/issues，返回结果如下</a></p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"repository_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"labels_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24/labels{/name}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"comments_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24/comments\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"events_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24/events\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"html_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://github.com/kuizuo/blog/issues/24\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1111300101</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"node_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"I_kwDOF7NJDM5CPRgF\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"number\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">24</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Docusaurus配置Gitalk评论插件\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"user\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"login\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">61005888</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"node_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"MDQ6VXNlcjYxMDA1ODg4\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"avatar_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://avatars.githubusercontent.com/u/61005888?v=4\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"gravatar_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"html_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://github.com/kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"followers_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/followers\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"following_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/following{/other_user}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"gists_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/gists{/gist_id}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"starred_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/starred{/owner}{/repo}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"subscriptions_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/subscriptions\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"organizations_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/orgs\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"repos_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/repos\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"events_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/events{/privacy}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"received_events_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/users/kuizuo/received_events\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"User\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"site_admin\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"labels\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3754161267</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"node_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"LA_kwDOF7NJDM7fw_Rz\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/labels/Gitalk\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Gitalk\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"color\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ededed\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"default\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3754411279</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"node_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"LA_kwDOF7NJDM7fx8UP\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/labels/blog\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"blog\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"color\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ededed\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"default\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3754517867</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"node_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"LA_kwDOF7NJDM7fyWVr\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/labels/Docusaurus%E9%85%8D%E7%BD%AEGitalk%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Docusaurus配置Gitalk评论插件\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"color\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ededed\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"default\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"state\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"open\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"locked\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"assignee\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"assignees\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"milestone\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"comments\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"created_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2022-01-22T06:47:34Z\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"updated_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2022-01-22T06:47:34Z\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"closed_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"author_association\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"OWNER\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"active_lock_reason\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"body\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://kuizuo.cn/develop/Docusaurus配置Gitalk评论插件\\n前言\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"reactions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24/reactions\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"total_count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"+1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"-1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"laugh\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"hooray\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"confused\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"heart\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"rocket\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"eyes\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"timeline_url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://api.github.com/repos/kuizuo/blog/issues/24/timeline\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"performed_via_github_app\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>相关 api 文档 =&gt; <a href=\"https://docs.github.com/cn/rest/reference/issues#comments\" target=\"_blank\" rel=\"noopener noreferrer\">github docs</a></p><p>也许后续可能考虑使用<a href=\"https://github.com/octokit/octokit.js\" target=\"_blank\" rel=\"noopener noreferrer\">octokit.js</a>来编写一个后台查询与删除的管理页。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最终效果\">最终效果<a class=\"hash-link\" href=\"#最终效果\" title=\"标题的直接链接\">​</a></h2><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"评论页\">评论页<a class=\"hash-link\" href=\"#评论页\" title=\"标题的直接链接\">​</a></h4><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220122164034.png\" alt=\"image-20220122164034147\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"issues-页面\">issues 页面<a class=\"hash-link\" href=\"#issues-页面\" title=\"标题的直接链接\">​</a></h4><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220122163957.png\" alt=\"image-20220122163957435\" class=\"img_ev3q\"></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/docusaurus-gitalk-plugin",
            "title": "Docusaurus配置Gitalk评论插件",
            "summary": "之前使用 vuepress 的时候，使用的评论系统是Valine，可是匿名用户也能直接评论，虽说会过滤垃圾信息，但是后台查看评论与通知总感觉没有那么实在。",
            "date_modified": "2022-01-22T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "blog",
                "gitalk"
            ]
        },
        {
            "id": "react-css",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"全局样式\">全局样式<a class=\"hash-link\" href=\"#全局样式\" title=\"标题的直接链接\">​</a></h2><p>与传统 html 标签类属性不同，react 中 class 必须编写为 className，比如</p><p>全局 css</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">box</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  background</span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\">color</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\">red</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">width</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\">300px</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">height</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\">300px</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>js</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Hello</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">box</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">hello react</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">ReactDOM</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">render</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Hello</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getElementById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'root'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>与传统在 html 标签定义 css 样式不同，因为这不是传统的 html 代码，而是 JSX，由于 class 作为关键字，无法作为标识符出现，比方说下面的代码将会报错。</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'foo'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Uncaught SyntaxError: Unexpected token }</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> className </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">className</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'foo'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> className </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'foo'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>关于官方也有对此问题回答</p><p><a href=\"https://www.jackpu.com/you-qu-de-hua-ti-wei-shi-yao-jsxyong-classnameer-bu-shi-class/\" target=\"_blank\" rel=\"noopener noreferrer\">有趣的话题，为什么 jsx 用 className 而不是 class</a></p><p>所以把传统的 html 代码强行搬运到 react 中，如果带有 class 与 style 属性，那么将会报错。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"内联样式\">内联样式<a class=\"hash-link\" href=\"#内联样式\" title=\"标题的直接链接\">​</a></h2><p>内联样式也得写成对象 key-value 形式，遇到-连字符，则需要大写，如</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Hello</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">box</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">style</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript literal-property property\" style=\"color:#f92672\">fontSize</span><span class=\"token tag script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript string\" style=\"color:#a6e22e\">'32px'</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript literal-property property\" style=\"color:#f92672\">textAlign</span><span class=\"token tag script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript string\" style=\"color:#a6e22e\">'center'</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> </span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      hello react</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>CSS 的<code>font-size</code>属性要写成<code>fontSize</code>，这是 JavaScript 操作 CSS 属性的<a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Properties_Reference\" target=\"_blank\" rel=\"noopener noreferrer\">约定</a>。</p><p>其实{ } 可传入表达式，比方这里传入的就是<code>{ fontSize: \"32px\",textAlign: \"center\" }</code> 对象，也可以将其定义为一个变量传入。</p><p>但是写内联样式显得组丑陋影响阅读，并且样式不易于复用，同时伪元素与媒体查询无法实现，但是封装成类样式，又会影响到全局作用域，所以便有了局部样式<code>styles.module.css</code> 。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"局部样式-css-modules\">局部样式 CSS Modules<a class=\"hash-link\" href=\"#局部样式-css-modules\" title=\"标题的直接链接\">​</a></h2><p>Css Modules 并不是 React 专用解决方法，适用于所有使用 webpack 等打包工具的开发环境。以 webpack 为例，在 css-loader 的 options 里打开<code>modules：true</code> 选项即可使用 Css Modules。一般配置如下</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">loader</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"css-loader\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">options</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">importLoaders</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">modules</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">localIdentName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"[name]__[local]___[hash:base64:5]\"</span><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 为了生成类名不是纯随机</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后通过 import 引入</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">styles</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'./styles.module.css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Hello</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\">styles</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token tag script language-javascript property-access\" style=\"color:#f92672\">box</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">hello react</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但如果是有多个局部样式，直接拼接是无效的（毕竟是个无效的表达式）</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 错误</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">div className</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class1</span><span class=\"token plain\"> style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 正确</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">div className</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">style</span><span class=\"token template-string interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string interpolation property-access\">class1</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\"> </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">style</span><span class=\"token template-string interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string interpolation property-access\">class2</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">div className</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class1</span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\" \"</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">div className</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">class2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">join</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\" \"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"classnames\">classnames<a class=\"hash-link\" href=\"#classnames\" title=\"标题的直接链接\">​</a></h3><p>还可以通过 npm 包 classnames 来定义类名，如</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">classnames</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'classnames'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">styles</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'./styles.module.css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag script language-javascript script-punctuation punctuation\" style=\"color:#f8f8f2\">=</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token tag script language-javascript function\" style=\"color:#e6db74\">classnames</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\">styles</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token tag script language-javascript property-access\" style=\"color:#f92672\">class1</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token tag script language-javascript\" style=\"color:#f92672\"> styles</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token tag script language-javascript property-access\" style=\"color:#f92672\">class2</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token tag script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最终都将编译为</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">class1 class2</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>当然 classnames 还有多种方式添加，就不列举了，主要针对复杂样式，根据条件是否添加样式。</p><p>但是 在 Css Module 中，其实能发现挺多问题的</p><p>如果类名是带有-连字符<code>.table-size</code>那么就只能<code>styles[\"table-size\"]</code> 来引用，并且都必须使用<code>{style.className}</code> 形式。</p><p>最主要的是，css 都写在 css 文件中，无法处理动态 css。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"css-in-js\">CSS in JS<a class=\"hash-link\" href=\"#css-in-js\" title=\"标题的直接链接\">​</a></h2><p>由于 React 对 CSS 的封装非常弱，导致了一系列的第三方库，用来加强 CSS 操作，统称为 CSS in JS（），有一种在 js 文件中写 css 代码的感觉，根据不完全统计，各种 CSS in JS 的库至少有<a href=\"https://github.com/MicheleBertoli/css-in-js\" target=\"_blank\" rel=\"noopener noreferrer\">47 种</a>，其中比较出名的 便是<a href=\"https://link.juejin.cn/?target=https://github.com/styled-components/styled-components\" target=\"_blank\" rel=\"noopener noreferrer\">styled-components</a>。</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">styled</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'styled-components'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// `` 和 () 一样可以作为js里作为函数接受参数的标志，这个做法类似于HOC，包裹一层css到h1上生成新组件Title</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Title</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> styled</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">h1</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">font-size</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">1.5</span><span class=\"token template-string css language-css unit\">em</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">text-align</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> center</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">color</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css color\">palevioletred</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css selector\" style=\"color:#a6e22e;font-style:italic\">span</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">    </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">font-size</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">2</span><span class=\"token template-string css language-css unit\">em</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\"></span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在充分使用css全部功能的同时，非常方便的实现动态css， 甚至可以直接调用props！</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Wrapper</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> styled</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">section</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">padding</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">4</span><span class=\"token template-string css language-css unit\">em</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">background</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string css language-css interpolation parameter\">props</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token template-string css language-css interpolation\"> </span><span class=\"token template-string css language-css interpolation arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token template-string css language-css interpolation\"> props</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string css language-css interpolation property-access\">bgColor</span><span class=\"token template-string css language-css interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\"></span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Button</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> styled</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">a</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css comment\" style=\"color:#8292a2;font-style:italic\">/* This renders the buttons above... Edit me! */</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">display</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> inline-block</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">border-radius</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">3</span><span class=\"token template-string css language-css unit\">px</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">padding</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">0.5</span><span class=\"token template-string css language-css unit\">rem</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">0</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">margin</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">0.5</span><span class=\"token template-string css language-css unit\">rem</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">1</span><span class=\"token template-string css language-css unit\">rem</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">width</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">11</span><span class=\"token template-string css language-css unit\">rem</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">background</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css color\">transparent</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">color</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css color\">white</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">border</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css number\" style=\"color:#ae81ff\">2</span><span class=\"token template-string css language-css unit\">px</span><span class=\"token template-string css language-css\"> solid </span><span class=\"token template-string css language-css color\">white</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css comment\" style=\"color:#8292a2;font-style:italic\">/* The GitHub button is a primary button</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css comment\" style=\"color:#8292a2;font-style:italic\">   * edit this to target it specifically! */</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string css language-css interpolation parameter\">props</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token template-string css language-css interpolation\"> </span><span class=\"token template-string css language-css interpolation arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token template-string css language-css interpolation\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css interpolation\">    props</span><span class=\"token template-string css language-css interpolation punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token template-string css language-css interpolation property-access\">primary</span><span class=\"token template-string css language-css interpolation\"> </span><span class=\"token template-string css language-css interpolation operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token template-string css language-css interpolation\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css interpolation\">    css</span><span class=\"token template-string css language-css interpolation template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css interpolation template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css interpolation template-string css language-css\">      </span><span class=\"token template-string css language-css interpolation template-string css language-css property\" style=\"color:#f92672\">background</span><span class=\"token template-string css language-css interpolation template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css interpolation template-string css language-css\"> </span><span class=\"token template-string css language-css interpolation template-string css language-css color\">white</span><span class=\"token template-string css language-css interpolation template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css interpolation template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css interpolation template-string css language-css\">      </span><span class=\"token template-string css language-css interpolation template-string css language-css property\" style=\"color:#f92672\">color</span><span class=\"token template-string css language-css interpolation template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css interpolation template-string css language-css\"> </span><span class=\"token template-string css language-css interpolation template-string css language-css color\">palevioletred</span><span class=\"token template-string css language-css interpolation template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css interpolation template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css interpolation template-string css language-css\">    </span><span class=\"token template-string css language-css interpolation template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\"></span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function maybe-class-name\" style=\"color:#e6db74\">App</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Wrapper</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">bgColor</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">papayawhi</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">span</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">Hello World</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">span</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">, this is my first styled component!</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Button</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">href</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://github.com/styled-components/styled-components</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">target</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">_blank</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">rel</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">noopener</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">primary</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">      GitHub</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Button</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag class-name\" style=\"color:#e6db74\">Wrapper</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>像上面的 Title，Wrapper，Button 都是组件，Title 本质就是一个 h1 标签，在通过模板字符串编写局部 css 样式。</p><p>能直接编写子元素的样式，以及<code>&amp; :hover</code>等 Sass 语法。</p><p>根据传入属性，在 css 中使用，Wrapper 传入背景颜色属性，Button 判断是否为 primary。</p><p>并且能方便的给暴露<code>className</code> props 的三方 UI 库上样式：</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">StyledButton</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">styled</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token maybe-class-name\">Button</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css\"> ... </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"styled-jsx\">styled-jsx<a class=\"hash-link\" href=\"#styled-jsx\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://github.com/vercel/styled-jsx\" target=\"_blank\" rel=\"noopener noreferrer\">vercel/styled-jsx: Full CSS support for JSX without compromises (github.com)</a></p><p>styled-jsx 概括第一印象就是 React css 的 vue 解决。<code>yarn add styled-jsx</code> 安装后，不用<code>import</code>，而是一个 babel 插件，<code>.babelrc</code>配置：</p><div class=\"language-JavaScript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-JavaScript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  \"plugins\": [</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    \"styled-jsx/babel\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>使用</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">render</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">table</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">row</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">            </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">cell</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">A0</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">            </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">className</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">cell</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">B0</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">style</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">jsx</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">{`</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          .table {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">            margin: 10px;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          .row {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">            border: 1px solid black;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          .cell {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">            color: red;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">          }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    `}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">style</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>只会作用到同级标签作用域，可以说是一种另类的内联样式了，如果不喜欢将样式写在 render 里，styled-jsx 提供了一个 <code>css</code> 的工具函数：</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">css</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'styled-jsx/css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">button</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">styled-jsx</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">button</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">style</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">jsx</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">{button}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">style</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain-text\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> button </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> css</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css selector\" style=\"color:#a6e22e;font-style:italic\">button</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">    </span><span class=\"token template-string css language-css property\" style=\"color:#f92672\">color</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token template-string css language-css\"> </span><span class=\"token template-string css language-css color\">hotpink</span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\">  </span><span class=\"token template-string css language-css punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string css language-css\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string css language-css\"></span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>补充：现在我更推荐使用 Emotion。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"原子类\">原子类<a class=\"hash-link\" href=\"#原子类\" title=\"标题的直接链接\">​</a></h2><p>简单说，就是将常用的 css 样式都封装完，只需要在 class 中引入即可</p><p>这里选用当红框架 <a href=\"https://www.tailwindcss.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">Tailwind CSS</a> 作为演示。</p><p>比方说 flex 布局的话，就需要写 <code>dispaly: flex;</code> 但是封装成类，如</p><div class=\"language-CSS codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-CSS codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">.flex {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  dispaly: flex;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>引用的时候直接在 class 中添加 flex 即可</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">h1</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag attr-value\" style=\"color:#f92672\">flex</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">'</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain-text\">tailwindcss</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">h1</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>贴一张官方演示图，把大部分常用的样式都封装成 class</p><p>官方在线例子（下图） <a href=\"https://play.tailwindcss.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Tailwind Play (tailwindcss.com)</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220114033240.png\" class=\"img_ev3q\"></p><p>有以下几种优点：</p><ol><li>源代码无非就是 css 的基本样式，如 class <code>w-auto</code> 对应 css <code>width: auto;</code> 等等</li><li>如果不是特别复杂的样式，甚至可以不用写一条 css 代码，开发效率杠杠的。</li><li>体积很小，更好的样式复用，并且打包后会根据所用的 class 进行打包，而非全部无用样式打包。</li><li>与 bootstrap 设计不同，完全可以定制化不同类型的组件，而不是像 <code>class=\"btn btn-danger\"</code> 这样。</li></ol><p>体验下来基本上就是在写内联样式 inline css 但是同时又不显得杂乱。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"组件化中使用\">组件化中使用<a class=\"hash-link\" href=\"#组件化中使用\" title=\"标题的直接链接\">​</a></h3><p>在组件化开发中，完全可以自己实现一个 Button 按钮（上间距 <code>pt-4</code>，底部间距 <code>pb-10</code>，文字为 <code>text-sky-500</code> 天蓝色），</p><div class=\"language-jsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-jsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function maybe-class-name\" style=\"color:#e6db74\">Button</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token parameter\"> children</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> color </span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">a className</span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">pt-4 pb-10 text-sky-500 </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">color</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\">children</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">a</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过要说缺点的话：</p><ol><li>可能之前标题只需要定义.title 类来完成全部样式，而 tailwind 需要好几个 css 原子类来实现</li><li>初学者可能不适应，需要反复的查阅文档。（不过用多了，自然就会习惯了）</li></ol><p>然后还有一个 WindCSS，可以看作是<strong>按需供应的</strong> Tailwind 替代方案。不过暂时不支持 React。</p><p>此外还有一篇文章非常推荐 <a href=\"https://antfu.me/posts/reimagine-atomic-css-zh\" target=\"_blank\" rel=\"noopener noreferrer\">重新构想原子化 CSS (antfu.me)</a>，不多说，再刷一遍。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最佳实现\">最佳实现？<a class=\"hash-link\" href=\"#最佳实现\" title=\"标题的直接链接\">​</a></h2><p>介绍完几种 React 中 Css 的实现（当然还有很多库没介绍，主要挑几种主流的），实际又要选择哪种呢？</p><p>说说我目前 react 所选的操作，tailwind（原子类）+ CSS modules，写一些小项目或者 demo 甚至都没必要写 css 代码，毕竟 css 是大多数前端程序员都不是那么想写的（包括我）。而做一些自定义的小组件的话那肯定是 styled-components，而 styled-jsx，对组件代码牺牲挺大所以不怎么写。</p><p>不过每个人使用风格不同，我一开始接触原子类是 windicss，用久了之后习惯了常用的 class，编写起来可以说是相当的快捷了。</p><p>不过相比 Vue 而言，react 的 css 实现着实费劲。</p><blockquote><p>参考链接：</p><p><a href=\"https://www.ruanyifeng.com/blog/2016/06/css_modules.html\" target=\"_blank\" rel=\"noopener noreferrer\">CSS Modules 用法教程 - 阮一峰的网络日志 (ruanyifeng.com)</a></p><p><a href=\"https://www.ruanyifeng.com/blog/2017/04/css_in_js.html\" target=\"_blank\" rel=\"noopener noreferrer\">CSS in JS 简介 - 阮一峰的网络日志 (ruanyifeng.com)</a></p><p><a href=\"https://juejin.cn/post/6844903638289252360\" target=\"_blank\" rel=\"noopener noreferrer\">React 拾遗：从 10 种现在流行的 CSS 解决方案谈谈我的最爱 （下） - 掘金 (juejin.cn)</a></p></blockquote>",
            "url": "https://onewhitethreee.github.io/examenEbau/react-css",
            "title": "react的css",
            "summary": "全局样式",
            "date_modified": "2022-01-14T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "react",
                "css"
            ]
        },
        {
            "id": "springboot-hot-update",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"步骤一\">步骤一<a class=\"hash-link\" href=\"#步骤一\" title=\"标题的直接链接\">​</a></h2><p>pom.xml 中在加入依赖</p><div class=\"language-xml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-xml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">dependency</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">org.springframework.boot</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">spring-boot-devtools</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">optional</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">true</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">optional</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">scope</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">true</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">scope</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">dependency</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后再<code>&lt;build&gt;</code>下添加如下依赖。</p><div class=\"language-xml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-xml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">build</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">plugins</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">plugin</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">org.springframework.boot</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">spring-boot-maven-plugin</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">configuration</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">fork</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">true</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">fork</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">configuration</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">plugin</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">plugins</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">build</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"步骤二\">步骤二<a class=\"hash-link\" href=\"#步骤二\" title=\"标题的直接链接\">​</a></h2><p>（1）打开设置勾选自动构建项目</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220506130419248.png\" alt=\"image-20220506130419248\" class=\"img_ev3q\"></p><p>（2）高级设置中勾选自动 make，老版 IDEA 需要<code>ctrl + shift + alt + /</code>，选择注册表，勾上 Compiler autoMake allow when app running，但新版中移到高级设置中。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220506130533312.png\" alt=\"image-20220506130533312\" class=\"img_ev3q\"></p><p>接着启动项目，修改文件即可自动热加载，无需手动重新运行。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/springboot-hot-update",
            "title": "SpringBoot热更新",
            "summary": "步骤一",
            "date_modified": "2022-01-10T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "java",
                "springboot"
            ]
        },
        {
            "id": "why-use-pnpm",
            "content_html": "<p><a href=\"https://pnpm.io/zh/\" target=\"_blank\" rel=\"noopener noreferrer\">pnpm 文档</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>在一个 node 项目中免不了 node_modules 依赖，假设项目 A 用的了 Express 依赖，同时项目 B 也用到了 Express，并且两者所存放的位置不同，那么磁盘空间将会多出两份 Express 依赖，假设有 100 个项目，那么将会有有 100 倍的空间被浪费。这些空间还可以用磁盘空间来弥补，但是这 100 个项目如果都使用 npm i 去下载同样版本依赖，则是实实在在耗费网络资源去下载。</p><p>pnpm 能解决以下两点问题</p><ul><li>包安装速度极快；</li><li>磁盘空间利用非常高效。</li></ul><p>而这些问题是一个 node 项目中常有的。相信此时的你都有点蠢蠢欲动了，而安装也很简单</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装\">安装<a class=\"hash-link\" href=\"#安装\" title=\"标题的直接链接\">​</a></h2><p>请查阅你的 node 版本与 pnpm 是否匹配 <a href=\"https://pnpm.io/zh/installation#%E5%85%BC%E5%AE%B9%E6%80%A7\" target=\"_blank\" rel=\"noopener noreferrer\">安装 | pnpm</a></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install -g pnpm</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"升级\">升级<a class=\"hash-link\" href=\"#升级\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">pnpm add -g pnpm</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此时 pnpm 就已经安装完了，与 yarn 安装一样，都感觉没安装似的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用\">使用<a class=\"hash-link\" href=\"#使用\" title=\"标题的直接链接\">​</a></h2><p>pnpm 命令几乎与 npm 一样，设置配置的方式也与 npm 相同，这里不妨尝试通过 pnpm 去下载 express 依赖，打开 CMD，将路径改成你平时写 js 代码的地方，切记不要在 C 盘路径下，不然将会在<code>C:\\Users\\{userDir}\\.pnpm-store\\v3</code>去管理你的所有依赖，至于为什么后文会说，这里选择 F 盘进行安装，安装结果如下。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220108040813.png\" alt=\"image-20220108040813223\" class=\"img_ev3q\"></p><p>不难看出，它将依赖存放至<strong><code>F:\\.pnpm-store\\v3</code></strong>下，但此时查看项目目录的 node_modules 文件夹</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220108041030.png\" alt=\"image-20220108041030618\" class=\"img_ev3q\"></p><p>发现<code>express</code>与<code>mime-types</code>的右侧带了回车符，而这两个文件夹实际上是 window 的硬链接，而读取的就是存放在<code>F:\\.pnpm-store\\v3</code>下的依赖。虽然查看 node_modules 属性会发现显示的空间貌似和原始的链接所占用的空间一样，但其实是同一个位置，官方中常用问题中也有介绍到 <a href=\"https://pnpm.io/zh/faq#%E5%A6%82%E6%9E%9C%E5%8C%85%E5%AD%98%E5%82%A8%E5%9C%A8%E5%85%A8%E5%B1%80%E5%AD%98%E5%82%A8%E4%B8%AD%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E7%9A%84-node_modules-%E4%BD%BF%E7%94%A8%E4%BA%86%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4\" target=\"_blank\" rel=\"noopener noreferrer\">常见问题 | pnpm</a>，所以真不用担心磁盘空间的问题。</p><p>这时候去查看 <code>F:\\.pnpm-store\\v3\\files</code> 会发现都是一堆数字与字母命名的文件夹，而依赖都存放至这些杂乱无章的文件名之中。同时.pnpm-store 是根据你所在驱动器（这里是 F 盘）下创建的，可以通过 <code>pnpm store path</code>查看，也就是上文为什么说不要在 C 盘路径（包括桌面）去安装依赖了，所以不用担心 C 盘空间会越来越小（如果你的代码是在 C 盘编写的话，那当我没说）。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>不过还是要提醒一句，即便 pnpm 能解决磁盘问题，但还是存在一定的兼容性，如果一个项目是用 npm 或者 yarn 进行构建的，使用 pnpm 是绝对免不了一些问题，小问题暂时想不到，大问题无法运行，所以请三思再考虑对已有项目是否尝试升级 pnpm。</p><p>但我认为还是有必要尝试尝试下，不尝试，怎么能发现新大陆呢。</p><blockquote><p>参考链接：<a href=\"https://juejin.cn/post/6932046455733485575#heading-14\" target=\"_blank\" rel=\"noopener noreferrer\">关于现代包管理器的深度思考——为什么现在我更推荐 pnpm 而不是 npm/yarn? - 掘金 (juejin.cn)</a></p></blockquote>",
            "url": "https://onewhitethreee.github.io/examenEbau/why-use-pnpm",
            "title": "为什么使用pnpm",
            "summary": "pnpm 文档",
            "date_modified": "2022-01-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "node",
                "pnpm"
            ]
        },
        {
            "id": "springboot-project-structure",
            "content_html": "<p>演示代码地址：<a href=\"https://github.com/kuizuo/spring-boot-demo\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/spring-boot-demo (github.com)</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"目录结构展示图\">目录结构展示图<a class=\"hash-link\" href=\"#目录结构展示图\" title=\"标题的直接链接\">​</a></h2><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220108011921.png\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"controller\">controller<a class=\"hash-link\" href=\"#controller\" title=\"标题的直接链接\">​</a></h3><p>controller 目录下对应的也就是控制器，用于接收用户的请求（get，post 等），如下面代码</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">controller/UserController.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@RestController</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@RequestMapping</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"/user\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserController</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Resource</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token plain\"> userService</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@GetMapping</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"list\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">List</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">list</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userService</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>用户请求<a href=\"http://127.0.0.1:8080/users/list\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:8080/user/list</a> 将会调用 userService.findAll 方法，当然这个方法事先定义好，用于获取所有用户。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"modelservice\">model（service）<a class=\"hash-link\" href=\"#modelservice\" title=\"标题的直接链接\">​</a></h3><p>这里数据库连接方式以 JPA（一个 ORM 框架）为例，可以安装一个 IDEA 插件 JPA Buddy 新建文件时可以直接创建 Entity(实体)或 Repository(仓库)</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220506115207717.png\" alt=\"image-20220506115207717\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"entity-类\">entity 类<a class=\"hash-link\" href=\"#entity-类\" title=\"标题的直接链接\">​</a></h4><p>在 domain 目录下创建实体类，大致如下（lombok 因人而异选择使用，相对不展示 get 与 set 会好一些）</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">domain/User.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">lombok</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">Getter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">lombok</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">Setter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">javax</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">persistence</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import operator\" style=\"color:#66d9ef\">*</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Entity</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Getter</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Setter</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Table</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"user\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">implements</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Serializable</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@GeneratedValue</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@ApiModelProperty</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ID\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> hidden </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Column</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">nullable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> unique </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Column</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">nullable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Column</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">nullable </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> email</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>User.java 用于定义 user 实体，在 ORM 中，数据库表中的字段都可以通过实体类中的属性来定义的，如果定义好 user 实体，并且在 resources/application.yml 中设置了<code>spring.jpa.hibernate.ddl-auto: update</code> 那么启动项目后，数据库将会自动创建 user 表且其表中字段自动为<code>@Column</code>注解的字段。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"repository-类\">repository 类<a class=\"hash-link\" href=\"#repository-类\" title=\"标题的直接链接\">​</a></h4><p>创建完实体后，还需要定义数据接口访问层 DAO，在 JPA 中则是在 repository 目录下创建。</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">repository/UserRepository.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">interface</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserRepository</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">extends</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">JpaRepository</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token generics\"> </span><span class=\"token generics class-name\" style=\"color:#e6db74\">Long</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">JpaSpecificationExecutor</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findByUsername</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>一般情况下该接口无需定义额外方法，如有需要还可以定义属于自己的查询语句，比如上面的 findByUsername，这时候就注入后的 userRepository 对象就可以使用<code>userRepository.findByUsername(\"kuizuo\");</code> ，将会返回数据库中该用户名的数据。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"userservice-类\">UserService 类<a class=\"hash-link\" href=\"#userservice-类\" title=\"标题的直接链接\">​</a></h4><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">service/UserService.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Service</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Autowired</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserRepository</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">List</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>@Autowired 可能不建议使用字段注入</strong>，可以在类添加@RequiredArgsConstructor 注解，表明 userRepository 不为空，总之目的就是将 userRepository 注入，供服务可用。</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">service/UserService.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">com</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">kuizuo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">demo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">domain</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">User</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">com</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">kuizuo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">demo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">repository</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">UserRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">com</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">kuizuo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">demo</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">service</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">lombok</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">RequiredArgsConstructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">org</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">springframework</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">stereotype</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">Service</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">java</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import namespace\" style=\"color:rgb(178, 204, 214);opacity:0.7\">util</span><span class=\"token import namespace punctuation\" style=\"color:#f8f8f2;opacity:0.7\">.</span><span class=\"token import class-name\" style=\"color:#e6db74\">List</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Service</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@RequiredArgsConstructor</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">final</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserRepository</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Override</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">List</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接着就可以使用 userRepository 下的方法，如 <code>userRepository.findAll</code>命令相当于 <code>select * from user</code>，返回所有的用户列表。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"service-接口实现\">service 接口实现<a class=\"hash-link\" href=\"#service-接口实现\" title=\"标题的直接链接\">​</a></h4><p>此外 service 服务还可以有另一种写法，在 service 中添加一个 impl 目录，通过对 userService <strong>接口</strong>进行实现的服务。\n在上面所写的 UserService 是一个类，这边将其改为一个接口，代码如下</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">service/UserService.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">interface</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token class-name\" style=\"color:#e6db74\">List</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同时只保留 UserService 所要提供的方法，然后在 service/impl 中创建文件 UserServiceImpl.java，具体代码如下</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">service/impl/UserServiceImpl.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Service</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@RequiredArgsConstructor</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserServiceImpl</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">implements</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserService</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">final</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserRepository</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Override</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">List</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token generics class-name\" style=\"color:#e6db74\">User</span><span class=\"token generics punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findAll</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Override</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">orElseThrow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">BadRequestException</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"用户不存在\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>调用并无差异，对 service 进一步的封装，相对更规范些（我看外面都这么写的，所以就这么写了）。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据接口\">数据接口<a class=\"hash-link\" href=\"#数据接口\" title=\"标题的直接链接\">​</a></h4><p><a href=\"https://developer.aliyun.com/article/694418\" target=\"_blank\" rel=\"noopener noreferrer\">POJO、PO、DTO、DAO、BO、VO 需要搞清楚的概念</a>\n此外还可能对不同层的数据进行命令</p><ul><li>数据实体(entity)类<code>PO</code> ：<ul><li>jpa 项目: domain 目录</li><li>mybatis 项目: entity 目录</li></ul></li><li>数据接口访问层<code>DAO</code>：<ul><li>jpa 项目： repository 目录</li><li>mybatis 项目： mapper 目录</li></ul></li><li>数据传输对象<code>DTO</code>：dto 目录</li><li>视图对象<code>VO</code>：vo 目录</li></ul><p>其中前两种在上文中 jpa 的例子中已经介绍了，简单介绍下后两者</p><p><code>DTO</code> 经过处理后的 PO，在传输数据对象中可能增加或者减少 PO 的属性</p><p><code>VO</code> 在控制层与视图层进行传输交换</p><p>对于后两者而言，可能还需要提供 Mapper 类用于数据转化，如 DTO 转 PO，PO 转 DTO。</p><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"modelmapper\">modelMapper<a class=\"hash-link\" href=\"#modelmapper\" title=\"标题的直接链接\">​</a></h5><div class=\"language-xml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-xml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">dependency</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">org.modelmapper</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">groupId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">modelmapper</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">artifactId</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">version</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">2.3.5</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">version</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">dependency</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同时在启动类下配置为一个 Bean 才能被注入使用</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@SpringBootApplication</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">DemoApplication</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">static</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">void</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">main</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token class-name\" style=\"color:#e6db74\">SpringApplication</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">DemoApplication</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Bean</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ModelMapper</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">modelMapper</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ModelMapper</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"po-与-dto-转化\">po 与 dto 转化<a class=\"hash-link\" href=\"#po-与-dto-转化\" title=\"标题的直接链接\">​</a></h5><p>还是上面那个 user 实体，但是返回的数据中不需要将 user 的 password 展示出来。在 service/dto 中创建一个 UserDTO</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">service/dto/UserDto.java</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Getter</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Setter</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">String</span><span class=\"token plain\"> email</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果要转化，通常要一个个字段转化，如下</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Override</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> user </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\">  userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">orElseThrow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">BadRequestException</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"用户不存在\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token plain\"> userDto </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        userDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setId</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">user</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getId</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        userDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setUsername</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">user</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getUsername</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        userDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">setEmail</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">user</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">getEmail</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>结果肯定是没问题的，但是代码写的很丑陋且不易于维护。就可以使用 modelMapper 来转化（前提已经注入）</p><div class=\"language-java codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-java codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">private</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">final</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">ModelMapper</span><span class=\"token plain\"> modelMapper</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token annotation punctuation\" style=\"color:#f8f8f2\">@Override</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token class-name\" style=\"color:#e6db74\">Long</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token class-name\" style=\"color:#e6db74\">User</span><span class=\"token plain\"> user </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\">  userRepository</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">findById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">orElseThrow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">BadRequestException</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"用户不存在\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token plain\"> userDto </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> modelMapper</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">user</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">UserDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> userDto</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过这样使用可能还是不大规范，同时还需要手动传入对象及其 Class 对象。所以可能还会创建 service/mapstruct，然后创建 UserMapper，这里就不举例了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"view\">view<a class=\"hash-link\" href=\"#view\" title=\"标题的直接链接\">​</a></h3><p>此外还有个文件 resources/templates/user.html 用于返回页面，不过这些都属于模板语言的内容，就不细说了（针对前后端分离的项目而言，后端主要提供数据便可）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"整体流程\">整体流程<a class=\"hash-link\" href=\"#整体流程\" title=\"标题的直接链接\">​</a></h3><p>大致的流程便可总结为 Controller 接收请求 → 调用 service 服务 → 调用数据接口服务 dao 提供数据 → 将数据(页面)返回给用户</p><p><strong>此外，该目录结构仅仅本人所选用的 springboot 项目结构，实际情况还需额外考虑。</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>回到开头，其中提供业务服务（数据）的也就是 service 所做的事情，控制接口的则是 controller，还有一个视图层 view 介绍的比较少（反正就是返回数据或页面）。其中最为复杂的也就是 service 所提供的服务，相对 controller 和 view 而言会繁琐许多。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/springboot-project-structure",
            "title": "SpringBoot项目结构",
            "summary": "演示代码地址：kuizuo/spring-boot-demo (github.com)",
            "date_modified": "2022-01-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "java",
                "springboot",
                "develop"
            ]
        },
        {
            "id": "why-i-turn-night-into-day-to-code",
            "content_html": "<p>其实我很早就想写这个话题了。因为我是一个熬夜大户，经常动不动就是 3,4 点睡觉，甚至有时候是日夜颠倒的作息习惯，如同过美国时间般。但与常人想法不同，我巴不得在保持这种作息状态。我会分以下几点来阐述我这一不正常的行为，相对于我而言的好点。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"对我而言的好处\">对我而言的好处<a class=\"hash-link\" href=\"#对我而言的好处\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安静\">安静<a class=\"hash-link\" href=\"#安静\" title=\"标题的直接链接\">​</a></h3><p>夜生活过的人应该最清楚了，那种静可以算上是幽静了，加上黑夜的承托与屏幕前的微光，如果恰好此时耳机还播放着音乐，好了，直接进入自我境界。</p><p>这种安静与图书馆的安静是根本无法相比的，图书馆可能还有走动声，而凌晨你唯独只能听见自己的脚步声（不排除有上厕所的室友，有时候可能被其吓得一跳），最主要还是黑，你的视野中除了屏幕的信息外几乎很难有其他东西去干涉你。</p><p>你问我用的什么键盘？程序员不都用静电容的键盘吗？机械键盘的声音在晚上敲怕不是给室友去世器。(tips: 室友包括我)</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"琐事\">琐事<a class=\"hash-link\" href=\"#琐事\" title=\"标题的直接链接\">​</a></h3><p>安静也许远远还不够，想要达到与世隔绝的地步，在互联网这个时间段最简单的办法就是断网。如果事情都与你毫不相干，那也差不多已经与这个世界说拜拜了，但在白天你还是有一定的存在感，会有一些莫名的琐事干涉你当前正在进行的状态。</p><p>我就说一个最简单的例子，假如你正在编写一个功能的时候，此时手机正好弹出一条信息（通常为广告），此时大多数人基本上就去看手机去了，意志力好一点的可能看完直接回到手头的任务上，差一点的可能就是几十分钟的短视频，也许很夸张，但确实如此。</p><p>所以我一般都会在 0~6 点开启勿扰模式（睡眠模式），但在白天却又不能错过很多重要的信息。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"思考\">思考<a class=\"hash-link\" href=\"#思考\" title=\"标题的直接链接\">​</a></h3><p>可能对我而言，灵感通常是在睡前（准确说是夜深时）产生的，同时脑子里想的东西也会比白天而言多，想的多自然写的东西也就多，所以也就是我为什么很多代码 Commit 与博客编写时间都是在 0~6 点这个时间，就连这篇文章也都是在夜间写的，白天实在是想不出什么点来写。</p><p>也许与静也有相关，白天普遍嘈杂的声音，说实话很难让人能静下来去冥想，但在夜晚，静确实它唯一的资本。</p><p><strong>唯有夜深人静，才有自我深思。</strong></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"工作效率\">工作效率<a class=\"hash-link\" href=\"#工作效率\" title=\"标题的直接链接\">​</a></h3><p>在我亲身体验下来，可以毫不夸张的说，我在夜晚的工作效率可以是白天的 3，4 倍，没错就是这么恐怖。</p><p>至于原因，大概率（99%）是由上面几点导致的，所以也就是为什么我巴不得在夜深人静的时候开始 doing，也就导致这异于常人的作息规律。</p><p>但回想 1 小时抵 3 小时，怎么想都是赚，换做你，会考虑这样的作息吗？</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"对我而言的坏处\">对我而言的坏处<a class=\"hash-link\" href=\"#对我而言的坏处\" title=\"标题的直接链接\">​</a></h2><p>其实坏处都不用写，是个正常作息的一眼就能看出来，我也不细说了。</p><p>但往往事与愿违，上面的这种作息行为都有点压榨白天的时间，而白天总要上学，上班，周末又不可能一次性就调整成这样的作息，所以我这种情况一般也都发生在长假期，也就是寒暑假（包括这次的寒假）。但其实大多时间还都是夜间做事，只是假期的夜间时间相对延后亿点。</p><font size=\"1\">~~与好处相比，除了猝死其他都还能接受。~~</font><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>原本标题我是起为什么喜欢熬夜，但后来我并不认为我是在熬夜，只是时间相对错乱，每天睡觉的时间与正常作息并没有差别，唯一的差别估计就是天亮了我睡了，天暗了我醒了。主要还是强调作息，所以便有了这个标题。</p><p>当然我写这篇文章也不是想要倡导夜间做事有多好，每个人都有属于自己适应的时间段，比方说有些人就喜欢早晨背单词，而有些则是睡前，道理都是同样的。我只是觉得我这种习惯比较异类，也许也有人的作息习惯和我臭味相投。</p><p>⚠️ 非专业人士，请勿模仿</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/why-i-turn-night-into-day-to-code",
            "title": "为何我选择日夜颠倒敲代码",
            "summary": "其实我很早就想写这个话题了。因为我是一个熬夜大户，经常动不动就是 3,4 点睡觉，甚至有时候是日夜颠倒的作息习惯，如同过美国时间般。但与常人想法不同，我巴不得在保持这种作息状态。我会分以下几点来阐述我这一不正常的行为，相对于我而言的好点。",
            "date_modified": "2022-01-03T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "杂谈"
            ]
        },
        {
            "id": "js-code-deobfuscator",
            "content_html": "<p>基于 Babel 对 JS 代码进行混淆与还原操作的网站 <a href=\"http://deobfuscator.kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">JS 代码混淆与还原 (kuizuo.cn)</a></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220131193110.png\" alt=\"js-de-obfuscator\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"还原前言\">还原前言<a class=\"hash-link\" href=\"#还原前言\" title=\"标题的直接链接\">​</a></h2><p>AST 仅仅只是静态分析，但可以将还原出来的代码替换原来的代码，以便更好的动态分析找出相关点。在还原时，并不是所有的代码都能还原成一眼就识破代码执行逻辑的，ast 也并非万能，如果你拥有强大的 js 逆向能力，有时候动态调试甚至比 AST 静态分析来的事半功倍。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"还原不出最原始的代码\">还原不出最原始的代码<a class=\"hash-link\" href=\"#还原不出最原始的代码\" title=\"标题的直接链接\">​</a></h3><p>标识符是可以随便定义的，只要变量不冲突，我可以随意定义，那么就已经决定我们还原不出源代码的变量名，所以能还原的只有一些花指令，使其代码变好看，方便调试。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"还原也不是万能的\">还原也不是万能的<a class=\"hash-link\" href=\"#还原也不是万能的\" title=\"标题的直接链接\">​</a></h3><p>混淆的方式有很多，与之对应还原的方式也有很多，上面那套混淆的还原可能只针对那一套混淆的代码，如果拿另一份混淆过的代码，然后执行这个还原程序的话，那程序多半有可能报错。所以绝对没有万能的还原代码，所有的还原程序，都需要针对不同的混淆手段来进行处理的。</p><p><strong>我只是将我所遇到的混淆手段整合到一套代码上，而非所有的混淆手段都能进行还原处理的。</strong></p><p><strong>同时也别过于追求还原，因为还原很容易破坏原有代码，导致一些未知 bug。</strong></p><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</h5></div><div class=\"admonition-content\"><p>如需要定制化还原，也可联系。（还是要说下，绝对无法还原出最原始代码）</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"例子\">例子<a class=\"hash-link\" href=\"#例子\" title=\"标题的直接链接\">​</a></h2><p>下文将会针对主流的一些混淆手段（至少是在我遇到的混淆中相对比较好还原的），并会附上对应代码供参考（不放置代码出处）。</p><p>接下来我将要演示一个混淆代码是如何还原的，这个例子是我第一次接触混淆的例子，也可以说是我玩的最溜的一次还原了，反正折腾了也有 4,5 来次。</p><p>贴上代码 git 地址 <a href=\"https://github.com/kuizuo/js-de-obfuscator/blob/main/example/deobfuscator/cx/code.js\" target=\"_blank\" rel=\"noopener noreferrer\">js-de-obfuscator/example/deobfuscator/cx</a></p><blockquote><p>注：该 js 文件是通过工具<a href=\"https://www.obfuscator.io/\" target=\"_blank\" rel=\"noopener noreferrer\">JavaScript Obfuscator Tool</a>进行混淆处理的。</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"分析-ast\">分析 AST<a class=\"hash-link\" href=\"#分析-ast\" title=\"标题的直接链接\">​</a></h3><p>首先一定一定要将混淆的代码解析成 AST 树结构，任何混淆的还原都是如此。首先简单随便看看代码，不难发现这些代码中都有<code>'\\x6a\\x4b\\x71\\x4b'</code>这样的十六进制编码字符，可以使用现成的工具，格式化便会限制编码前的结果，不过这边使用 ast 来进行操作</p><p>通过 AST 查看 node 节点，可以发现<code>value</code>正是我们想要的数据，但这里确显示的是<code>extra.raw</code>，实际上只需要遍历到相应的节点，然后 extra 属性给删除即可，同样的 Unicode 编码也是按上述方式显示。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211224202108279.png\" alt=\"image-20211224202108279\" class=\"img_ev3q\"></p><p>具体遍历的代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将所有十六进制编码与Unicode编码转为正常字符</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">hexUnicodeToString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">StringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> curNode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">delete</span><span class=\"token plain\"> curNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extra</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">NumericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> curNode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">delete</span><span class=\"token plain\"> curNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extra</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后将遍历后处理过的代码与 demo.js 替换一下，方便接下来的还原处理。不过处理完还是有大部分未知的字符串需要解密，当然也有一些没处理过的代码。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"找解密函数\">找解密函数<a class=\"hash-link\" href=\"#找解密函数\" title=\"标题的直接链接\">​</a></h3><p>如果你尝试过静态分析该代码，会发现一些参数都通过<!-- -->_<!-- -->0x3028 来调用，像这样</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'nfkbEK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'jKqK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">')bls'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过认真查看会发现像成员表达式<code>MemberExpression</code>语句<code>_0x3028[\"nfkbEK\"]</code>，但在第三条语句却定义函数<code>_0x3028</code>。其实是 js 的特性，比方说下面的代码就可以给函数添加一个自定义属性</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'abc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">123</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'abc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 3</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 123</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过不影响，这里只是提一嘴，并不是代码的问题。而其中<strong><code>_0x3028</code>就是解密函数</strong>，且遍历<code>_0x3028</code>调用表达式，且参数为两个的 CallExpression。</p><p>那么接下来就要着重查看前三个语句，因为这三条语句便是这套混淆的关键所在。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">demo.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x34ba </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"JcOFw4ITY8KX\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"EHrDoHNfwrDCosO6Rkw=\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x2684bf</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x5d23f1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 这里只是定义了一个数组乱序的函数,但是调用是在后面</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">_0x20d0a1</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x17cf70</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">while</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">--</span><span class=\"token plain\">_0x17cf70</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            _0x2684bf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'push'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x2684bf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'shift'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">_0x1b4e1d</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x3dfe79 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">'data'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token string-property property\" style=\"color:#f92672\">'key'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token string-property property\" style=\"color:#f92672\">'value'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'timeout'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"setCookie\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x41fad3</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x155a1e</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x2003ae</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x48bb02</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"removeCookie\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"dev\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"getCookie\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x23cc41</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x5ea286</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                _0x23cc41 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x23cc41 </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x20a5ee</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x20a5ee</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在这里定义了一个花指令函数调用来调用</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">_0x267892</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x51e60d</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x57f223</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token function\" style=\"color:#e6db74\">_0x51e60d</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token plain\">_0x57f223</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 实际调用的地方</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token function\" style=\"color:#e6db74\">_0x267892</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x20d0a1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> _0x5d23f1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x1c1cc3 </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">decodeURIComponent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1c1cc3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">_0x1b4e1d</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x34ba</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">296</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x2308a4</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x573528</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  _0x2308a4 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x2308a4 </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x29a1e7 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x34ba</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">_0x2308a4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 省略百行代码...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x29a1e7</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中省略的代码没必要细读，因为后续都只将这三条语句写入到 node 内存中（eval），然后来调用。接下来分析每一个语句都是干嘛的。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"大数组\">大数组<a class=\"hash-link\" href=\"#大数组\" title=\"标题的直接链接\">​</a></h4><p>基本 99%的混淆<strong>第一条语句都是一个大数组</strong>，存放这所有加密过的字符串，而我们要做的就是找到所有加密过的字符串，将其还原。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数组乱序\">数组乱序<a class=\"hash-link\" href=\"#数组乱序\" title=\"标题的直接链接\">​</a></h4><p>然后接着<strong>第二条语句一般都是自调用函数</strong>，将大数组与数组乱序数量作为参数，其中的作用是将数组进行乱序，也就是上面代码中加亮的地方，但这里只是定义了一个函数<code>_0x20d0a1</code>，而实际调用的地方 <code>_0x1b4e1d</code> 中<code>_0x3dfe79</code>.<code>getCookie</code>中调用的，上述代码中有注释。如果你是正常一步步分析还真不一定的分析的出来，这就是混淆恶心的地方。</p><p>不吹混淆了，总之只要知道第二条语句是用作数组乱序，而具体无论怎么混淆，我们都可以通过 eval 来调用一遍，详看后文代码。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"解密函数\">解密函数<a class=\"hash-link\" href=\"#解密函数\" title=\"标题的直接链接\">​</a></h4><p>第三条语句就是加密函数，实际上就是传入大数组的索引，然后返回数组对应的成员，只是这边将其封装成函数，相当于原本 <code>_0x34ba[0]</code> 变为<code>_0x3028(\"0x0\", \"jKqK\")</code> 形式来获取原本的字符串（这里只是举例，实际还涉及到第二个参数）。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"还原字符串\">还原字符串<a class=\"hash-link\" href=\"#还原字符串\" title=\"标题的直接链接\">​</a></h3><p>上面说了那么多，实际上具体混淆逻辑其实根本没必要去理解，像传入的第二个参数做了啥根本无需了解，因为我们最终的目的是将 <code>_0x3028(\"0x0\", \"jKqK\")</code>转为原本字符串，然后替换的当前节点的。所有只需要遍历到<code>_0x3028(\"0x0\", \"jKqK\")</code>，然后<strong>执行一遍解密函数</strong>得到解密后的结果，然后替换即可。所以如何执行解密函数便是重点了。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"将解密函数添加到内存中\">将解密函数添加到内存中<a class=\"hash-link\" href=\"#将解密函数添加到内存中\" title=\"标题的直接链接\">​</a></h4><p>首先要将三条语句运行一遍，js 中要在运行时运行字符串的代码，就可以使用 eval，但 eval 有作用域的问题，eval 运行的代码作用范围都是局部的，如果脱离当前作用域，eval 运行的代码就相当于无效了，所有可以使用<code>window.eval</code>或<code>global.eval</code>，将其写入置全局作用域下，由于这里是 node 环境，便用<code>global.eval</code>。</p><p>截取前三条语句，使用 eval 写入内存</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 拿到解密函数所在节点</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> stringDecryptFuncAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 拿到解密函数的名字 也就是_0x3028</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">DecryptFuncName</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> stringDecryptFuncAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">declarations</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">stringDecryptFuncAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 把这三部分的代码转为字符串，由于存在格式化检测，需要指定选项，来压缩代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> stringDecryptFunc </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">compact</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将字符串形式的代码执行，这样就可以在 nodejs 中运行解密函数了</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">global</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">eval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">stringDecryptFunc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"调用解密函数\">调用解密函数<a class=\"hash-link\" href=\"#调用解密函数\" title=\"标题的直接链接\">​</a></h4><p>这时候，就可以使用<code>_0x3028(\"0x0\", \"jKqK\")</code> 来输出解密后的结果，不过要一个个手动输入还是太麻烦了，完全可以找到<code>_0x3028</code>调用的所有地方，然后判断是否为调用表达式 CallExpression，然后使用<code>eval('_0x3028(\"0x0\", \"jKqK\")')</code> 获取解密结果。这边就举一个遍历的例子。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">VariableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 当变量名与解密函数名相同</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">DecryptFuncName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token maybe-class-name\">DecryptFuncName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 通过referencePaths可以获取所有引用的地方</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      binding </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 判断父节点是调用表达式，且参数为两个</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">parentPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isCallExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出参数与解密后的结果</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> args </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">parentPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">join</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">' '</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> str </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">eval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">parentPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">args</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">parentPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在混淆的时候就提及到 binding 可以获取当前变量的作用域，而<code>binding.referencePaths</code>就可以获取到所有调用的地方，那么只需要判断是否为调用表达式，且参数是两个的情况下，然后通过 eval 执行一遍整个节点，也就是<code>eval('_0x3028(\"0x0\", \"jKqK\")')</code>，然后通过 replaceWith，替换节点即可。传入的参数与加密后的结果大致展示如下，可自行运行一遍程序中<code>decStringArr()</code></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x0 jKqK PdAlB</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x1 )bls jtvLV</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x2 M10H SjQMk</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x3 2Q@E length</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x4 [YLR length</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x5 QvlS charCodeAt</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x6 YvHw IrwYd</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x7 iLkl ClOby</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">0x8 DSlT console</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">...</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"两者代码对比\">两者代码对比<a class=\"hash-link\" href=\"#两者代码对比\" title=\"标题的直接链接\">​</a></h4><p>原先代码与处理后的代码对比(部分)</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x505b30 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'jKqK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">')bls'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x104ede </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x3d32a2</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'bKNqX'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x2'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'M10H'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x46992c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          _0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">d</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x3'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'2Q@E'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x1efd4e</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x46992c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x46992c </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x4'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'[YLR'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x46992c</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;&lt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x5'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'QvlS'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x46992c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">~</span><span class=\"token plain\">_0x1efd4e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2147483647</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;</span><span class=\"token plain\"> _0x1efd4e</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x45a8ce </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x104ede</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x6'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'YvHw'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x7'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'iLkl'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x8'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'DSlT'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x9'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'YW6h'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xa'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'&amp;12i'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xb'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'1jb4'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'debug'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'k9U['</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xd'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'nUsA'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xe'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">')bls'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0xf'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'PZDB'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x10'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'r8Qx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x11'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'AIMj'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x12'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'[YLR'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x13'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'r8Qx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x14'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'YLF%'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x1fa1e3 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x15'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'sLdn'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x3d32a2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _0x35fd15 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x1fa1e3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token function\" style=\"color:#e6db74\">_0x142a1e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        _0x104ede </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x45a8ce</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x16'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Yp5j'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x17'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">']R4I'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x18'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'M10H'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">_0x3028</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'0x19'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'%#u0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'stateObject'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x505b30 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'PdAlB'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'jtvLV'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x104ede </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0x3d32a2</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'bKNqX'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'SjQMk'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x46992c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          _0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">d</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'length'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x1efd4e</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x46992c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x46992c </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'length'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x46992c</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;&lt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> _0xb2c58f</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'charCodeAt'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x46992c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x5cae2b </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> _0x1efd4e </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">~</span><span class=\"token plain\">_0x1efd4e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2147483647</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;</span><span class=\"token plain\"> _0x1efd4e</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x45a8ce </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x104ede</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'IrwYd'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ClOby'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'warn'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'debug'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'info'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'error'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'exception'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                that</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'trace'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> func</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'WuEjf'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'qpuuN'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x1fa1e3 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _0x35fd15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'apply'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_0x3d32a2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _0x35fd15 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x1fa1e3</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token function\" style=\"color:#e6db74\">_0x142a1e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        _0x104ede </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _0x45a8ce</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'constructor'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'debu'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'gger'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'apply'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'stateObject'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以发现处理过的代码至少无需动态调用出解密后的结果，并且像<code>if (\"PdAlB\" !== \"jtvLV\")</code>这种语句都可以直接一眼看出必定为 true，但混淆后<code>if (_0x3028(\"0x0\", \"jKqK\") !== _0x3028(\"0x1\", \")bls\"))</code>却无法看出，<strong>这就是 AST 静态分析的优势所在</strong>。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"删除混淆语句\">删除混淆语句<a class=\"hash-link\" href=\"#删除混淆语句\" title=\"标题的直接链接\">​</a></h4><p>在执行完字符串解密后，其实大数组与解密函数都已经用不到了，那么就可以通过 shift 将前三条语句给删除。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将源代码中的解密代码给移除</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">shift</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">shift</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">shift</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但一般<strong>不推荐删除</strong>，因为我们有可能是需要将我们还原后的代码与网站内混淆过的代码进行替换，然后再进行动态调试分析，但如果删除了这三条混淆语句，有可能会导致代码执行出错。我之前习惯删除，但直到我遇到了一个网站。。。</p><p>最终整个完成的代码在类方法<code>decStringArr</code></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"找解密函数优化\">找解密函数优化<a class=\"hash-link\" href=\"#找解密函数优化\" title=\"标题的直接链接\">​</a></h3><p>在上面的代码中有一段这样的代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 当变量名与解密函数名相同</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">DecryptFuncName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中这里的 DecryptFuncName 对应的是解密函数的函数名<!-- -->_<!-- -->0x3028，是通过人为定义，同时载入的是前三条语句，万一解密函数在第四条语句，或者有多个解密函数的情况下，就需要去改动代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 拿到解密函数所在节点</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> stringDecryptFuncAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 拿到解密函数的名字 也就是_0x3028</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">DecryptFuncName</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> stringDecryptFuncAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">declarations</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">stringDecryptFuncAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 把这三部分的代码转为字符串，由于存在格式化检测，需要指定选项，来压缩代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> stringDecryptFunc </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">compact</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>无意间翻看代码的时候，灵光一现，解密函数调用的这么频繁，我直接把所有函数都遍历一遍，并将它们的引用<code>referencePaths</code>从高到低排序，不就知道那个是解密函数了吗，于是便有了<code>findDecFunctionArr</code>方法</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"finddecfunctionarr\">findDecFunctionArr<a class=\"hash-link\" href=\"#finddecfunctionarr\" title=\"标题的直接链接\">​</a></h4><p>一般而言，解密函数通常是在大数组与数组乱序后定义的，在上面代码中，可以看到是通过制定下标来定位解密函数 <code>this.ast.program.body[2];</code>，所以只要能截取到这个 2 即可，具体代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/**</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   * 根据函数调用次数寻找到解密函数</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">   */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">findDecFunction</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> decFunctionArr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> index </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 定义解密函数所在语句下标</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 先遍历所有函数(作用域在Program)，并根据引用次数来判断是否为解密函数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token string\" style=\"color:#a6e22e\">'FunctionDeclaration|VariableDeclarator'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isFunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isFunctionExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 调用超过100次多半就是解密函数,具体可根据实际情况来判断</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">100</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              decFunctionArr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据最后一个解密函数来定义解密函数所在语句下标</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> parent </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">findParent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> _p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isFunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> _p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isVariableDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> body </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">block</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> node </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">start</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">start</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  index </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 遍历完当前节点,就不再往子节点遍历</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">skip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 插入解密函数前的几条语句</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">program</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">slice</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> index</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 把这部分的代码转为字符串，由于可能存在格式化检测，需要指定选项，来压缩代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">compact</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将字符串形式的代码执行，这样就可以在 nodejs 中运行解密函数了</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    global</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">eval</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">decFunctionArr</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> decFunctionArr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同时增加 decFunctionArr 属性，用于表示解密函数数组供 decStringArr 使用，就可以免去判断解密函数的步骤了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优化还原后的代码\">优化还原后的代码<a class=\"hash-link\" href=\"#优化还原后的代码\" title=\"标题的直接链接\">​</a></h2><p>就此，还原后的代码基本就能静态分析出大概，接下来都是对这份代码进行细微的优化还原。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"对象属性-改为对象属性\">对象<!-- -->['属性']<!-- --> 改为对象.属性<a class=\"hash-link\" href=\"#对象属性-改为对象属性\" title=\"标题的直接链接\">​</a></h3><p>与混淆对象属性相反，但其实没必要，只是代码相对而言好看一点，影响不大。具体代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">changeObjectAccessMode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">MemberExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isStringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">property</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">property</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">property</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">computed</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"还原为-boolean\">还原为 Boolean<a class=\"hash-link\" href=\"#还原为-boolean\" title=\"标题的直接链接\">​</a></h3><p>在还原后的代码还存在<code>!![]</code>与 <code>![]</code>或者是<code>!0</code>与<code>!1</code>，而这对应 js 中也就是<code>true</code>与<code>false</code>，所以也可以遍历这部分的代码，然后将其还原成 Boolean，像这种表达式就不细说了（有点类似 jsfuck），ast 结构自行分析。具体代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverseUnaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">UnaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">operator</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'!'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 避免判断成 void</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 判断第二个符号是不是!</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isUnaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isArrayExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// !![]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">elements</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                            path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">booleanLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                            path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">skip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isArrayExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ![]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">elements</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">booleanLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">skip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isNumericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// !0 or !1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">booleanLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">argument</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">booleanLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"计算二项式字面量\">计算二项式字面量<a class=\"hash-link\" href=\"#计算二项式字面量\" title=\"标题的直接链接\">​</a></h3><p>还原后的代码中还存在<code>[\"constructor\"](\"debu\" + \"gger\")[\"call\"](\"action\");</code>这样的语句，其中<code>debugger</code> 特意给拆分成两部分，而这同样可以通过 ast 来进行还原成完整字符串，同样类似的 <code>1 + 2</code> 这种字面量 都可以合并。还原程序代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">traverseLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">BinaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> left</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> right </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 判断左右两边是否为字面量</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">left</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> confident</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">evaluate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 计算二项式的值</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    confident </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">skip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中 confident 表示是否为可计算，比如说一个变量 + 1，由于程序不知道这变量此时的值，所以就不可计算，confident 也就是为 false。</p><p>同时这个计算二项式字面量可以还原一些相对简单的混淆，比方说数字异或混淆 <code>706526 ^ 706516</code>计算为 10 就可以直接替换原节点。所以这步的遍历需要相对其他还原提前一些。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"字符串和数值常量直接替换对应的变量引用地方\">字符串和数值常量直接替换对应的变量引用地方<a class=\"hash-link\" href=\"#字符串和数值常量直接替换对应的变量引用地方\" title=\"标题的直接链接\">​</a></h3><p>有些变量可能赋值过一次就不在进行改变，就如同常量，如下面代码。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">100</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>那么完全可以替换成<code>console.log(100)</code> ，最终输出的效果一样，但是前提是 a 只赋值过一次，也可以说 a 必须要是变量，否则这样还原是有可能导致原有执行结果失败，而通过 binding 就能查看变量 a 的赋值历史。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverseStrNumValue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#a6e22e\">'AssignmentExpression|VariableDeclarator'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _initValue </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isAssignmentExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">left</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _initValue </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    _initValue </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isStringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_initValue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isNumericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_initValue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binding </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">constant</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">constantViolations</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                            binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">_initValue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"移除无用变量与无用代码块\">移除无用变量与无用代码块<a class=\"hash-link\" href=\"#移除无用变量与无用代码块\" title=\"标题的直接链接\">​</a></h3><p>上面说了有些字符串与数值常量替换，针对是只赋值过一遍的变量，但还可能存在变量未使用过的情况，遇到这种情况，我们可以判断 constantViolations 成员是否为空，然后将其删除。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">removeUnusedValue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">VariableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> init </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isObjectExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">binding </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">constantViolations</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">remove</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">binding </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">constantViolations</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">referencePaths</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">remove</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同时还有一些无用代码块，比如</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'123'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Math</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">floor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">10</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Math</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">random</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>第二条语句是绝对不会执行到的，那么就可以将其移除。虽然说代码编辑器会将其标暗，表示不会执行到，但在混淆中巴不得代码量少一下，所有还是有必要通过 AST 进行操作。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">removeUnusedBlockStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">IfStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isBooleanLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> testValue </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">testValue </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceInline</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">consequent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">testValue </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceInline</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">alternate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>虽然说这种只针对 if 条件为 Boolean，如果条件为<code>if(1===1)</code>的情况也是可以，因为在前面还原中 计算二项式字面量，就已经将<code>if(1===1)</code> 替换成了 <code>if(true)</code>，所以这里只需要判断<code>isBooleanLiteral</code>即可。最终还原后的结果会将 if 代码块去除，同时保留 BlockStatement，代码如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">function test() {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    return \"123\";</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">test();</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"添加注释\">添加注释<a class=\"hash-link\" href=\"#添加注释\" title=\"标题的直接链接\">​</a></h3><p>有些关键的代码会隐藏在 debugger，setTimeout，setInterval 等，在调试的时候都需要额外注意下是否有关键代码，所以这时候就可以添加一个注释来进行添加一个标签如 TOLOOK 来进行定位。具体根据要指定的标识符来定位，下列代码做为演示，将会在这些地方添加注释 // TOLOOK</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">addComments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">DebuggerStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addComment</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'leading'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">' TOLOOK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">CallExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'setTimeout'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'setInterval'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">includes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">callee</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addComment</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'leading'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">' TOLOOK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">StringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'debugger'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addComment</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'leading'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">' TOLOOK'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"十六进制与-unicode-编码转正常字符\">十六进制与 Unicode 编码转正常字符<a class=\"hash-link\" href=\"#十六进制与-unicode-编码转正常字符\" title=\"标题的直接链接\">​</a></h3><p>在一开始还原的时候就调用过这个方法，不过这里要特意在说一遍，因为这套混淆十六进制是最后处理，也就是说我们一开始直接使用还原是没问题的，但如果加密的字符串中存在十六进制编码字符，而这步操作确实在解密字符串前的话，那么可能就有部分字符串还是以十六进制形式显示，所有把这个方法特意放到较后文的地方，同时这个方法也可以最后调用。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">hexUnicodeToString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">StringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> curNode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">delete</span><span class=\"token plain\"> curNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extra</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">NumericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> curNode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token keyword\" style=\"color:#66d9ef\">delete</span><span class=\"token plain\"> curNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extra</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"标识符优化\">标识符优化<a class=\"hash-link\" href=\"#标识符优化\" title=\"标题的直接链接\">​</a></h3><p>大部分的混淆标识符都为<!-- -->_<!-- -->0x123456 这种，但有些却很另类，比如 OOOO0o 这种，相比前面这种更容易看花眼，很容易看错代码，那么就可以将标识符都统一重命名一下。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">renameIdentifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newAst </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#a6e22e\">'Program|FunctionExpression|FunctionDeclaration'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                        path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">rename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">generateUidIdentifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'_0xabc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">ast</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> newAst</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但想知道源代码的标识符是根本不可能的，所以就无法通过代码语义来理解代码了。</p><p>不过还有一些可以特定的替换，比如 for i</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> _0x1e5665 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> _0x3620b9 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'JIyEgF'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'length'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x1e5665 </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> _0x3620b9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> _0x1e5665</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'JIyEgF'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'push'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Math</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'round'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Math</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'random'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  _0x3620b9 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'JIyEgF'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'length'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>像这种代码，就完全可以将<code>_0x1e5665</code>替换成<code>i</code>，不过对整体阅读影响基本不大。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他还原手段\">其他还原手段<a class=\"hash-link\" href=\"#其他还原手段\" title=\"标题的直接链接\">​</a></h3><p>还有一些还原的手段就不细说了（这里例子中并未用到），比如说</p><ul><li>形参改为实参</li><li>还原 switch 执行流程</li><li>处理对象花指令</li><li>处理 eval 代码</li></ul><p>等等，总之你想咋优化都完全可以优化，但还原完的代码就不一定能看懂了。与解密字符串那个相比，如果搞不定字符串解密，那这些都是徒劳。</p><p>具体的实例可通过 <a href=\"https://github.com/kuizuo/js-de-obfuscator/tree/main/example/deobfuscator\" target=\"_blank\" rel=\"noopener noreferrer\">源码例子</a> 中查看对 AST 的操作。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"运行还原后的代码\">运行还原后的代码<a class=\"hash-link\" href=\"#运行还原后的代码\" title=\"标题的直接链接\">​</a></h2><p>最终整个还原后的代码可以在<code>newCode.js</code>中查看，但到目前为止还没有测试还原后的代码到底能否正常运行，或者是替换节点导致语法错误，所有就需要将还原后的代码与混淆过的代码替换运行这样才能测试的出来。这里就不放具体执行过程了（因为真的懒得在处理这个 js 文件了。。。）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"js-混淆与还原的网站\">JS 混淆与还原的网站<a class=\"hash-link\" href=\"#js-混淆与还原的网站\" title=\"标题的直接链接\">​</a></h2><p>针对上述还原操作其实还不够明显，于是就编写了一个在线对 JS 代码混淆与还原的网站（主要针对还原）– <a href=\"https://deobfuscator.kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">JS 代码混淆与还原 (kuizuo.cn)</a></p><p>其实也就是对上述的还原代码进行封装成工具使用。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/js-code-deobfuscator",
            "title": "JS代码之还原",
            "summary": "基于 Babel 对 JS 代码进行混淆与还原操作的网站 JS 代码混淆与还原 (kuizuo.cn)",
            "date_modified": "2021-12-25T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "ast",
                "reverse",
                "project"
            ]
        },
        {
            "id": "js-code-obfuscator",
            "content_html": "<blockquote><p>AST 在线解析 <a href=\"https://astexplorer.net/\" target=\"_blank\" rel=\"noopener noreferrer\">AST explorer</a></p><p>js 在线混淆工具 <a href=\"https://www.obfuscator.io/\" target=\"_blank\" rel=\"noopener noreferrer\">JavaScript Obfuscator Tool</a></p><p>书籍 《反爬虫 AST 原理与还原混淆实战》</p><p>相关混淆代码 <a href=\"https://github.com/kuizuo/js-de-obfuscator\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/js-de-obfuscator</a></p><p>自写在线混淆与还原网站 <a href=\"http://deobfuscator.kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">JS 代码混淆与还原 (kuizuo.cn)</a></p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"什么是-ast\">什么是 AST<a class=\"hash-link\" href=\"#什么是-ast\" title=\"标题的直接链接\">​</a></h2><p>抽象语法树（Abstract Syntax Tree），简称 AST，初识 AST 是在一门网页逆向的课程，该课程讲述了 js 代码中混淆与还原的对抗，而所使用的技术便是 AST，通过 AST 能很轻松的将 js 源代码混淆成难以辨别的代码。同样的，也可以通过 AST 将其混淆的代码 还原成执行逻辑相对正常的代码。</p><p>例如下面的代码（目的是当天时间格式化）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">format</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">formatStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> str </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> formatStr</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Week</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'日'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'一'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'二'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'三'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'四'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'五'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'六'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  str </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">yyyy|YYYY</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getFullYear</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  str </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">MM</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getMonth</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">padStart</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  str </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> str</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replace</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">dd|DD</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getDate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">padStart</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> str</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">format</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'yyyy-MM-dd'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>通过 AST 混淆的结果为</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'eXl5eS1NTS1kZA=='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'RGF0ZQ=='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'cHJvdG90eXBl'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Zm9ybWF0'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5pel'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5LiA'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5LqM'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5LiJ'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5Zub'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5LqU'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'5YWt'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'cmVwbGFjZQ=='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Z2V0RnVsbFllYXI='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Z2V0TW9udGg='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'dG9TdHJpbmc='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'cGFkU3RhcnQ='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'MA=='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Z2V0RGF0ZQ=='</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'bG9n'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> </span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token function-variable function maybe-class-name\" style=\"color:#e6db74\">OOOOOo</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">while</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">--</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">shift</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">OOOOOo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">115918</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">115930</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">694578</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">694578</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">873625</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">873624</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">219685</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">219687</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOO00</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> </span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOO0O</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">945965</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">945966</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">298561</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">298565</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">535455</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">535450</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">193006</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">193000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">577975</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">577968</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">428905</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">428897</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">629582</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">629575</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">607437</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">607431</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">yyyy|YYYY</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">799010</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">799017</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">518363</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">518353</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">MM</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token constant\" style=\"color:#e6db74\">OOOO00</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">862531</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">862543</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">671347</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">671346</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">822457</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">822452</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">974597</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">974603</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">741860</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">741862</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">544174</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">544161</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">406915</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">406921</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">dd|DD</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">596004</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">596020</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">705321</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">705316</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">419232</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">419246</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">318456</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">318458</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">662337</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">662350</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">OOOOOo</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">490983</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">490998</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">116866</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">116866</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">386287</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">386285</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">530189</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">530207</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>将上述代码复制到浏览器控制台内执行，将会输出当天的年月日。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ast-有什么用\">AST 有什么用<a class=\"hash-link\" href=\"#ast-有什么用\" title=\"标题的直接链接\">​</a></h3><p>除了上述的混淆代码，很多文本编辑器中也会使用到，例如：</p><ul><li>编辑器的错误提示、代码格式化、代码高亮、代码自动补全；</li><li><code>elint</code>、<code>pretiier</code> 对代码错误或风格的检查；</li><li><code>webpack</code> 通过 <code>babel</code> 转译 <code>javascript</code> 语法；</li></ul><p>不过本篇并非介绍 AST 的基本概念，看本篇你只需要知道<strong>如何通过 babel 编译器生成 AST 并完成上述的混淆操作</strong>即可。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"有必要学-ast-吗\">有必要学 AST 吗<a class=\"hash-link\" href=\"#有必要学-ast-吗\" title=\"标题的直接链接\">​</a></h3><p>如果作为 JS 开发者并且想要深入了解 V8 编译，那么 AST 基本是必修课之一，像 Vue,React 主流的前端框架都使用到 AST 对代码进行编译，在 ast 学习中定能让你对 JS 语法有一个更深入的了解。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ast-误区\">AST 误区<a class=\"hash-link\" href=\"#ast-误区\" title=\"标题的直接链接\">​</a></h3><p>AST 本质上是静态分析，静态分析是在不需要执行代码的前提下对代码进行分析的处理过程，与动态分析不同，静态分析的目的是多种多样的， 它可用于语法检查，编译，代码高亮，代码转换，优化，压缩等等场景。即便你的程序也许在运行时报错，但都不会影响 AST 解析（除非语法错误），在 js 逆向中，通过静态分析还原出相对容易看的出的代码有对于代码分析，而对于一些需要知道某一变量执行后的结果静态分析是做不到的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"环境安装\">环境安装<a class=\"hash-link\" href=\"#环境安装\" title=\"标题的直接链接\">​</a></h2><p>首先需要 Node 环境，这就不介绍了，其次工具 Babel 编译器可通过 npm 安装</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i @babel/core -S-D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>安装代码提示</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i @types/node @types/babel__traverse @types/babel__generator -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>新建 js 文件，导入相关模块（也可使用 ES module 导入），大致代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> fs </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'fs'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> parser </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/parser'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> traverse </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/traverse'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> t </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/types'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> generator </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/generator'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jscode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">readFileSync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">__dirname </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/demo.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">encoding</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"utf-8\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 解析为AST</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ast </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 转化特征代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 生成转化后的代码</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>babel 的编译过程主要有三个阶段</p><ol><li>解析(Parse): 将输入字符流解析为 AST 抽象语法树</li><li>转化(Transform): 对抽象语法树进一步转化</li><li>生成(Generate): 根据转化后的语法树生成目标代码</li></ol><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ast-的-api\">AST 的 API<a class=\"hash-link\" href=\"#ast-的-api\" title=\"标题的直接链接\">​</a></h2><p>在进行编译前，首先需要了解 Babel 的一些相关 API，这边所选择的是 babel/parser 库作为解析，还有一个在线 ast 解析网站<a href=\"https://astexplorer.net/\" target=\"_blank\" rel=\"noopener noreferrer\">AST explorer</a> 能帮助我们有效的了解 AST 中的树结构。</p><p>同时 Babel 手册(中文版) <a href=\"https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/plugin-handbook.md\" target=\"_blank\" rel=\"noopener noreferrer\">babel-handbook</a>强烈建议反复阅读，官方的例子远比我所描述来的详细。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211212151620278.png\" alt=\"image-20211212151620278\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"例子\">例子<a class=\"hash-link\" href=\"#例子\" title=\"标题的直接链接\">​</a></h3><p>这边就举一个非常简单的例子，混淆变量名（或说标识符混淆）感受一下。引用网站代码例子</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/**</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * Paste or drop some JavaScript here and explore</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * the syntax tree created by chosen parser.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * You can use all the cool new features from ES6</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * and even more. Enjoy!</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> tips </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">\"Click on any AST node with a '+' to expand it\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Hovering over a node highlights the \\</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">   corresponding location in the source code'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Shift click on an AST node to expand the whole subtree'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">printTips</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tips</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">tip</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Tip </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">i</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">:</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> tip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>比如说，我要将这个 tips 标识符更改为<code>_0xabcdef</code> ，那么肯定是需要找到这个要 tips，在 Babel 中要找到这个则可以通过遍历特部位（如函数表达式，变量声明等等）。</p><p>鼠标点击这个 tips 查看 tips 变量在树节点中的节点。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211212170832228.png\" alt=\"image-20211212170832228\" class=\"img_ev3q\"></p><p>这边可以看到有两个蓝色标记的节点，分别是<code>VariableDeclaration</code>和<code>VariabelDeclarator</code>，翻译过来便是变量声明与变量说明符，很显然整个<code>let tips = [ ]</code> 是<code>VariableDeclaration</code>，而<code>tips</code>则是<code>VariabelDeclarator</code>。</p><p>所以要将<code>tips</code>更改为<code>_0xabcdef</code>就需要遍历<code>VariabelDeclarator</code>并判断属性<code>name</code>是否为<code>tips</code>，大致代码如下。<strong>（后文代码将会省略模块引入、js 代码读取、解析与生成的代码）</strong></p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> fs </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'fs'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> parser </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/parser'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> traverse </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/traverse'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> t </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/types'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> generator </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@babel/generator'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jscode </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> fs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">readFileSync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">__dirname </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/demo.js'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">encoding</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'utf-8'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ast </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jscode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">VariableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'tips'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getOwnBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">rename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'_0xabcdef'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>生成的代码如下，成功的将<code>tips</code>更改为<code>_0xabcdef</code>，并且是<code>tips</code>的所有作用域（printTips 函数下）都成功替换了。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">/**</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * Paste or drop some JavaScript here and explore</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * the syntax tree created by chosen parser.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * You can use all the cool new features from ES6</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> * and even more. Enjoy!</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\"> */</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _0xabcdef </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"Click on any AST node with a '+' to expand it\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Hovering over a node highlights the \\</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">   corresponding location in the source code\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> \"</span><span class=\"token maybe-class-name\">Shift</span><span class=\"token plain\"> click on an </span><span class=\"token constant\" style=\"color:#e6db74\">AST</span><span class=\"token plain\"> node to</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">expand the whole subtree\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">printTips</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  _0xabcdef</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">tip</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Tip </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">i</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">:</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> tip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>简单描述下上述代码的过程</p><p>1、遍历所有<code>VariableDeclarator</code>节点，也就是<code>tips</code>变量说明符（标识符）</p><p>2、获取当前遍历到的标识符的 name，也就是<code>path.node.id.name</code>，在树节点是对应的也是<code>id.name</code></p><p>3、判断 name 是否等于 tips，是的话，通过<code>path.scope.getOwnBinding(name)</code>，获取当前标识符（tips）的作用域，scope 的意思就是作用域，如果只是赋值操作的话如<code>path.node.id.name = '_0xabcdef'</code>，那只修改的<code>let tips =</code> 的 tips，而后面的对 tips 进行<code>forEach</code>操作的 tips 并不会更改，所以这里才需要使用<code>binding</code>来获取 tips 的作用域，并调用提供好的<code>rename</code>方法来进行更改。</p><p>4、调用<code>binding.scope.rename(name, '_0xabcdef')</code>，将旧名字 name（tips）更改为<!-- -->_<!-- -->0xabcdef，就此整个遍历就结束，此时的 ast 已经发生了变化，所以只需要根据遍历过的 ast 生成代码便可得到修改后的代码。</p><p>如果在仔细观察的话，其实<code>Identifier</code>（标识符）也是蓝色表示的，说明<code>Identifier</code>也同样可以遍历，甚至比上面的效果更好（后续替换所有的标识符也是遍历这个）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'tips'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getOwnBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">rename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'_0xabcdef'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>并尝试输出所有的标识符，输出的 name 结果为</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tips</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">printTips</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">_0xabcdef</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">forEach</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tip</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">i</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">console</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">log</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">i</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tip</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这个例子也许有点啰嗦，但我认为是有必要的，同时想说的是某种混淆（还原）的实现往往可以有好几种方法遍历，会懂得融会贯通，AST 混淆与还原才能精通。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"parser-与-generator\">parser 与 generator<a class=\"hash-link\" href=\"#parser-与-generator\" title=\"标题的直接链接\">​</a></h3><p>前者用于将 js 代码解析成 AST，后者则是将 AST 转为 js 代码，两者的具体参数可通过 babel 手册查看，这就不做过多介绍了。</p><p><a href=\"https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md#babel-parser\" target=\"_blank\" rel=\"noopener noreferrer\">babel-handbook #babel-parser</a></p><p><a href=\"https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/plugin-handbook.md#babel-generator\" target=\"_blank\" rel=\"noopener noreferrer\">babel-handbook #babel-generator</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"traverse-与-visitor\">traverse 与 visitor<a class=\"hash-link\" href=\"#traverse-与-visitor\" title=\"标题的直接链接\">​</a></h3><p>整个 ast 混淆还原最关键的操作就是遍历，而 visitor 则是根据特定标识（函数声明，变量订阅）来进行遍历各个节点，而非无意义的全部遍历。</p><p>traverse 一共有两个参数，第一个就是 ast，第二个是 visitor，而 visitor 本质是一个对象如下(分别有 JavaScript 和 TypeScript 版本，区别就是在于这样定义的 visitor 是否有代码提示)</p><div class=\"tabs-container tabList__CuJ\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs\"><li role=\"tab\" tabindex=\"0\" aria-selected=\"true\" class=\"tabs__item tabItem_LNqP tabs__item--active\">JS</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LNqP\">TS</li></ul><div class=\"margin-top--md\"><div role=\"tabpanel\" class=\"tabItem_Ymn6\"><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> visitor </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出函数名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div><div role=\"tabpanel\" class=\"tabItem_Ymn6\" hidden=\"\"><div class=\"language-tsx codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-tsx codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> visitor</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Visitor</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出函数名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div></div></div><p>一般来说，都是直接写到写到 traverse 内。个人推荐这种写法，因为能有 js 的代码提示，如果是 TypeScript 效果也一样。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出函数名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果我想遍历函数声明与二项式表达式的话，还可以这么写</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'FunctionDeclaration|BinaryExpression'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> node </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isFunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出函数名 printTips</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isBinaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">operator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出操作符 +</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过要遍历不同类型的代码，那么对应的 node 属性肯定大不相同，其中这里使用了 t（也就是<code>@babel/types</code>库）来进行判断 node 节点是否为该属性，来进行不同的操作，后文会提到 types。</p><p>上述操作将会输出 <code>printTips</code> 与 <code>+</code> 因为 printTips 函数中代码有 <code>Tip ${i}: + tip</code> ，这就是一个二项式表达式。</p><p>此外 visitor 中的属性中，还对应两个生命周期函数 enter(进入节点)和 exit(退出节点)，可以在这两个周期内进行不同的处理操作，演示代码如下。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">FunctionDeclaration</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">enter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'进入函数声明'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">exit</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'退出函数声明'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中 enter 与 exit 还可以是一个数组（当然基本没怎么会用到），比如</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">FunctionDeclaration</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">enter</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'2'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>path 对象下还有一种方法，针对当前 path 进行遍历 <code>path.traverse</code>，比如下面代码中，我遍历到了 printTips，我想输出函数内的箭头函数中的参数，那么就可以使用这种遍历。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">printTips</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  tips</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">tip</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Tip </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">i</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">:</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> tip</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此时的 path.traverse 的第一个参数便不是 ast 对象了，而是一个 visitor 对象</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ArrowFunctionExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">params</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>输出的结果如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">[</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  Node {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    type: 'Identifier',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    start: 40,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    end: 43,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    loc: SourceLocation {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      start: [Position],</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      end: [Position],</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      filename: undefined,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      identifierName: 'tip'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    },</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    name: 'tip'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  },</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  Node {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    type: 'Identifier',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    start: 45,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    end: 46,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    loc: SourceLocation {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      start: [Position],</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      end: [Position],</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      filename: undefined,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      identifierName: 'i'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    },</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    name: 'i'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"types\">types<a class=\"hash-link\" href=\"#types\" title=\"标题的直接链接\">​</a></h3><p>该库主要的作用是判断节点类型与生成新的节点。判断节点类型上面已经演示过了，比如判断 node 节点是否是为标识符<code>t.isIdentifier(path.node)</code>，等同于<code>path.node.type === \"Identifier\"</code></p><p>判断节点类型是很重要的一个环节，有时候混淆需要针对很多节点进行操作，但并不是每个节点都有相同的属性，判断节点才不会导致获取到的节点属性出错，甚至可以写下面的代码（将输出所有函数声明与箭头函数的参数）。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">traverse(ast, {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  enter(path) {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    t.isFunctionDeclaration(path.node) &amp;&amp; console.log(path.node.params)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    t.isArrowFunctionExpression(path.node) &amp;&amp; console.log(path.node.params)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">})</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>types 的主要用途还是构造节点，或者说写一个 Builders（构建器），例如我要生成 <code>let a = 100</code> 这样的变量声明原始代码，通过 types 能轻松帮我们生成。</p><p>不过先别急着敲代码，把<code>let a = 100</code>代码进行 ast 解析，看看每个代码的节点对应的 type 都是什么，这样才有助于生成该代码。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211216131627955.png\" alt=\"image-20211216131627955\" class=\"img_ev3q\"></p><p>body 内的第一个节点便是我们整条的代码，输入<code>t.variableDeclaration()</code>，鼠标悬停在 variableDeclaration 上，或者按 Ctrl 跳转只.d.ts 类型声明文件 查看该方法所需几个参数</p><div class=\"language-ts codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-ts codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">declare</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">variableDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">kind</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'var'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'let'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'const'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> declarations</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">Array</span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">VariableDeclarator</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> VariableDeclaration</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以看到第一个参数就是关键字，而第二个则一个数组，其中节点为<code>VariableDeclarator</code>，关于<code>variableDeclaration</code>与 <code>VariableDeclarator</code> 在前面已经提及过一次了，就不在赘述了。由于我们这里只是声明一个变量 a，所有数组成员只给一个便可，如果要生成 b，c 这些变量，就传入对应的<code>VariableDeclarator</code>即可</p><p>这时候在查看下 VariableDeclarator 方法参数</p><div class=\"language-ts codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-ts codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">declare</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">variableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> LVal</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> init</span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> Expression </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> VariableDeclarator</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>第一个参数 id 很显然就是标识符了，不过这里的 id 不能简简单单传入一个字符串 a，而需要通过<code>t.identifier('a')</code>生成该节点，在上图中 id 就是对应<code>Identifier</code>节点。然后就是第二个参数了，一个表达式，其中这个<code>Expression</code>是 ts 中的联合类型（Union Types），可以看到有很多表达式</p><div class=\"language-ts codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-ts codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">declare</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">type</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Expression</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ArrayExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> AssignmentExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> BinaryExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> CallExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ConditionalExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> FunctionExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> Identifier</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> StringLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> NumericLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> NullLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> BooleanLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> RegExpLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> LogicalExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> MemberExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> NewExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ObjectExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> SequenceExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ParenthesizedExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ThisExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> UnaryExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> UpdateExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ArrowFunctionExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ClassExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> MetaProperty</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> Super</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TaggedTemplateExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TemplateLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> YieldExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> AwaitExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> Import</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> BigIntLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> OptionalMemberExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> OptionalCallExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TypeCastExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> JSXElement</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> JSXFragment</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> BindExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> DoExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> RecordExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TupleExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> DecimalLiteral</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> ModuleExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TopicReference</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> PipelineTopicExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> PipelineBareFunction</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> PipelinePrimaryTopicReference</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TSAsExpression</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TSTypeAssertion</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">|</span><span class=\"token plain\"> TSNonNullExpression</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中我们所要赋值的数值 100，对应的节点类型<code>NumericLiteral</code>也在其中。在查看 numericLiteral 中的参数，就只给一个数值，那么便传入 100。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">declare function numericLiteral(value: number): NumericLiteral;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最后整个代码如下，将 t.variableDeclaration 结果赋值为一个变量<code>var_a</code>，这里的 var_a 便是一个 ast 对象，通过 generator(var_a).code 就可以获取到该 ast 的代码，也就是 <code>let a = 100;</code>，默认还会帮你添加分号</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> var_a </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">variableDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'let'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">variableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'a'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">100</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">var_a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// let a = 100;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这边再列举一个生成函数声明代码的例子（不做解读），要生成的代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">x</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> y</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> x </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> y</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>types 操作</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> param_x </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'x'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> param_y </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'y'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> func_b </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">functionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'b'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">param_x</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> param_y</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">blockStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">returnStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">binaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'+'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> param_x</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> param_y</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">func_b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>大致步骤可以总结成一下几点</p><p>1、将要生成的 js 代码进行 ast Explorer 查看树结构，理清所要构造的代码节点（很重要）</p><p>2、找到最顶层的结果，如 variableDeclaration，查看该代码所对应的参数</p><p>3、进一步的分析内层节点结构，构造出最终的原始代码。</p><p>types 还有一个方法<code>valueToNode</code>，先看演示</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> arr_c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">arr_c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ArrayExpression'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">elements</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果使用<code>numericLiteral</code>来生成这些字面量的话那要写的话代码可能就要像下面这样</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> arr_c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">arrayExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">numericLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>而<code>valueToNode</code>能很方便地生成各种基本类型，甚至是一些对象类型（RegExp，Object 等）。不过像函数这种就不行。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">x</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> y</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> x </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> y</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// throw new Error(\"don't know how to turn this value into a node\");</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>写到着，其实不难发现，每个 node 节点其实就是一个 json 对象，而 types 只是将其封装好方法，供使用者调用，像下面这样方式定义 arr_c，同样也能生成数组 <!-- -->[1, 2, 3, 4, 5]</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> arr_c </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ArrayExpression'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">elements</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'NumericLiteral'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> code </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">arr_c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>至于生成其他的语句，原理与上述一致，篇幅有限不在做其他例子演示了，Babel 中的 API 很多，最主要的是懂得善用手册与代码提示，没有什么生成不了的语句，更没有还原不了的代码。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"path\">Path<a class=\"hash-link\" href=\"#path\" title=\"标题的直接链接\">​</a></h3><p>上述讲了基本的库操作，不难发现，使用到最多的还是 traverse，并且都会传入一个参数 path，并且<code>path.node</code>使用到的频率很多，能理解请两个的区别（Node 与 NodePath），基本上你想遍历到的地方就没有遍历不到的。</p><p>先说说 path 能干嘛，能停止遍历当前节点 （<code>path.stop</code>），能跳过当前节点（<code>path.skip</code>），还可以获取父级 path（<code>path.parentPath</code> ），替换当前节点（<code>path.replaceWith</code>），移除当前节点（<code>path.remove</code>）等等。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"获取-node-节点属性\">获取 Node 节点属性<a class=\"hash-link\" href=\"#获取-node-节点属性\" title=\"标题的直接链接\">​</a></h4><p><strong><code>path.node</code></strong> 也就是当前节点所在的 Node 对象，比如<code>loc</code>、<code>id</code>、<code>init</code>，<code>param</code>、<code>name</code>等，这些都是在 node 对象下都是能直接获取到的。</p><p>不过获取到的是 node 对象，就无法使用 path 对象的方法了，如果要获取该属性的 path，就可以使用<code>path.get('name')</code>，获取到的就是 path 对象。不过对于一些特定的属性（name，operator）获取 path 对象就多此一举了。</p><p>一共有两种类型 <code>Node</code> 与 <code>NodePath</code>，记住有<code>Path</code>则是<code>path</code>，如<code>path</code>就属于<code>NodePath</code>，而<code>path.node</code> 属于<code>Node</code>。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211213021420326.png\" alt=\"image-20211213021420326\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"将节点转为代码\">将节点转为代码<a class=\"hash-link\" href=\"#将节点转为代码\" title=\"标题的直接链接\">​</a></h4><p>有时候遍历到一系列的代码，想输出一下原始代码，那么有以下两种方式。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"替换节点属性\">替换节点属性<a class=\"hash-link\" href=\"#替换节点属性\" title=\"标题的直接链接\">​</a></h4><p>与获取节点属性相同，比如我需要修改函数的第一个参数，那么我只要获取到第一个参数，并且将值赋值为我想修改值（node 对象）便可。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">params</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'x'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"替换整个节点\">替换整个节点<a class=\"hash-link\" href=\"#替换整个节点\" title=\"标题的直接链接\">​</a></h4><p>替换的相关方法有</p><p><code>replaceWith</code> 一对一替换当前节点，且严格替换。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>replaceWithMultiple</code> 则是一对多，将多个节点替换到一个节点上。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ReturnStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWithMultiple</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">expressionStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">callExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">memberExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'console'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">returnStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stop</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>要注意的是，替换节点要非常谨慎，就比如上述代码，如果我遍历 return 语句，同时我又替换成了 return 语句，替换后的节点同样是可以进入到遍历里，如果不进行停止，将会造成死循环，所以这里才使用了<code>path.stop</code>完全停止当前遍历，直到下一条 return 语句。</p><p><code>path.skip()</code>跳过遍历当前路径的子路径。<code>path.stop()</code>完全停止当前遍历</p><p><code>relaceInline</code> 接收一个参数，如果不为数组相当于<code>replaceWith</code>，如果是数组相当于<code>replaceWithMultiple</code></p><p><code>replaceWithSoureString</code> 该方式将字符串源码与节点进行替换，例如</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 要替换的函数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">FunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWithSourceString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">function mult(a, b){</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">      return a * b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    }</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stop</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 替换后的结果</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// (function mult(a, b) {</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   return a * b;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// });</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"删除节点\">删除节点<a class=\"hash-link\" href=\"#删除节点\" title=\"标题的直接链接\">​</a></h4><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">EmptyStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">remove</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>EmptyStatement</code>指空语句，也就是多余的分号。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"插入节点\">插入节点<a class=\"hash-link\" href=\"#插入节点\" title=\"标题的直接链接\">​</a></h4><p><code>insertBefore</code>与<code>insertAfter</code>分别在当前节点前后插入语句</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ReturnStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">insertBefore</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">expressionStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'before'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">insertAfter</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">expressionStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'after'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"父级-path\">父级 path<a class=\"hash-link\" href=\"#父级-path\" title=\"标题的直接链接\">​</a></h4><p><strong><code>path.parent</code></strong> 表示父级的 node</p><p><strong><code>path.parentPath</code></strong> 表示父级的 path，也就是 NodePath</p><p><code>path.parentPath.node</code> === <code>path.parent</code> 两者效果一样，都是获取 Node 对象。</p><p>此外还有一些方法也可以获取父级 Path</p><p><strong><code>path.findParent</code></strong> 向上遍历每一个父级 Path 并根据条件返回，与数组 find 方式类型。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">BinaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> parent </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">findParent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> p</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isFunctionDeclaration</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">toString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong><code>path.find</code></strong> 与 findParent 方式类似，不过 find 方法不包括当前节点，而 findParent 不包括。</p><p><strong><code>path.getFunctionParent</code></strong> 向上查找与当前节点最接近的父函数，返回的是 Path 对象。</p><p><strong><code>path.getStatementParent</code></strong> 遍历语法树，直到找到语句节点（带有 Statement），如 return 语句（ReturnStatement），if 语句（IfStatement），块级语句（BlockStatement）</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"同级-path\">同级 path<a class=\"hash-link\" href=\"#同级-path\" title=\"标题的直接链接\">​</a></h4><p>path 有一个属性 container，表示当前节点所处于的那个节点下，共有那些同级节点，而 listKey 表示容器名。key 表示索引或是是容器对象的属性名</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ReturnStatement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">listKey</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">container</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出结果</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">body</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ReturnStatement'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">24</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">36</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">loc</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">SourceLocation</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">filename</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">identifierName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">argument</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'BinaryExpression'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">31</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">36</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">loc</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">SourceLocation</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">left</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">operator</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'+'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">right</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 ast 树结构中框中所表示</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211216200502122.png\" alt=\"image-20211216200502122\" class=\"img_ev3q\"></p><p>也并不是说所有节点都有同级节点，也并不是所有的 container 都是一个数组，例如下面这个例子</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> obj </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">init</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'VariableDeclarator'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">30</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">loc</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">SourceLocation</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Position</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">line</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">column</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Position</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">line</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">column</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">filename</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">identifierName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Identifier'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">loc</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">SourceLocation</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">filename</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">identifierName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'obj'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'obj'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">init</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ObjectExpression'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">10</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">30</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">loc</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">SourceLocation</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">start</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">end</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">filename</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">identifierName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">properties</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>对应 AST 树结构中所框选</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211216201242257.png\" alt=\"image-20211216201242257\" class=\"img_ev3q\"></p><p>也就是说该节点并没有同级节点</p><p>其中关于同级节点有以下几种方法。</p><p><code>path.inList</code> 判断 container 属性是否为数组</p><p><code>path.getSibling(index)</code> 获取当前节点所在容器中索引对应的同级节点，index 可通过 path.key 获取。</p><p>其中还有<code>unshiftContainer</code>与<code>pushContainer</code>，在容器前与后添加节点，与<code>Array.unshift</code>和<code>Array.push</code>方法类似，不过基本没怎么用过，便不做实例了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"scope\">Scope<a class=\"hash-link\" href=\"#scope\" title=\"标题的直接链接\">​</a></h3><p><strong><code>path.scope</code></strong> 字面名意思为作用域，可以方便查找标识符的引用。如当前变量的哪里被调用了，标识符为参数还是变量。</p><p>演示代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> obj </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> obj</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"获取标识符代码块\">获取标识符代码块<a class=\"hash-link\" href=\"#获取标识符代码块\" title=\"标题的直接链接\">​</a></h4><p><code>scope.block</code> 返回 Node 对象，使用方法分为两种情况，变量与函数。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ObjectExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> block </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">block</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">block</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// function test() {</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   let obj = {</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//     name: 'kuizuo'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   };</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   return obj;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// }</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>返回的是整个函数体代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">ObjectExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> block </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">block</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">generator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">block</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// function test() {</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   let obj = {</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//     name: 'kuizuo'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   };</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//   return obj;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// }</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>由于<code>scope.block</code>返回的是 Node 对象，将就无法使用 path.toString()转为原始代码了。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"binding\">binding<a class=\"hash-link\" href=\"#binding\" title=\"标题的直接链接\">​</a></h4><p><strong><code>scope.getBinding()</code></strong> 接收一个参数，可用于获取标识符的绑定，这里的 binding 可能会有些抽象，在一开始的例子中初次接触到</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">VariableDeclarator</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'tips'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binding </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getOwnBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      binding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">rename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'_0xabcdef'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中这里的 binding 是属性相对较多，下面会一一介绍</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token maybe-class-name\">Binding</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">identifier</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Node</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Identifier'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'tips'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">scope</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">ref </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Scope</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">path</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">NodePath</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">kind</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'let'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">constantViolations</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">constant</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">referencePaths</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token maybe-class-name\">NodePath</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">referenced</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">references</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">hasDeoptedValue</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">hasValue</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>要注意的是，getBinding 中传的值必须是当前节点能够引用到的标识符，如果当前标识符不存在，那么返回 undefined。</p><p>identifier 是标识符 tips 的 Node 的对象，path 则是标识符 Path 对象，constant 为布尔值，表示当前标识符是否为常量，referenced 表示当前节点是否被引用。references 表示引用的次数。</p><p>binding 中的 scope 等同于 path 中的 scope，作用域范围相同。</p><p><strong><code>scope.getOwnBinding()</code></strong> 获取当前节点下的绑定，不包含其他父级中定义的标识符，会包含子函数中定义的标识符绑定。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"referencepaths-与-constantviolations\">referencePaths 与 constantViolations<a class=\"hash-link\" href=\"#referencepaths-与-constantviolations\" title=\"标题的直接链接\">​</a></h4><p>假如标识符被引用，referencePaths 中会存放所有引用该标识的 path 对象数组。像下面这样</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token literal-property property\" style=\"color:#f92672\">referencePaths</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token maybe-class-name\">NodePath</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">contexts</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">state</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Object</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">opts</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Object</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">_traverseFlags</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">skipKeys</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">parentPath</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">NodePath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">container</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">listKey</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">key</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'object'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">node</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Identifier'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">parent</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">hub</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword nil\" style=\"color:#66d9ef\">undefined</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">context</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">TraversalContext</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">scope</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token maybe-class-name\">Scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>而 constantViolations 则是存放所有修改标识符的 Path 对象。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"标识符重命名\">标识符重命名<a class=\"hash-link\" href=\"#标识符重命名\" title=\"标题的直接链接\">​</a></h4><p>这在一开始的例子中就简单介绍过了，使用的是 rename 方法，能将该标识符中所有引用的地方重命名，不过上面的例子只是重命名 tips，想要重命名所有标识符的话，就需要遍历 Identifier。不过重命名标识符不能都重命名为相同字符，有一个 api <code>path.scope.generateUidIdentifier</code> 用于生成唯一不重复标识符。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Identifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">rename</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">scope</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">generateUidIdentifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'_0xabcdef'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最终生成的代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token operator\" style=\"color:#66d9ef\">**</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">Paste</span><span class=\"token plain\"> or drop some </span><span class=\"token maybe-class-name\">JavaScript</span><span class=\"token plain\"> here and explore</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> the syntax tree created by chosen parser</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">You</span><span class=\"token plain\"> can use all the cool </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">features</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">ES6</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> and even more</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\"> </span><span class=\"token property-access maybe-class-name\">Enjoy</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _0xabcdef11 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"Click on any AST node with a '+' to expand it\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Hovering over a node highlights the \\</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string\" style=\"color:#a6e22e\">   corresponding location in the source code\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Shift click on an AST node to expand the whole subtree\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_0xabcdef2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  _0xabcdef11</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">_0xabcdef10</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> _0xabcdef9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">Tip </span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">_0xabcdef9</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">:</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> _0xabcdef10</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>scope.hasBinding('a')</code> 查询是否有标识符 a 的绑定</p><p><code>scope.getAllBindings()</code> 获取当前节点下所有绑定，返回一个对象，以标识符名作为属性名，值为 binding。</p><p><code>scope.hasReference('a')</code> 查询当前节点是否有标识符 a 的引用。</p><p>当然大部分的 api 还需要自行翻阅文档，或通过代码提示与动态调试查看方法，举一反三，来达到所想要的目的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"混淆实战\">混淆实战<a class=\"hash-link\" href=\"#混淆实战\" title=\"标题的直接链接\">​</a></h2><p>关于混淆实战的代码都已贴到 Github<a href=\"https://github.com/kuizuo/AST-obfuscator\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/AST-obfuscator</a>，在<code>src/obfuscated</code>中便可看到完整的混淆程序。其中也包括一些实战还原的例子，大部分的写法都采用了 ES6 的类来写，方便编写理解。</p><p>大部分混淆的例子在这本书《反爬虫 AST 原理与还原混淆实战》中都有，例如常量混淆，数组混淆与乱序，标识符混淆等等就不细说了，上传的代码中有，不过书中有一些 es6 的代码是没提及到的。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"模板字符串\">模板字符串<a class=\"hash-link\" href=\"#模板字符串\" title=\"标题的直接链接\">​</a></h3><p>与<code>StringLiteral</code>不同，模板字符串的 type 是<code>TemplateLiteral</code>，所以是遍历不到模板字符串的。下文将用代码来实现将模板字符串转为字符串拼接</p><p>演示代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation\">a</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">nb</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation number\" style=\"color:#ae81ff\">12</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string string\" style=\"color:#a6e22e\">3</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">${</span><span class=\"token template-string interpolation string\" style=\"color:#a6e22e\">'456'</span><span class=\"token template-string interpolation interpolation-punctuation punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>分析 AST 树结构</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211217161958075.png\" alt=\"image-20211217161958075\" class=\"img_ev3q\"></p><p>不难观察出，parser 将其成两部分<code>expressions</code>与<code>quasis</code>。而所要转为的最终代码应该是<code>'' + a + 'nb' + 12 + '3' + '456'+ ''</code>，并且<code>quasis</code>成员个数始终比<code>expressions</code>多一位，所以只需要将<code>expressions</code>插入置<code>quasis</code>成员内，然后通过 binaryExpression 进行拼接即可。大致的思路有了，那么就开始用代码来进行拼接。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">TemplateLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> expressions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> quasis </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 将expressions节点逐个插入到quasis节点上</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> i </span><span class=\"token keyword\" style=\"color:#66d9ef\">in</span><span class=\"token plain\"> expressions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> e </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> expressions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      quasis</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">splice</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">i </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newExpressions </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> quasis</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 循环新的表达式节点构造出二项式表达式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> binary</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> newExpressions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> binary</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> right </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> newExpressions</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">i </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">raw</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        binary </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> left</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">continue</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isTemplateElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// if (right.value.raw === '') continue</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        right </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueToNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">raw</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      binary </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">binaryExpression</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'+'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> left</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> right</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">replaceWith</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">binary</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最终输出 <code>\"\" + a + \"nb\" + 12 + \"3\" + \"456\" + \"\"</code></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"类声明\">类声明<a class=\"hash-link\" href=\"#类声明\" title=\"标题的直接链接\">​</a></h3><p>同样，类名与类方法名同样也是可以混淆的，演示代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Test</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  age </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">20</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">constructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> name</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">age</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> test </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'kuizuo'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>复制上述代码，观察 AST 树结构（图就不放了）</p><p>不难发现，其实就是 type <code>ClassDeclaration</code>、<code>ClassProperty</code>、<code>ClassMethod</code>，通过标识符混淆的方法<code>renameIdentifier</code>，将<code>Program|FunctionExpression|FunctionDeclaration</code>新增这两个 type 即可</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'Program|FunctionExpression|FunctionDeclaration|ClassDeclaration|ClassProperty|ClassMethod'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">renameOwnBinding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但混淆完的代码并没有把属性名与方法名给混淆到</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  age </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">399100</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">399080</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">constructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">226019</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">226019</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">OOOOO0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">255772</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">255772</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token function\" style=\"color:#e6db74\">atob</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token constant\" style=\"color:#e6db74\">OOOOOO</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">982314</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">^</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">982315</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>不过这样混淆肯定远远不够的，方法可是类中很重要的属性，同时类方法与属性还能这么编写（constructor 不行），然后将下面的代码通过混淆程序执行一遍就能成功混淆变量名。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Test</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'age'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">20</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">constructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> name</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'run'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">age</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>所以将<code>run()</code> 转为<code>[‘run’]()</code>便成为了关键。而实现起来也相对简单（与改变对象访问方式一样）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">traverse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ast</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'ClassProperty|ClassMethod'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isIdentifier</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'constructor'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">key</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringLiteral</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    path</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">computed</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最终运行混淆程序，执行混淆后的代码，成功输出<code>kuizuo20</code></p><hr><p>后续有时间再补充。。。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"混淆心得\">混淆心得<a class=\"hash-link\" href=\"#混淆心得\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"混淆前提\">混淆前提<a class=\"hash-link\" href=\"#混淆前提\" title=\"标题的直接链接\">​</a></h3><p><strong>不改变原有代码的执行过程与结果</strong>，并不是随便混淆都行了，比如<code>let c = a + b</code> ，总不能混淆成 <code>let OO = Oo - oO</code>吧。其次要懂得利用 js 语法的特性来进行混淆，比如高阶函数，函数传参，jsfuck 等等。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"混淆并非万能\">混淆并非万能<a class=\"hash-link\" href=\"#混淆并非万能\" title=\"标题的直接链接\">​</a></h3><p>混淆始终是混淆，只是将代码相对变得难以阅读，但不代表不可阅读。只要程序能运行，那么我就能调试，能调试还能有什么解决不了的（毕竟 bug 都是调试出来）。如果真想保全你的代码，那我的建议是编译成二进制文件，或采用远程调用的形式将执行后的结果返回。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码执行效率\">代码执行效率<a class=\"hash-link\" href=\"#代码执行效率\" title=\"标题的直接链接\">​</a></h3><p>通常来说，混淆会使你的代码数量增大至 2,3 倍，与加密壳同理，但程序的执行速度也会稍慢下，当然只要不是特别 ex 的混淆，如将函数调用封装至，3,4 层的调用导致调用堆栈过大，那么这种执行效率基本可以忽略不计。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"有混淆就有还原\">有混淆就有还原<a class=\"hash-link\" href=\"#有混淆就有还原\" title=\"标题的直接链接\">​</a></h3><p>既然混淆是通过 AST 来进行混淆的，那么还原也同样可以，不过还原就不可能还原出原始开发者所编写的，就如同一些打包工具打包后的代码，比如将 name 压缩成 n，age 压缩成 a，那么就无法推断出 n 为 name，a 为 age，而混淆也是同理，像代码<code>let OOOOOO = atob('a3VpenVv')</code>，能还原的也只能是<code>let OOOOOO = ‘kuizuo’</code>或者是将标识符重新命名<code>let _0x123456 = ‘kuizuo’</code>，相对好看些。大部分的还原工作都只是将代码变得好读一些，比如<code>atob('a3VpenVv')</code>就可以变为<code>‘kuizuo’</code>，这便是基本的还原之一，关于还原还会另出一篇文章来记录，就不在这多废笔舌了。</p><p>整个混淆的过程来看，无非就是多了门技能，对 js 有了更进一步的了解，略懂 js 编译过程中的语法分析，此外也感叹 Babel 提供如此强大的 api。同时也能尝试使用最新的 ECMAScript 语法特性，无需考虑兼容问题，babel 统统都能处理。就如同 babel 官网所说的：</p><p><strong>现在就开始使用下一代 JavaScript 语法吧</strong>。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/js-code-obfuscator",
            "title": "JS代码之混淆",
            "summary": "AST 在线解析 AST explorer",
            "date_modified": "2021-12-21T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "ast",
                "reverse",
                "project"
            ]
        },
        {
            "id": "js-function-hook",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>我在阅读《JavaScript 设计模式与开发实践》的第 15 章 装饰者模式，突然发现 JS 逆向中 hook 函数和 js 中的装饰者模式有点像，仔细阅读完全篇后更是对装饰器与 hook 有了更深的理解于是便有了这篇文章来记录一下该操作。</p><p>hook 直译的意思为钩子，在逆向领域通常用来针对某些参数，变量进行侦听，打印输出，替换等操作。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"正文\">正文<a class=\"hash-link\" href=\"#正文\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"示例代码\">示例代码<a class=\"hash-link\" href=\"#示例代码\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"hook-代码\">hook 代码<a class=\"hash-link\" href=\"#hook-代码\" title=\"标题的直接链接\">​</a></h3><p>这是一个很简单加法函数，通过 Hook 能获取到这两个参数的值，相当于在 return 之前添加了一句代码<code>console.log(a,b)</code>，这样便能输出这两个的值便于分析。那么可以使用如下的方式来复写改函数，而这个方式在 javascript 也就是装饰者模式</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> add</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> result </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 如果不需要result 则可直接return _add()</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>完整代码</strong></p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> add</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> result</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>再次调用<code>add(1,2)</code>便会输出 arguments 参数以及结果 3，一个很简单 HOOK 就实现了。</p><p>不过这个例子可能过于简单，我所要表达的意思是，通过 Hook，定位到我们想 Hook 的函数与变量，通过一系列操作（函数复写，元编程），只要触发该函数或使用（取值，修改）该变量，便能将我们想要的结果（前后的结果（如 加密前，加密后））获取到。这才是我们的目的。</p><p>书中给的例子想说明的，想为某个原函数(比如这里的 add)添加一些功能，但该原函数可能是由其他开发者所编写的，那么直接修改原函数本身将可能导致未知 BUG，于是便可以用上面的方式进行复写原函数的同时，还不破坏原函数。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"this-指向问题\">this 指向问题<a class=\"hash-link\" href=\"#this-指向问题\" title=\"标题的直接链接\">​</a></h3><p>但并不是什么函数都能这样操作，或者说这样操作会导致原本函数可能执行不了，比如 this 指向，虽说没有修改原函数，但是原函数的 this 已经给我们更改成当前环境下（如<code>window</code>），但有些函数比如<code>document.getElementById()</code> 的内部<code>this</code>指向为<code>document</code>，不妨尝试将下面代码直接复制到控制台中查看会报什么错</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _getElementById </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">getElementById</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function-variable function\" style=\"color:#e6db74\">getElementById</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">_getElementById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> div </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getElementById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'div'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>报错:</strong></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Uncaught TypeError: Illegal invocation</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at getElementById (&lt;anonymous&gt;:4:9)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    at &lt;anonymous&gt;:7:11</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>解决办法:</strong></p><p>只需要将 this 指向设置为 document 即可，代码改写如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> _getElementById </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">getElementById</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function-variable function\" style=\"color:#e6db74\">getElementById</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> _getElementById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> div </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getElementById</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'div'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但这样做略显麻烦，且有些函数你可能都不知道 this 的指向，但又想要复写该函数，书中也提及到用 <strong>AOP 装饰函数</strong></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"用-aop-装饰函数\">用 AOP 装饰函数<a class=\"hash-link\" href=\"#用-aop-装饰函数\" title=\"标题的直接链接\">​</a></h3><p>先给出 <code>Function.prototype.before</code> 和 <code>Function.prototype.after</code>方法</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token class-name\" style=\"color:#e6db74\">Function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">before</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">beforefn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> __self </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    beforefn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> __self</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token class-name\" style=\"color:#e6db74\">Function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">after</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">afterfn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> __self </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ret </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> __self</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    afterfn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">ret</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> ret</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>注：这里 after 与书中略有不同，书中的是将<code>arguments</code> 传入<code>afterfn.apply(this, arguments)</code>，而我的做法则是将运行后的结果传入 <code>afterfn.apply(this, [ret])</code></p><p>那么将我们一开始的加法例子便可以替换为</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> b</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> b</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> add</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">before</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">after</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 切记 这里不能写箭头函数 不然会指向的不是执行中的this 而是代码环境下的this</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// arguments Arguments(2)&nbsp;[1, 2, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// result 3</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>注：这种装饰方式叠加了函数的作用域，如果装饰的链条过长，性能上也会受到一定的影响</p></div></div><p>但该方法是直接修改原型方法，有些不喜欢污染原型的方式（用原型方式是真的好写），那么做一些变通，将原函数和新函数作为参数传入，代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:#e6db74\">before</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">fn</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> beforefn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    beforefn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> fn</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>add 函数修改如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">before</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同样也能达到所要的目的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"写后感\">写后感<a class=\"hash-link\" href=\"#写后感\" title=\"标题的直接链接\">​</a></h2><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function-variable function\" style=\"color:#e6db74\">add</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> _add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">apply</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> result</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">add </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> add</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">before</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'arguments'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> arguments</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">after</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'result'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>对比两者方法，前者是对函数进行替换，而后者通过函数原型链将参数与结果通过回调函数的形式进行使用。在不考虑 this 指向，我个人更偏向第一种写法，而第二种写法也确实让我眼前一亮，很巧妙的使用 js 的原型链，从而避免 this 指向的问题。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/js-function-hook",
            "title": "JS函数hook",
            "summary": "前言",
            "date_modified": "2021-11-22T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "hook"
            ]
        },
        {
            "id": "remote-call-browser-function",
            "content_html": "<p>早闻 RPC（Remote Procedure Call）远程过程调用，这一词了，应该是在安卓逆向的时候听闻的，当时吹嘘的意思是这样的，通过另一个远端服务器来调用安卓代码中的函数，并将执行后的结果返回。比如有一个加密算法，如果要实现脱机（脱离当前环境）运行的话，就需要扣除相对应的代码，补齐对应的环境（模块，上下文，语言），然而要在补齐该加密算法的环境可不好实现，而通过 RPC 则可以免除扣代码，通过数据通信来达到远程调用的目的，听起来是挺牛逼的，实际上也确实挺骚的。这里我将以浏览器与本地搭建一个 websocket 来实现调用浏览器内的函数。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"算法例子\">算法例子<a class=\"hash-link\" href=\"#算法例子\" title=\"标题的直接链接\">​</a></h2><p>这里我所采用的是百度登录的密码加密算法，具体逆向实现就不细写了，借用视频教程<a href=\"https://www.bilibili.com/video/BV1Kh411r7uR?p=36\" target=\"_blank\" rel=\"noopener noreferrer\">志远 2021 全新 js 逆向 RPC</a></p><p>通过关键词<code>password:</code> 便可找到对应的加密地点，找到加密调用的函数所出现的位置（loginv5.js 8944 行），发现通过调用<code>e.RSA.encrypt(s)</code>（其中 s 为明文 <code>a123456</code>），便可得到加密后的结果。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008042148653.png\" alt=\"image-20211008042148653\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008041300534.png\" alt=\"image-20211008041300534\" class=\"img_ev3q\"></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">e.RSA.encrypt(s)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">'Zhge9q9jkiMA0UTfHxwNeyafnuUG8rcAh/gKfQpZiOQq8EYI/tJO83lKr52c4Im3cew3wVcINf2jEGEqH5EimnMI3g6eOjcdqduGyqynA4JjMJ0wltGdL8VUTTJsknsHUQlJXHOm/7zqx4NaBvOzhWzdDBk5cAOJ2DXgPaqoygg='</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>按照往常的做法，需要将<code>e.RSA.encrypt(s)</code>所用的代码处单独抠出来，放在 V8 引擎上测试或使用现有的加密库 如 CryptoJS，找到对应的密钥来进行加密。不过这里使用 RPC 来实现该算法的调用。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实现\">实现<a class=\"hash-link\" href=\"#实现\" title=\"标题的直接链接\">​</a></h2><p>目前调用的环境有了（浏览器环境），只要我们这个浏览器不停止（使用无头浏览器运行），控制台便能一直输出我们想要的加密后结果。所以要实现的目的很简单，就是其他窗口（指其他语言所实现的程序），能远程调用<code>e.RSA.encrypt(s)</code>并将结果输出到其他窗口。</p><p>那么就需要建立通信协议了，这里我所采用的是浏览器自带的 Websocket 客户端与 Nodejs 搭建的 Websocket 服务端来进行通信，众所周知 HTTP 请求是无法双向传输的。所以使用 websocket 这样服务端就可以主动向浏览器发送请求，同时 websocket 在当前这个环境下好实现。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nodejs-实现-websocket-服务端\">Nodejs 实现 Websocket 服务端<a class=\"hash-link\" href=\"#nodejs-实现-websocket-服务端\" title=\"标题的直接链接\">​</a></h3><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-ws-模块\">安装 ws 模块<a class=\"hash-link\" href=\"#安装-ws-模块\" title=\"标题的直接链接\">​</a></h4><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install ws -S</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install @types/ws -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里之所以选 ws，是因为 ws 对于 Websocket 协议而已，实现方便，且速度最快，并且浏览器可以通过<code>let ws = new Websocket()</code>来创建客户端直接连接，而使用 socket.io 的话，浏览器则需要载入 socket.io 客户端文件，繁琐。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码例子\">代码例子<a class=\"hash-link\" href=\"#代码例子\" title=\"标题的直接链接\">​</a></h4><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">WebSocket</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">WebSocketServer</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ws'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocketServer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">port</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8080</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'connection'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'接受到的msg: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> msg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'我接受到你的数据: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> msg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>使用 WebSocket 在线测试网站<a href=\"http://www.websocket-test.com/\" target=\"_blank\" rel=\"noopener noreferrer\">websocket 在线测试 (websocket-test.com)</a></p><p>测试结果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008043925753.png\" alt=\"image-20211008043925753\" class=\"img_ev3q\"></p><p>上面代码写的很简陋，尤其是数据交互的地方，这里可以使用 json 来改进一下。像这样，至于为啥用 try 是防止 json 数据不对导致解析错误（具体代码就不解读了）</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">WebSocket</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">WebSocketServer</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ws'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocketServer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">port</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8080</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'connection'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'有人连接了'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> json </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// data: {\"type\":\"callbackPasswordEnc\",\"value\":\"a123456\"}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'callbackPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// doSomething()</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'得到的加密密文为:'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 浏览器通信1秒后向浏览器调用加密算法</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">setTimeout</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jsonStr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'getPasswordEnc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'a123456'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"浏览器实现-websocket\">浏览器实现 websocket<a class=\"hash-link\" href=\"#浏览器实现-websocket\" title=\"标题的直接链接\">​</a></h3><p>既然要实现我们的代码，那么就需要将我们的代码注入到原来的代码上，这里我使用的是 Chrome 的开发者工具中的覆盖功能，选择一个本地文件夹，并允许权限。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008054918531.png\" alt=\"image-20211008054918531\" class=\"img_ev3q\"></p><p>选择要替换代码的文件，选择保存以备替换（前提得开启覆盖）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008055032125.png\" alt=\"image-20211008055032125\" class=\"img_ev3q\"></p><p>接着在覆盖中找到文件，找到加密的代码块，添加如下代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">browser.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> url </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ws://127.0.0.1:8080'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 浏览器连接后告诉服务端是浏览器</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onopen</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'isBrowser'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onmessage</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> json </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'getPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> passwordEnc </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token constant\" style=\"color:#e6db74\">RSA</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">encrypt</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jsonStr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'callbackPasswordEnc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> passwordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008201809446.png\" alt=\"image-20211008201809446\" class=\"img_ev3q\"></p><p>然后就是最关键的地方了，触发加密函数，并将结果返回。触发加密函数只需要向浏览器发送指定数据<code>{\"type\":\"getPasswordEnc\",\"value\":\"a123456\"}</code>，浏览器接受到对应的类型与数据，便调用相应的函数，并将结果<code>{\"type\":\"callbackPasswordEnc\",\"value\":\"FM6SK3XiL5X0RF9NZi7qhIsu7Pd46mfKnn6YkWUNSGrJO+XXhiXyoG8huaqQW4BnmYuo0JVVQj28C+BK/r6NTNbLcV4gMSREB2hYU/oIYedCJsZ9sbZQ89p1aI9kVcDeRlXBhjNUxkcS9Rh+vKzyNApwpbPcAuGTCSZhKst8vVo=\"}</code>返回即可。</p><p>服务端的效果如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211008204247104.png\" alt=\"image-20211008204247104\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"优化执行流程\">优化执行流程<a class=\"hash-link\" href=\"#优化执行流程\" title=\"标题的直接链接\">​</a></h2><p>实现是实现了，但是代码貌似很不优雅，甚至有点别扭。按理来说因为是浏览器作为 websocket 服务端，我们作为客户端，客户端向服务器获取数据才合理，但在这里浏览器当不了 websocket 服务端这个角色，所以只能使用如此别扭的方式来调用。像上面例子的话，如果我的程序要实现一个某度登录的话，那么我这个程序就需要搭建一个 ws 服务器来进行两者的通信，有没有好的办法又不太依赖于 ws 服务端，就像 http 那样，程序只需要发送一个请求，给定类型和数值进行加密处理后返回即可。于是我处理的思路是这样的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"思路\">思路<a class=\"hash-link\" href=\"#思路\" title=\"标题的直接链接\">​</a></h2><p>我的做法是将 websocket 服务端当个中转站，而浏览器的 websocket 客户端作为一个加密算法的服务，再添加一个登录算法实现的客户端简称为用户调用的，所以现在一共有三份代码（websocket 服务端，浏览器端，用户调用端）。这里我还是以 nodejs 为例。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"浏览器端\">浏览器端<a class=\"hash-link\" href=\"#浏览器端\" title=\"标题的直接链接\">​</a></h3><p>浏览器 websocket 客户端的代码，在初次连接的时候，告诉 websocket 服务端是不是浏览器。并将于浏览器连接的 socket 句柄存入全局对象，以便用户获取加密参数的时候向浏览器调用。</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">browser.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onopen</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'isBrowser'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"用户调用端\">用户调用端<a class=\"hash-link\" href=\"#用户调用端\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">client.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">WebSocket</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ws'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getPasswordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">resolve</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'ws://127.0.0.1:8080'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'open'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jsonStr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'getPasswordEnc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> json </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'callbackPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">close</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token function\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> passwordEnc </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getPasswordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'a123456'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">passwordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里对代码进行解读一下，我自行封装了一个函数，其中函数返回的是一个 Promise 对象，值则是对应的加密后的密文。如果我这边不采用 promise 来编写的话，那么获取到的数据将十分不好返回给我们的主线程。这里对于 js 的 Promise 使用需要花费点时间去理解。总而言之，通过 promise，以及 async await 语法糖，能很轻松的等待 websocket 连接与接收数据。但还是用 websocket 协议</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"websocket-服务端\">websocket 服务端<a class=\"hash-link\" href=\"#websocket-服务端\" title=\"标题的直接链接\">​</a></h3><p>同时 websocket 服务端肯定要新增一个类型用于判断是登录算法实现的客户端。同时又新的用户要调用，所以这里使用了 uuid 这个模块来生成唯一的用户 id，同时还定义一个变量 clients 记录所连接过的用户（包括浏览器），完整代码如下</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">WebSocket</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">WebSocketServer</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ws'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> v4 </span><span class=\"token imports keyword module\" style=\"color:#66d9ef\">as</span><span class=\"token imports\"> uuidv4 </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'uuid'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocketServer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">port</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8080</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> browserWebsocket </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> clients </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'connection'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> client_id </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">uuidv4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  clients</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> client_id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">socket</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'close'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> clients</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">clients</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> client_id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        clients</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">splice</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> json </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'isBrowser'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            browserWebsocket </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> socket</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'浏览器已初始化'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 发送给浏览器 让浏览器来调用并返回</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'callbackPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据id找到调用用户的socket,并向该用户发送加密后的密文</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> temp_socket </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> clients</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">socket</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          temp_socket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 用户发送过来要加密的明文</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'getPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jsonStr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> client_id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 这里一定要是浏览器的websocket句柄发送，才能调用</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          browserWebsocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>最终演示效果如下视频（浏览器代码是提前注入进去的）</p><video width=\"800px\" height=\"450px\" controls=\"\"><source id=\"mp4\" src=\"https://img.kuizuo.cn/rpc.mp4\" type=\"video/mp4\"></video><p>其实还是一些是要完善的，这里的 Websocket 只是实现了连接，还有心跳包异常断开，浏览器异常关闭导致 websocket 断开无法调用函数等等，以及浏览器的代码还需要手动注入很不优化，后续如果使用 Chrome 插件开发一个实现注入 js 代码的功能也许会好一些。（正准备编写 Chrome 插件）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"http-协议调用实现\">HTTP 协议调用实现<a class=\"hash-link\" href=\"#http-协议调用实现\" title=\"标题的直接链接\">​</a></h2><p>但是，以上都是基于 WebSocket 协议，就连用户端调用也是，然而用户调用没必要保持长连接且不利于调用（相对一些语言而言），有没有能直接使用 http 协议，通过 POST 请求来实现获取参数，这才是我所要实现的。</p><p>其实要实现也很简单，我只要把用户调用的 <code>getPasswordEnc</code> 这个函数 弄到 node 创建的一个 http 服务端就行了，我这里的做法也是如此。像下面这样</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">server_http.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getPasswordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">resolve</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> ws </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">WebSocket</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'ws://127.0.0.1:8080'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'open'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> jsonStr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'getPasswordEnc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">send</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsonStr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">on</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> json </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> value </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'callbackPasswordEnc'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          ws</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">close</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token function\" style=\"color:#e6db74\">resolve</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 创建http服务</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> app </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createServer</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">request</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> pathname</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> query </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">pathname </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/getPasswordEnc'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> passwordEnc </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getPasswordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">query</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">password</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">end</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">passwordEnc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">app</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">listen</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">8000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">服务已运行 http://127.0.0.1:8000/</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>发送 GET 请求 URL 为 <a href=\"http://127.0.0.1:8000/getPasswordEnc?password=a123456\" target=\"_blank\" rel=\"noopener noreferrer\">http://127.0.0.1:8000/getPasswordEnc?password=a123456</a> 实现效果如图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20211009040704534.png\" alt=\"image-20211009040704534\" class=\"img_ev3q\"></p><p>对于用户调用来说相对友好了不少（其实是很好），不用在创建 websocket 客户端，只需要发送 HTTP 请求（GET 或 POST），不过我这边使用的是 Node 自带的 http 模块来搭建的一个 http 服务器，实际使用中将会采用 express 来编写路由提高开发效率和代码可读性，这里只是作为演示。</p><p>至于说我为什么要在 http 内在新建一个 ws 客户端，主要原因还是 websocket 服务端向浏览器发送调用的算法，但只能在 websocket 服务端中的通过 onmessage 接受，无法在 http 服务端接受到，就别说向用户端返回了。这里其实只是不让用户来进行连接 websocket，而是我们本地（服务器）在接受到 getPasswordEnc 请求，复现了一遍上面用户连接 websocket 的例子，并将其转为 http 请求返回给用户而已。</p><p><strong>其实也就是多了一个调用的 HTTP 服务器，而这里将 http 服务器与 websocket 服务器写到一起而已</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码地址\">代码地址<a class=\"hash-link\" href=\"#代码地址\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://github.com/kuizuo/rpc-browser.git\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/kuizuo/rpc-browser.git</a></p><p>运行方式请查看 README.md</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/remote-call-browser-function",
            "title": "RPC远程调用浏览器函数",
            "summary": "早闻 RPC（Remote Procedure Call）远程过程调用，这一词了，应该是在安卓逆向的时候听闻的，当时吹嘘的意思是这样的，通过另一个远端服务器来调用安卓代码中的函数，并将执行后的结果返回。比如有一个加密算法，如果要实现脱机（脱离当前环境）运行的话，就需要扣除相对应的代码，补齐对应的环境（模块，上下文，语言），然而要在补齐该加密算法的环境可不好实现，而通过 RPC 则可以免除扣代码，通过数据通信来达到远程调用的目的，听起来是挺牛逼的，实际上也确实挺骚的。这里我将以浏览器与本地搭建一个 websocket 来实现调用浏览器内的函数。",
            "date_modified": "2021-10-09T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "rpc",
                "browser"
            ]
        },
        {
            "id": "thinkphp-deploy",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"事情背景\">事情背景<a class=\"hash-link\" href=\"#事情背景\" title=\"标题的直接链接\">​</a></h2><p>用户花了几百块购买了一份 ThinkPHP 一个后台管理的网站源码，要求更换下部分失效接口，或是重写一个类似这样的网站。我想既然都有源码了，我改改不就完事了，这不比重写一个来的省事。虽说我不是主学 PHP 的，但至少我学过一丢丢的 PHP，接触过 ThinkPHP 项目的。不过层面都是局限在本地，部署到生产环境与本地还是有比较大的差别的，于是便有了这篇文章来记录一下自己部署 ThinkPHP 所遇到的一些坑。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"windows-部署\">Windows 部署<a class=\"hash-link\" href=\"#windows-部署\" title=\"标题的直接链接\">​</a></h2><p>也可理解为本地部署，本地部署就相对比较简单的了。不过需要一个工具，PHPStudy，来帮助我们配置本地的环境（Apache、Nginx、PHP、Mysql）</p><p><a href=\"https://www.xp.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">小皮面板(phpstudy) - 让天下没有难配的服务器环境！ (xp.cn)</a></p><p>下载安装打开界面，选择网站，创建网站</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925143601530.png\" alt=\"image-20210925143601530\" class=\"img_ev3q\"></p><p>由于是本机，所以域名就填写 localhost 或 127.0.0.1，端口的话这边所填写的是 4200，别和其他端口冲突即可。</p><p>由于 ThinkPHP 的根目录要选择的是根目录下的 public 目录，不然找不到 index.php 这个文件，所以这里根目录自己指定一下源码的位置，点击确认即可。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"初次启动-not-found\">初次启动 Not Found<a class=\"hash-link\" href=\"#初次启动-not-found\" title=\"标题的直接链接\">​</a></h3><p>这时候访问 http://localhost:4200 提示如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925143752775.png\" alt=\"image-20210925143752775\" class=\"img_ev3q\"></p><p>本着不会就百度的原则，很快就找到了解决办法</p><p><a href=\"https://blog.csdn.net/qq_42940241/article/details/112461625\" target=\"_blank\" rel=\"noopener noreferrer\">ThinkPHP 报错 The requested URL /index/index/xxx.html was not found on this server</a></p><p>在入口文件夹 public 下查看.htaccess 是否存在。不存在则新建，存在的话，那内容替换为下面这串代码 就可以解决 Not Fund 问题</p><div class=\"language-xml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-xml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">IfModule</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">mod_rewrite.c</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#  Options +FollowSymlinks -Multiviews</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#  RewriteEngine On</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#  RewriteCond %{REQUEST_FILENAME} !-d</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#  RewriteCond %{REQUEST_FILENAME} !-f</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#  RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">IfModule</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">IfModule</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">mod_rewrite.c</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">RewriteEngine on</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">RewriteCond %{REQUEST_FILENAME} !-d</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">RewriteCond %{REQUEST_FILENAME} !-f</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">RewriteRule ^(.*)$ index.php?/$1 [QSA,PT,L]</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">IfModule</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"页面报错-开启-debug\">页面报错 开启 Debug<a class=\"hash-link\" href=\"#页面报错-开启-debug\" title=\"标题的直接链接\">​</a></h3><p>上面配置完毕后，再次打开出现如下提示。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925144143248.png\" alt=\"image-20210925144143248\" class=\"img_ev3q\"></p><p>遇到错误是很正常的，现在要做的就是输出报错信息，而不是简短的文字。到根目录下 config/app.php 中，将调试更改为 true（切记，生产环境中一定要更改为 false，不然用户就能查看报错详情以及对应代码）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925144424361.png\" alt=\"image-20210925144424361\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置数据库\">配置数据库<a class=\"hash-link\" href=\"#配置数据库\" title=\"标题的直接链接\">​</a></h3><p>再次访问页面提示</p><p><strong><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925144620953.png\" alt=\"image-20210925144620953\" class=\"img_ev3q\"></strong></p><p>报错信息倒是很全，不过要关注的是报错行和提示，大致意思就是没有定义数据库用户名 ml 以及密码，毕竟数据库啥的都好像没配置，要是能启动起来那估计就真是一个 bug 了，那就先找到配置文件，看看原本的账号密码是多少，数据库配置文件位置<code>config/database.php</code></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925145740851.png\" alt=\"image-20210925145740851\" class=\"img_ev3q\"></p><p>不过 PHPstudy 用户名和密码长度都要在 6 位以上（Linux 倒是不用），所以勉为其难，把用户名和密码都改成 ml1234，接着 Mysql 导入源码给定的数据库文件(sql 文件)，什么，你说源码没有给数据库文件，那我建议直接删源码，并且接下来的内容也可以不用看了。</p><p>数据库导入完毕后，再次访问便能看到正常的首页了，就此就算部署完毕了，这里就不放首页图了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"linux-部署\">Linux 部署<a class=\"hash-link\" href=\"#linux-部署\" title=\"标题的直接链接\">​</a></h2><p>Linux 部署和 Windows 部署是有一丢丢差别的，这里我也列举一下，环境是 CentOS 7.6，安装了宝塔面板</p><p>在宝塔面板出网站，添加网站，如同 PHPstudy，配置大致相同。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210926050508693.png\" alt=\"image-20210926050508693\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"关闭防跨站攻击\">关闭防跨站攻击<a class=\"hash-link\" href=\"#关闭防跨站攻击\" title=\"标题的直接链接\">​</a></h3><p>情况 1，如图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925155027023.png\" alt=\"image-20210925155027023\" class=\"img_ev3q\"></p><p>解决办法：点击网站，设置，将防跨站攻击关闭并保持，如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925155445084.png\" alt=\"image-20210925155445084\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"设置伪静态\">设置伪静态<a class=\"hash-link\" href=\"#设置伪静态\" title=\"标题的直接链接\">​</a></h3><p>接着再次访问网站会出现 404 页面不存在报错，在设置中找到伪静态，添加一个 thinkphp 的配置，如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210925155705573.png\" alt=\"image-20210925155705573\" class=\"img_ev3q\"></p><p>再次访问后，出现的就是数据库配置的问题，配置一下数据库，导入数据，然后再次访问便可。</p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>再次提醒，生产环境下，请将<code>app_debug</code>设置为 false，不然非法用户可以通过人为试错，查询对应报错代码。</p></div></div>",
            "url": "https://onewhitethreee.github.io/examenEbau/thinkphp-deploy",
            "title": "记 ThinkPHP 项目部署",
            "summary": "事情背景",
            "date_modified": "2021-09-25T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "php",
                "develop"
            ]
        },
        {
            "id": "use-jsonpath-to-parse-json-data",
            "content_html": "<p>之前学习爬虫的时候，如果是 HTML 的数据，通过 xpath 或是 css 选择器，就能很快的获取我们想要的数据，如果是 json 有没有类似 xpath 这种，能够直接根据条件定位数据，而不需要自行 json 解析在遍历获取。答案是有的，也就是 JSONPath。</p><p>在线测试网址 <a href=\"https://www.jsonpath.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">JSONPath 在线验证</a></p><p>所选用的环境是 Node + JavaScript，用到 jsonpath 这个包 <a href=\"https://www.npmjs.com/package/jsonpath\" target=\"_blank\" rel=\"noopener noreferrer\">jsonpath - npm (npmjs.com)</a></p><blockquote><p>参考链接 <a href=\"https://www.jianshu.com/p/8c0ade82891b\" target=\"_blank\" rel=\"noopener noreferrer\">JsonPath - 根据表达式路径解析 Json - 简书 (jianshu.com)</a></p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"基本语法\">基本语法<a class=\"hash-link\" href=\"#基本语法\" title=\"标题的直接链接\">​</a></h2><table><thead><tr><th>JSONPath</th><th>描述</th></tr></thead><tbody><tr><td>$</td><td>根对象或元素.</td></tr><tr><td>@</td><td>当前对象或元素.</td></tr><tr><td>. or []</td><td>子元素操作符.</td></tr><tr><td>..</td><td>递归匹配所有子元素.</td></tr><tr><td>*</td><td>通配符. 匹配所有对象或元素.</td></tr><tr><td>[]</td><td>下标运算符，JsonPath 索引从 0 开始.</td></tr><tr><td>[,]</td><td>连接运算符，将多个结果拼成数组返回，JSONPath 允许使用别名.</td></tr><tr><td>[start:end1:step]</td><td>数组切片运算符.</td></tr><tr><td>?()</td><td>过滤器（脚本）表达式.</td></tr><tr><td>()</td><td>脚本表达式.</td></tr><tr><td>|<!-- -->|</td><td>表达式 或</td></tr><tr><td>&amp;&amp;</td><td>表达式 且</td></tr></tbody></table><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"过滤器表达式\">过滤器表达式<a class=\"hash-link\" href=\"#过滤器表达式\" title=\"标题的直接链接\">​</a></h3><p>通常的表达式格式为：<!-- -->[?(@.age &gt; 18)]<!-- --> 表示当前节点属性 age 大于 18</p><table><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td>==</td><td>等于符号，但数字 1 不等于字符 1(note that 1 is not equal to ‘1’)</td></tr><tr><td>!=</td><td>不等于符号</td></tr><tr><td>&lt;</td><td>小于符号</td></tr><tr><td>&lt;=</td><td>小于等于符号</td></tr><tr><td>&gt;</td><td>大于符号</td></tr><tr><td>&gt;=</td><td>大于等于符号</td></tr><tr><td>=~</td><td>判断是否符合正则表达式，例如<!-- -->[?(@.name =~ /foo.*?/i)]</td></tr><tr><td>in</td><td>所属符号，例如[?(@.size in <!-- -->[‘S’, ‘M’]<!-- -->)]</td></tr><tr><td>nin</td><td>排除符号</td></tr><tr><td>size</td><td>size of left (array or string) should match right</td></tr><tr><td>empty</td><td>判空 Null 符号</td></tr></tbody></table><p>语法就这些，不过单单有语法，不实践肯定是不够的。下面就是一些官方简单例子操作，还有一个终极实战</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"代码演示\">代码演示<a class=\"hash-link\" href=\"#代码演示\" title=\"标题的直接链接\">​</a></h2><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> jp </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'jsonpath'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> cities </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'London'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">population</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8615246</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Berlin'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">population</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3517424</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Madrid'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">population</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3165235</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Rome'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">population</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2870528</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> names </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> jp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">query</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cities</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$..name'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// [ \"London\", \"Berlin\", \"Madrid\", \"Rome\" ]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果使用 js 来遍历的话，也简单</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> names </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> cities</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> c</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这个数据可能还没那么复杂，在看看下面这个例子，代码来源于<a href=\"https://goessner.net/articles/JsonPath\" target=\"_blank\" rel=\"noopener noreferrer\">https://goessner.net/articles/JsonPath</a></p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"store\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"book\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reference\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Nigel Rees\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Sayings of the Century\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8.95</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"fiction\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Evelyn Waugh\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Sword of Honour\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">12.99</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"fiction\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Herman Melville\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Moby Dick\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"isbn\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0-553-21311-3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8.99</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"fiction\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"J. R. R. Tolkien\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"The Lord of the Rings\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"isbn\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0-395-19395-8\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">22.99</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"bicycle\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"color\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"red\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">19.95</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><table><thead><tr><th>JsonPath</th><th>Result</th></tr></thead><tbody><tr><td><code>$.store.book[*].author</code></td><td>所有 book 的 author 节点</td></tr><tr><td><code>$..author</code></td><td>所有 author 节点</td></tr><tr><td><code>$.store.*</code></td><td>store 下的所有节点，book 数组和 bicycle 节点</td></tr><tr><td><code>$.store..price</code></td><td>store 下的所有 price 节点</td></tr><tr><td><code>$..book[2]</code></td><td>匹配第 3 个 book 节点</td></tr><tr><td><code>$..book[(@.length-1)]</code>，或 <code>$..book[-1:]</code></td><td>匹配倒数第 1 个 book 节点</td></tr><tr><td><code>$..book[0,1]</code>，或 <code>$..book[:2]</code></td><td>匹配前两个 book 节点</td></tr><tr><td><code>$..book[?(@.isbn)]</code></td><td>过滤含 isbn 字段的节点</td></tr><tr><td><code>$..book[?(@.price&lt;10)]</code></td><td>过滤<code>price&lt;10</code>的节点</td></tr><tr><td><code>$..*</code></td><td>递归匹配所有子节点</td></tr></tbody></table><p>对应的语法可直接到在 JSONPath 在线验证网站上进行测试。要提一点的是，jsonpath 是支持使用 || 与 &amp;&amp; 进行过滤的，比如上面要获取 category 为 fiction，price 大于 10 的语法为<code>$..book[?(@.price&gt;10 &amp;&amp; @.category==\"fiction\")]</code> 结果如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"fiction\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Evelyn Waugh\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Sword of Honour\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">12.99</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"fiction\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"J. R. R. Tolkien\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"title\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"The Lord of the Rings\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"isbn\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0-395-19395-8\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"price\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">22.99</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"终极实战\">终极实战<a class=\"hash-link\" href=\"#终极实战\" title=\"标题的直接链接\">​</a></h2><p>也许你会觉得上面的例子太过简单了，可能没达到你预期所想要的效果，甚至还不如使用 json 遍历呢，下面我列举一个是我实战中遇到的例子（实际上这样的例子特别多），我先把部分数据展示出来（删除部分没用到的参数，实际参数远比这多），然后通过 js 遍历，以及 jsonpath 来获取我想要的数据。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"结构\">结构<a class=\"hash-link\" href=\"#结构\" title=\"标题的直接链接\">​</a></h3><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210919194116296.png\" alt=\"image-20210919194116296\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据\">数据<a class=\"hash-link\" href=\"#数据\" title=\"标题的直接链接\">​</a></h3><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"unit\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"section\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"summary\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"{\\\"indexMap\\\": {}, \\\"questionsList\\\": []}\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"text\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Learning objectives\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"suggestedDuration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1-1 Learning objectives\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"90ed499f91084e2aa1b7032d2e4ecd76\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Learning objectives\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"section\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Practice-1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g6\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g6\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Practice-2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g7\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g7\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Practice-3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g544\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g544\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Practice-4\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g9\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g9\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Practice\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"f6768dc9474746b9ba071e7f211534d9\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g5\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"suggestedDuration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1-2 Sharing\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1c97a87a9feb4a8aa7d6ed39482d866d\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"video\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Get the skills\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g16\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g16\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Use the skills-1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g615\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g615\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Use the skills-2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g18\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g18\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Use the skills-3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g19\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g19\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Use the skills\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2d8a81799bcc44ccab2646b613557b2b\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g17\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Think and speak\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g21\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g21\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Think and speak\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"5833925c8c5e4ddab7a114b15d610983\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g20\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"suggestedDuration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1-3 Listening\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"681817aaf75845468e464e1a8d82f2c8\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g14\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Get a clue\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g25\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g25\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Get a clue\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"b332335ab3554dffb92afcae5f815b5a\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g24\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"View it-1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g27\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g27\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"View it-2\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g545\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g545\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"View it-3\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g29\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g29\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"View it\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"a2ecf6464d5f480e98242ebe4431a73b\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g26\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"children\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"role\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"group\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tab_type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"task\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Think and speak\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"scoreDetail\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g31\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g31\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                  </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Think and speak\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"120d0784e63c414793f5e648c416144b\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g30\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"suggestedDuration\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1-4 Viewing\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"block_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"765a1be83ac5437aaca8fa150ad5af2e\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"u1g22\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Listening to the world\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"tags\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"需求\">需求<a class=\"hash-link\" href=\"#需求\" title=\"标题的直接链接\">​</a></h3><p>可以看到数据比一开始的例子复杂了可不是一点，不过先别管这些数据是干啥的，说说需求，从结构上也能看出来，是有很多<code>children</code>嵌套的，而需求就是<strong>获取<code>role</code>为<code>group</code>的<code>children</code>节点数据</strong></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"js-实现遍历\">js 实现遍历<a class=\"hash-link\" href=\"#js-实现遍历\" title=\"标题的直接链接\">​</a></h3><p>先说说 js 如何实现的，我贴一下对应的代码（当时项目的代码，稍微修改的一点），可自己粘贴运行一下。</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> groupList </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> node </span><span class=\"token keyword\" style=\"color:#66d9ef\">of</span><span class=\"token plain\"> json</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">children</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">??</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">role</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'group'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> groupList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">node </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> group </span><span class=\"token keyword\" style=\"color:#66d9ef\">of</span><span class=\"token plain\"> node</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">children</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">??</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">group</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">role</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'group'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> groupList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">group </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> child </span><span class=\"token keyword\" style=\"color:#66d9ef\">of</span><span class=\"token plain\"> group</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">children</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">??</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">child</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">role</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'group'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> groupList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">child </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> children4 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> child</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">children</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">??</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> child </span><span class=\"token keyword\" style=\"color:#66d9ef\">of</span><span class=\"token plain\"> children4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">child</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">role</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'group'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> groupList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">child </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">groupList</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>因为这些数据中，是存在不确定性的，也就是在当前节点下，二级节点可能有<code>children</code>，而其他节点下的二级很可能没有 <code>children</code>，所以我在这边就加上 <code>?? []</code> （Typescript 中的<code>??</code>语法，你可以把 <code>??</code> 当做 <code>||</code> ）来判断是否有<code>children</code>节点，有些读者可能会思考，为啥不用递归呢。说的是挺轻松的，但是递归是很容易出问题的，万一爬取到后台数据进行了一些修改，很有可能对于的递归算法将失效，甚至导致堆栈溢出，所以我这边值循环 4 级<code>chilren</code>节点（实际遇到的貌似也只有 4 级，谁又能保证爬取到数据就一定只有 4 级呢）。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"jsonpath-获取\">jsonpath 获取<a class=\"hash-link\" href=\"#jsonpath-获取\" title=\"标题的直接链接\">​</a></h3><p>于是了解到 jsonpath 后，我第一个时间就开始分析这样的数据，果不其然，得到了我想要的结果 ⬇️</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210919200826079.png\" alt=\"image-20210919200826079\" class=\"img_ev3q\"></p><p>语法：<code>$..children[?(@.role==\"group\")]</code></p><p>语法意思很明确，根节点下遍历所有<code>children</code>节点，同时<code>role</code>等于<code>group</code>，呈现的效果如上图。</p><p>而回到需求，<strong>就是获取<code>role</code>为<code>group</code>的<code>children</code>节点数据</strong>，而 jsonpath 就帮我轻松实现我想要的效果。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最终思考\">最终思考<a class=\"hash-link\" href=\"#最终思考\" title=\"标题的直接链接\">​</a></h2><p>实际上这样的需求我已经不止遇到一次，二次了，然而我寻求百度与群友的时候，给我的结果都不尽人意。但都没有提及到 jsonpath 来进行获取。也许是我的搜索方式有问题，但千篇一律都是 js 如何解析多层 json，以及遍历所有的子元素，虽然这些办法确实能解决我的问题，但每次遇到这种数据，都需要花上长时间去编写对应的逻辑。</p><p>在回想起当时爬取 HTML 页面数据的时候（数据与上面展示的差不多，都是树结构多层），而我只接触到了正则表达式，没了解过 CSS 选择器与 xpath。怎么办，为了实现目的，只好用现有的技术去实现，于是编写一个正则表达式就花费了近一个下午的时间，而使用 CSS 选择器 10 分钟不到就达到目的。没想到竟然有这么好用的方法，早知道多去了解点技术了。可能现在的心情和当时一样，只不过 HTML 换成了 JSON，编辑器还是那个编辑器，而我依旧还是我</p><p>也许这就是编程，也许这就是人生。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/use-jsonpath-to-parse-json-data",
            "title": "使用JSONPath解析json数据",
            "summary": "之前学习爬虫的时候，如果是 HTML 的数据，通过 xpath 或是 css 选择器，就能很快的获取我们想要的数据，如果是 json 有没有类似 xpath 这种，能够直接根据条件定位数据，而不需要自行 json 解析在遍历获取。答案是有的，也就是 JSONPath。",
            "date_modified": "2021-09-20T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "javascript",
                "json",
                "node"
            ]
        },
        {
            "id": "vue-chrome-extension",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/mini.jpg\" alt=\"mini\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>我当时学习开发 Chrome 插件的时候，还不会 Vue，更别说 Webpack 了，所以使用的都是原生的 html 开发，效率就不提了，而这次就准备使用 vue-cli 来进行编写一个某 B 站获取视频信息,评论的功能（原本是打算做自动回复的），顺便巩固下 chrome 开发（快一年没碰脚本类相关技术了），顺便写套模板供自己后续编写 Chrome 插件做铺垫。</p><p>关于 Chrome 插件开发的基本知识就不赘述了，之前写过一篇原生开发的<a href=\"/examenEbau/docs/skill/develop/Chrome插件开发\">Chrome 插件开发 - 愧怍的小站</a>，里面有附带相关文档链接。</p><p>相关代码开源<a href=\"https://github.com/kuizuo/vue-chrome-extension\" target=\"_blank\" rel=\"noopener noreferrer\">github 地址</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"环境搭建\">环境搭建<a class=\"hash-link\" href=\"#环境搭建\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://vue-web-extension.netlify.app/\" target=\"_blank\" rel=\"noopener noreferrer\">Vue Web-Extension - A Web-Extension preset for VueJS (vue-web-extension.netlify.app)</a></p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install -g @vue/cli</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install -g @vue/cli-init</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">vue create --preset kocal/vue-web-extension my-extension</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cd my-extension</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run server</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>会提供几个选项，如 Eslint，background.js，tab 页，axios，如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210916142751129.png\" alt=\"image-20210916142751129\" class=\"img_ev3q\"></p><p>选择完后，将会自动下载依赖，通过 npm run server 将会在根目录生成 dist 文件夹，将该文件拖至 Chrome 插件管理便可安装，由于使用了 webpack，所以更改代码将会热更新，不用反复的编译导入。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目结构\">项目结构<a class=\"hash-link\" href=\"#项目结构\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─src</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─background.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─manifest.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─views</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   ├─About.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   └Home.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─store</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   └index.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─standalone</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |     ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |     └main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─router</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   └index.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─popup</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   └main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─override</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    └main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─options</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    └main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─devtools</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    ├─App.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |    └main.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─content-scripts</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |        └content-script.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─components</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |     └HelloWorld.vue</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  ├─assets</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|  |   └logo.png</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─public</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─.browserslistrc</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─.eslintrc.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─.gitignore</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─babel.config.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─package.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─vue.config.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─yarn.lock</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>根据所选的页面，并在 src 与 vue.config.js 中配置页面信息编译后 dist 目录结构如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─devtools.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─favicon.ico</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─index.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─manifest.json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─options.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─override.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─popup.html</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─_locales</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─icons</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">├─css</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装组件库\">安装组件库<a class=\"hash-link\" href=\"#安装组件库\" title=\"标题的直接链接\">​</a></h3><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-elementui\">安装 elementUI<a class=\"hash-link\" href=\"#安装-elementui\" title=\"标题的直接链接\">​</a></h4><p>整体的开发和 vue2 开发基本上没太大的区别，不过既然是用 vue 来开发的话，那肯定少不了组件库了。</p><p>要导入 Element-ui 也十分简单，<code>Vue.use(ElementUI); </code>Vue2 中怎么导入 element，便怎么导入。演示如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210916150154078.png\" alt=\"image-20210916150154078\" class=\"img_ev3q\"></p><p>不过我没有使用 babel-plugin-component 来按需引入，按需引入一个按钮打包后大约 1.6m，而全量引入则是 5.5 左右。至于为什么不用，因为我需要在 content-scripts.js 中引入 element 组件，如果使用 babel-plugin-component 将无法按需导入组件以及样式（应该是只支持 vue 文件按需引入，总之就是折腾了我一个晚上的时间）</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-tailwindcss\">安装 tailwindcss<a class=\"hash-link\" href=\"#安装-tailwindcss\" title=\"标题的直接链接\">​</a></h4><p>不过官方提供了如何使用 TailwindCSS，这里就演示一下</p><p><a href=\"https://www.tailwindcss.cn/docs/guides/vue-3-vite\" target=\"_blank\" rel=\"noopener noreferrer\">在 Vue 3 和 Vite 安装 Tailwind CSS - Tailwind CSS 中文文档</a></p><p>推荐安装低版本，最新版有兼容性问题</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">install</span><span class=\"token plain\"> tailwindcss@npm:@tailwindcss/postcss7-compat postcss@^7 autoprefixer@^9</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>创建 postcss.config.js 文件</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">postcss.config.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// postcss.config.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">plugins</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'tailwindcss'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'autoprefixer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// if you have installed `autoprefixer`</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>创建 tailwind.config.js 文件</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">tailwind.config.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// tailwind.config.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">purge</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Specify the paths to all of the template files in your project</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">content</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'src/**/*.vue'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// Whitelist selectors by using regular expression</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">whitelistPatterns</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">-(leave|enter|appear)(|-(to|from|active))$</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// transitions</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\">v</span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// scoped css</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 src/popup/App.vue 中导入样式，或在新建 style.css 在 mian.js 中<code>import \"../style.css\";</code></p><div class=\"language-vue codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">src/popup/App.vue</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-vue codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;style&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">/* purgecss start ignore */</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">@tailwind base;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">@tailwind components;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">/* purgecss end ignore */</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">@tailwind utilities;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">&lt;/style&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>从官方例子导入一个登陆表单，效果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210916152633247.png\" alt=\"image-20210916152633247\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"项目搭建\">项目搭建<a class=\"hash-link\" href=\"#项目搭建\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"页面搭建\">页面搭建<a class=\"hash-link\" href=\"#页面搭建\" title=\"标题的直接链接\">​</a></h3><p>页面搭建就没什么好说的了，因为使用的是 element-ui，所以页面很快就搭建完毕了，效果如图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210918115438700.png\" alt=\"image-20210918115438700\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"悬浮窗\">悬浮窗<a class=\"hash-link\" href=\"#悬浮窗\" title=\"标题的直接链接\">​</a></h3><p>悬浮窗其实可有可无，不过之前写 Chrome 插件的时候就写了悬浮窗，所以 vue 版的也顺带写一份。</p><p>要注意的是悬浮窗是内嵌到网页的（且在 document 加载前载入，也就是<code>\"run_at\": \"document_start\"</code>），所以需要通过 content-scripts.js 才能操作页面 Dom 元素，首先在配置清单 manifest.json 与 vue.confing.js 中匹配要添加的网站，以及注入的 js 代码，如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">manifest.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"content_scripts\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"matches\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"https://www.bilibili.com/video/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"js\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"js/jquery.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"js/content-script.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"css\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"css/index.css\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"run_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"document_start\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"matches\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"https://www.bilibili.com/video/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"js\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"js/jquery.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"js/bilibili.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#f92672\">\"run_at\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"document_end\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">vue.config.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">contentScripts</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">entries</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">'content-script'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'src/content-scripts/content-script.js'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">bilibili</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'src/content-scripts/bilibili.js'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>由于是用 Vue，但又要在 js 中生成组件，就使用<code>document.createElement</code>来进行创建元素，Vue 组件如下（可拖拽）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210917142340863.png\" alt=\"image-20210917142340863\" class=\"img_ev3q\"></p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>如果使用<code>babel-plugin-component</code>按需引入，组件的样式将无法载入，同时自定义组件如果编写了 style 标签，那么也同样无法载入，报错：Cannot read properties of undefined (reading 'appendChild')</p><p>大致就是 css-loader 无法加载对应的 css 代码，如果执意要写 css 的话，直接在 manifest.json 中注入 css 即可</p></div></div><details open=\"\" class=\"details_lb9f alert alert--info details_b_Ee\" data-collapsed=\"false\"><summary>完整代码</summary><div><div class=\"collapsibleContent_i85q\"><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">content-script.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 注意，这里引入的vue是运行时的模块，因为content是插入到目标页面，对组件的渲染需要运行时的vue， 而不是编译环境的vue （我也不知道我在说啥，反正大概意思就是这样）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">Vue</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'vue/dist/vue.esm.js'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">ElementUI</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">Message</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'element-ui'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token maybe-class-name\">Vue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token maybe-class-name\">ElementUI</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 注意，必须设置了run_at=document_start此段代码才会生效</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'DOMContentLoaded'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'vue-chrome扩展已载入'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">insertFloat</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在target页面中新建一个带有id的dom元素，将vue对象挂载到这个dom上。</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">insertFloat</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> element </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'div'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> attr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  attr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'appPlugin'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">setAttributeNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">attr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getElementsByTagName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'body'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">appendChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">element</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> link </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'link'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> linkAttr </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'rel'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  linkAttr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'stylesheet'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> linkHref </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'href'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  linkHref</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'https://unpkg.com/element-ui/lib/theme-chalk/index.css'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  link</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">setAttributeNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">linkAttr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  link</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">setAttributeNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">linkHref</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getElementsByTagName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'head'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">appendChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">link</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> top </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> mx </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> my </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> onDrag </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> drag </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function-variable function\" style=\"color:#e6db74\">inserted</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onmousedown</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">offsetLeft</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        top </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">offsetTop</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        mx </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientX</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        my </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientY</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">my </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> top </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">40</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        onDrag </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onmousemove</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">onDrag</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> nx </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientX</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> mx </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> left</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> ny </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientY</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> my </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> top</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> width </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientWidth</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> height </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientHeight</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> bodyWidth </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientWidth</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> bodyHeight </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientHeight</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">nx </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> nx </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ny </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> ny </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">ny </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> bodyHeight </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> height </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> bodyHeight </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> height </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              ny </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> bodyHeight </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> height</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">nx </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> bodyWidth </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              nx </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> bodyWidth </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> width</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">left</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> nx </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'px'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">top</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> ny </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'px'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">el</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onmouseup</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">onDrag</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            onDrag </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_vm</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Vue</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">el</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'#appPlugin'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">directives</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">drag</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> drag</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">template</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">      &lt;div class=\"float-page\" ref=\"float\" v-drag&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">        &lt;el-card class=\"box-card\" :body-style=\"{ padding: '15px' }\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">          &lt;div slot=\"header\" class=\"clearfix\" style=\"cursor: move\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;span&gt;悬浮窗&lt;/span&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;el-button style=\"float: right; padding: 3px 0\" type=\"text\" @click=\"toggle\"&gt;{{ show ? '收起' : '展开'}}&lt;/el-button&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">          &lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">          &lt;transition name=\"ul\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;div v-if=\"show\" class=\"ul-box\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">              &lt;span&gt; {{user}} &lt;/span&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">          &lt;/transition&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">        &lt;/el-card&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">      &lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">      </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function-variable function\" style=\"color:#e6db74\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">show</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">list</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">username</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">follow</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">title</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token literal-property property\" style=\"color:#f92672\">view</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">mounted</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">methods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">toggle</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">show</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">show</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div></div></details><p>因为只能在 js 中编写 vue 组件，所以得用 template 模板，同时使用了 directives，给组件添加了拖拽的功能（尤其是<code>window.onmousemove</code>，如果是元素绑定他自身的鼠标移动事件，那么拖拽鼠标将会十分卡顿），还使用了 transition 来进行缓慢动画效果其中注入的 css 代码如下</p><div class=\"language-css codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-css codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.float-page</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">400</span><span class=\"token unit\">px</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">border-radius</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token unit\">px</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> fixed</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">left</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">50</span><span class=\"token unit\">%</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">top</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">25</span><span class=\"token unit\">%</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">z-index</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1000001</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.el-card__header</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">padding</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">10</span><span class=\"token unit\">px</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">15</span><span class=\"token unit\">px</span><span class=\"token plain\"> </span><span class=\"token important\">!important</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.ul-box</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token unit\">px</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">overflow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> hidden</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.ul-enter-active</span><span class=\"token selector punctuation\" style=\"color:#f8f8f2;font-style:italic\">,</span><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.ul-leave-active</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">transition</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> all </span><span class=\"token number\" style=\"color:#ae81ff\">0.5</span><span class=\"token unit\">s</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.ul-enter</span><span class=\"token selector punctuation\" style=\"color:#f8f8f2;font-style:italic\">,</span><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"></span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.ul-leave-to</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>相关逻辑可自行观看，这里不在赘述了，并不复杂。</p><p>也顺带是复习一下 HTML 中鼠标事件和 vue 自定义命令了</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"功能实现\">功能实现<a class=\"hash-link\" href=\"#功能实现\" title=\"标题的直接链接\">​</a></h3><p>主要功能</p><ul><li><p>检测视频页面，输出对应 up 主，关注数以及视频标题播放（参数过多就不一一显示了）</p></li><li><p>监控关键词根据内容判断是否点赞，例如文本出现了下次一定，那么就点赞。</p></li></ul><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"输出相关信息\">输出相关信息<a class=\"hash-link\" href=\"#输出相关信息\" title=\"标题的直接链接\">​</a></h4><p>这个其实只要接触过一丢丢爬虫的肯定都会知道如何实现，通过右键审查元素，像这样</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210918104907148.png\" alt=\"image-20210918104907148\" class=\"img_ev3q\"></p><p>然后使用 dom 操作，选择对应的元素，输出便可</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">querySelector</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">innerText</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'老番茄'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>当然使用 JQuery 效果也是一样的。后续我都会使用 JQuery 来进行操作</p><p>在 src/content-script/bilibili.js 中写下如下代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onload</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'加载完毕'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getInfo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> username </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> follow </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">#v_upinfo &gt; div.up-info_right &gt; div.btn-panel &gt; div.default-btn.follow-btn.btn-transition.b-gz.following &gt; span &gt; span &gt; span</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> title </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">#viewbox_report &gt; h1 &gt; span</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> view </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#viewbox_report &gt; div &gt; span.view'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">attr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'title'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> follow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">getInfo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>重新加载插件，然后输出查看结果</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">加载完毕</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">bilibili.js:19 老番茄 1606.0万 顶级画质 总播放数2368406</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这些数据肯定单纯的输出肯定是没什么作用的，要能显示到内嵌悬浮窗口，或者是 popup 页面上（甚至发送 ajax 请求到远程服务器上保存）</p><p>对上面代码微改一下</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onload</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'加载完毕'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getInfo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> username </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#v_upinfo &gt; div.up-info_right &gt; div.name &gt; a.username'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">trim</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> follow </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">#v_upinfo &gt; div.up-info_right &gt; div.btn-panel &gt; div.default-btn.follow-btn.btn-transition.b-gz.following &gt; span &gt; span &gt; span</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> title </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\">#viewbox_report &gt; h1 &gt; span</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> view </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#viewbox_report &gt; div &gt; span.view'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">attr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'title'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//console.log(username, follow, title, view);</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_vm</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">user</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      username</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      follow</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">getInfo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中<code>window.kz_vm</code>是通过<code>window.kz_vm = new Vue()</code> 初始化的，方便我们操作 vm 对象，就需要通过 jquery 选择元素在添加属性了。如果你想的话也可以直接在 content-script.js 上编写代码，这样就无需使用 window 对象，但这样导致一些业务逻辑都堆在一个文件里，所以我习惯分成 bilibili.js 然后注入方式为 document_end，然后在操作 dom 元素吗，实现效果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210918110958104.png\" alt=\"image-20210918110958104\" class=\"img_ev3q\"></p><p>如果像显示到 popup 页面只需要通过页面通信就行了，不过前提得先 popup 打开才行，所以一般都是通过 background 来进行中转，一般来说很少 content –&gt; popup（因为操作 popup 的前提都是 popup 要打开），相对更多的是 content –&gt; background 或 popup –&gt; content</p><p><a href=\"https://www.cnblogs.com/liuxianan/p/chrome-plugin-develop.html#content-script%E4%B8%BB%E5%8A%A8%E5%8F%91%E6%B6%88%E6%81%AF%E7%BB%99%E5%90%8E%E5%8F%B0\" target=\"_blank\" rel=\"noopener noreferrer\">content-script 主动发消息给后台 我是小茗同学 - 博客园 (cnblogs.com)</a></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实现评论\">实现评论<a class=\"hash-link\" href=\"#实现评论\" title=\"标题的直接链接\">​</a></h4><p>这边简单编写了一下页面，通过 popup 给 content，让 content 输入评论内容，与点击发送，先看效果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/bilibili_comment.gif\" alt=\"bilibili_comment\" class=\"img_ev3q\"></p><p>同样的，找到对应元素位置</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 评论文本框</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; textarea'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">val</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'要回复的内容'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 评论按钮</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; button'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接着就是写页面通信的了，可以看到是 popup 向 content 发送请求</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">src/content-script/bilibili.js</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onload</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'content加载完毕'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">comment</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">onMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">request</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sender</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> cmd</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> message </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> request</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cmd </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'addComment'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; textarea'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">val</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#comment &gt; div &gt; div.comment &gt; div &gt; div.comment-send &gt; div.textarea-container &gt; button'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'我收到了你的消息！'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">comment</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">src/popup/App.vue</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">template</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-container</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-header</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">height</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">24</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">B站小工具</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-header</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-main</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-row</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">:gutter</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">5</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-input</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">textarea</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">:rows</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">2</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">placeholder</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">请输入内容</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">v-model</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">message</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">mb-5</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-input</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-button</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">@click</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">addComment</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">评论</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-button</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-row</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-main</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-container</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">template</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">  </span><span class=\"token script language-javascript keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">name</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'App'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">data</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">message</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">''</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">list</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">open</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript boolean\" style=\"color:#ae81ff\">false</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">created</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      chrome</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">storage</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">sync</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'list'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">obj</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">this</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">list</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">=</span><span class=\"token script language-javascript\"> obj</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'list'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">mounted</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      chrome</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">runtime</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">onMessage</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">request</span><span class=\"token script language-javascript parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript parameter\"> sender</span><span class=\"token script language-javascript parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript parameter\"> sendResponse</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript console class-name\" style=\"color:#e6db74\">console</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'收到来自content-script的消息：'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript console class-name\" style=\"color:#e6db74\">console</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\">request</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> sender</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> sendResponse</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">sendResponse</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'我是后台，我已收到你的消息：'</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\">request</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">methods</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">sendMessageToContentScript</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">message</span><span class=\"token script language-javascript parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript parameter\"> callback</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        chrome</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">tabs</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">query</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">active</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript boolean\" style=\"color:#ae81ff\">true</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">currentWindow</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript boolean\" style=\"color:#ae81ff\">true</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">tabs</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">          chrome</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">tabs</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">sendMessage</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\">tabs</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token script language-javascript number\" style=\"color:#ae81ff\">0</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">id</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> message</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript parameter\">response</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">            </span><span class=\"token script language-javascript keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\">callback</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">callback</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript\">response</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">          </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript function\" style=\"color:#e6db74\">addComment</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">this</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">sendMessageToContentScript</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">cmd</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'addComment'</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript literal-property property\" style=\"color:#f92672\">message</span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">:</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">this</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript property-access\">message</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript keyword\" style=\"color:#66d9ef\">function</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">          </span><span class=\"token script language-javascript console class-name\" style=\"color:#e6db74\">console</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token script language-javascript method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token script language-javascript string\" style=\"color:#a6e22e\">'来自content的回复：'</span><span class=\"token script language-javascript\"> </span><span class=\"token script language-javascript operator\" style=\"color:#66d9ef\">+</span><span class=\"token script language-javascript\"> response</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">        </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">      </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">    </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\">  </span><span class=\"token script language-javascript punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token script language-javascript\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token script language-javascript\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>代码就不解读了，调用 sendMessageToContentScript 方法即可。相关源码可自行下载查看</p><p>实现类似点赞功能也是同理的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"整体体验\">整体体验<a class=\"hash-link\" href=\"#整体体验\" title=\"标题的直接链接\">​</a></h2><p>当时写 Chrome 插件的效率不能说慢，反正不快就是了，像一些 tips，都得自行封装。用过 Vue 的都知道写网页很方便，写 Chrome 插件未尝不是编写一个网页，当时的我在接触了 Vue 后就萌发了使用 vue 来编写 Chrome 的想法，当然肯定不止我一个这么想过，所以我在 github 上就能搜索到相应的源码，于是就有了这篇文章。</p><p>如果有涉及到爬取数据相关的，我肯定是首选使用 HTTP 协议，如果在搞不定我会选择使用 puppeteerjs，不过 Chrome 插件主要还是增强页面功能的，可以实现原本页面不具备的功能。</p><p>本文仅仅只是初步体验，简单编写了个小项目，后期有可能会实现一个百度网盘一键填写提取码，Js 自吐 Hooke 相关的。（原本是打算做 pdd 商家自动回复的，客户说要用客户端而不是网页端（客户端可以多号登陆），无奈，这篇博客就拿 B 站来演示了）</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/vue-chrome-extension",
            "title": "使用Vue开发Chrome插件",
            "summary": "mini",
            "date_modified": "2021-09-18T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "chrome",
                "plugin",
                "vue",
                "develop"
            ]
        },
        {
            "id": "resource-navigation",
            "content_html": "<p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20220125164617.png\" alt=\"资源导航\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"为什么要写这个\">为什么要写这个<a class=\"hash-link\" href=\"#为什么要写这个\" title=\"标题的直接链接\">​</a></h2><p>无意间刷到一个网站<a href=\"https://www.code-nav.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">编程导航 - 发现优质编程资源 (code-nav.cn)</a></p><p>当时我学习的时候，也是有着这样类似的站点，才让我了解到一些未曾听闻过的优质资源，所以才萌生出编写类似资源导航的一个功能，记录下自己用过见过的一些工具，框架，顺便分享一波，不过我原本是考虑内置到个人博客上，而不是新建一个站点，但是上面的这个网站部分开源，并且基于 React + Ant Design Pro，正好我最新在学习该技术，于是就成为了我的一个练手项目，二话不说，直接 clone 了该仓库便开始了阅读源码。</p><blockquote><p>注: 资源数据首次加载采用了随机排序，资源不分先后顺序。</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"思路分析\">思路分析<a class=\"hash-link\" href=\"#思路分析\" title=\"标题的直接链接\">​</a></h2><p>首先该项目的后端采用的是腾讯云的云开发，这里简单介绍一些云开发，本质上和正常开发没什么区别，都是服务端编写接口逻辑，客户端调用接口，主要的特点有如下几个</p><ul><li><strong>无需管理服务器、数据库等等</strong>\n传统的后端开发都需要另外搭建一台服务器，配置一堆相关设置，然后他人通过 ip 加端口来进行调用，所以就免不了部署这一门槛了，而使用云开发就无需考虑这些因素，只需要编写对应的业务逻辑便可，也是常说的无服务架构</li><li><strong>原生微信服务集成</strong>\n腾讯云云开发可以直接接入微信用户数据，如果是小程序或公众号开发，接入将会特别方便</li><li><strong>开发简单高效</strong>\n开发简单，不要求特定的框架和依赖，只需要关注业务逻辑便可</li><li><strong>成本更低</strong>\n云开发一般都是按量使用，同时还会提供一定的免费额度（初次使用有 1 年额外的免费额度），相比购买一台服务器甚至专属的云数据库而言，很多情况下都会存在资源剩余的情况。</li><li><strong>运维省事</strong>\n每个云函数都是单独运行、单独部署、单独伸缩，用户上传代码后即可自动部署，免除单体式应用部署升级难的问题。</li></ul><p>正好呢我又没接触过云开发，于是花了一个晚上的时间官方文档给过了一遍，理清如何发布与调用即可。</p><p>但是在该项目我并不打算使用云开发，为啥呢，我是打算写成纯静态的页面，资源更新的频率又不高，并且无需登录鉴权，所以后端服务基本用不上。于是把有关用户与数据交互的地方全部都给置成本地了。（也许后续会弄成需要登录的）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"更改代码\">更改代码<a class=\"hash-link\" href=\"#更改代码\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"定义分类文件\">定义分类文件<a class=\"hash-link\" href=\"#定义分类文件\" title=\"标题的直接链接\">​</a></h3><p>项目预先采用的是 Mock 数据，于是我吧 Mock 数据，替换成了真实数据，然后采用 Nodejs 模块导入的方式，将所要展示的资源导入进去，像这样</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210908024417996.png\" alt=\"image-20210908024417996\" class=\"img_ev3q\"></p><p>标注名称、简介、logo、链接、标签这些元素后，然后根据源码中自带的列表案例，进行样式微调整即可。</p><p>不过这里定义太多文件，就需要频繁的导入，于是我使用了 Nodejs 中<code>require.context</code>将指定目录 modules 中的所有文件自动导入，相关代码如下</p><div class=\"language-typescript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">mock/index.ts</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-typescript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> modulesFiles </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">context</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'./modules'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token regex regex-delimiter\">/</span><span class=\"token regex regex-source language-regex\">\\.ts$</span><span class=\"token regex regex-delimiter\">/</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> allData</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token builtin\" style=\"color:#e6db74\">any</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">modulesFiles</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">keys</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">modulePath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> value </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">modulesFiles</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">modulePath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">default</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  allData</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token function\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token plain\">default</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这样每次在相应目录下定义完文件，就会将模块自动导入。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"定义数据\">定义数据<a class=\"hash-link\" href=\"#定义数据\" title=\"标题的直接链接\">​</a></h3><p>名字和简介都还比较好解决，基本上官方文档都会一个简短的案例，可以直接拷贝过来，但令我头疼的是分类和标签，有的时候一个资源可以归分为好几个类别，像一些属于 Nodejs 的，但有些有属于 JavaScript 的，比如 Webpack，EsLint，Jest，就很抉择，再比如<code>框架</code>的话又细分为好几种，要标注为前端框架，后端框架，就很头疼。</p><p>一开始分类的时候没规划好，想到啥就从收藏夹中找对应的资源，开始填写，有时候写着写着，都不记得已经写过的东西</p><p>其次就是图片，有些官方未提供 favicon 文件，或者是图片尺寸太小，就只好从首页获取。但首页的图片并非是一个 url 资源，有可能是 Base64 编码的图片，或者是 Svg 格式的，Base64 的话还好，直接复制浏览器便能自动解码，反倒是内嵌的 Svg 标签，没办法，只好截图将这些图片上传到图床，然后在通过外链进行访问了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"整理资源\">整理资源<a class=\"hash-link\" href=\"#整理资源\" title=\"标题的直接链接\">​</a></h3><p>然后就是开始整理资源，写数据，很枯燥，比写代码还要枯燥，有一时间内，我甚至开始羡慕起写代码了。</p><p>目前大致把我遇到过的给记录一下，前前后后整理了有 150 个左右资源，后续是肯定还会补充新的资源点（开始点技能了），主要我的技术栈都是 JavaScript 和 Nodejs，所以大部分资源都是围绕这些，所以导航中可能会遇到些如果有我未提及到的，那大概率我没了解过或是没必要写的。</p><p>资源主要来源：除了我自己之前整理过外，还借鉴了如下几个资源点。</p><blockquote><p><a href=\"https://www.code-nav.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">编程导航 - 发现优质编程资源 (code-nav.cn)</a></p><p><a href=\"https://www.bootcss.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Bootstrap 中文网 (bootcss.com)</a></p><p><a href=\"https://gitee.com/jishupang/Favorites/blob/master/02.Markdown/Markdown%E6%8A%80%E6%9C%AF%E8%83%96%E6%B5%8F%E8%A7%88%E5%99%A8%E6%94%B6%E8%97%8F%E5%A4%B9%E5%85%AC%E5%BC%80.md\" target=\"_blank\" rel=\"noopener noreferrer\">技术胖/100+前端工具和网站推荐 收藏夹公开 - Gitee.com</a></p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"一些问题\">一些问题<a class=\"hash-link\" href=\"#一些问题\" title=\"标题的直接链接\">​</a></h2><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"非搜索引擎式搜索\">非搜索引擎式搜索<a class=\"hash-link\" href=\"#非搜索引擎式搜索\" title=\"标题的直接链接\">​</a></h4><p>由于网站内的资源数据都是纯静态的，在搜索上我是直接采用了 JavaScript 中数组的 includes 来进行判断是否存在的，并未使用分词这些，（如果数据都存放至 Elasticsearch 上，这些都不是事），所以搜索并不能像搜索引擎那样进行分词搜索。（就连大小写都不区分的那种）</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"标签不可自定义\">标签不可自定义<a class=\"hash-link\" href=\"#标签不可自定义\" title=\"标题的直接链接\">​</a></h4><p>同样的，标签也是会有这个问题，并且我并未将全部标签内置，也就是说，部分标签是无法进行筛选了，主流的肯定是预先设置好了的。同时也不支持自定义标签搜索。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"未含基础知识点\">未含基础知识点<a class=\"hash-link\" href=\"#未含基础知识点\" title=\"标题的直接链接\">​</a></h4><p>例如基本的计算机系统，数据结构，算法等等这些我并没有写入，至于为什么，这就不细说了。（我自己都不记得我到底学没学过这些），后续如果有需要的话，应该是会补上的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>从 clone 到发布花了差不多有一周左右的时间，说快也不算快，慢也不算慢，主要的时间都花在资源分类和搜索上。</p><p>算是第二个 React 项目了（第一个是该博客），不过由于该资源导航是纯静态的，没有任何与后端数据交互的，所以后续有空的话，应该是会写一个 ant-design-pro 后台管理模板，能与后端有数据交互的那种。至于后端技术栈的话，也许是 Node，也许是 Go 吧。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/resource-navigation",
            "title": "资源导航",
            "summary": "资源导航",
            "date_modified": "2021-09-09T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "project",
                "react"
            ]
        },
        {
            "id": "try-to-cloud-develop",
            "content_html": "<p>在接触一个开源项目的时候，项目的后端采用的是云开发的模式（云函数，云数据库等等），本人又没接触过云开发，于是便有了这篇文章。</p><p>本文使用是的腾讯云的产品，官方文档（很详细） <a href=\"https://docs.cloudbase.net/\" target=\"_blank\" rel=\"noopener noreferrer\">云开发 CloudBase - 一站式后端云服务</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云开发-cloudbase-环境\">云开发 CloudBase 环境<a class=\"hash-link\" href=\"#云开发-cloudbase-环境\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://docs.cloudbase.net/quick-start/create-env.html\" target=\"_blank\" rel=\"noopener noreferrer\">开通环境 | 云开发 CloudBase - 一站式后端云服务</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"本地安装-cli-工具\">本地安装 CLI 工具<a class=\"hash-link\" href=\"#本地安装-cli-工具\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-nodejs\">安装 Nodejs<a class=\"hash-link\" href=\"#安装-nodejs\" title=\"标题的直接链接\">​</a></h3><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-cloudbase-cli\">安装 CloudBase CLI<a class=\"hash-link\" href=\"#安装-cloudbase-cli\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docs.cloudbase.net/cli-v1/install.html\" target=\"_blank\" rel=\"noopener noreferrer\">安装 | 云开发 CloudBase - 一站式后端云服务</a></p><p>使用 NPM</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i -g @cloudbase/cli</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>或使用 Yarn</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">yarn global add @cloudbase/cli</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>测试是否安装成功</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tcb -v</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"登录方式\">登录方式<a class=\"hash-link\" href=\"#登录方式\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"腾讯云-云开发控制台授权\">腾讯云-云开发控制台授权<a class=\"hash-link\" href=\"#腾讯云-云开发控制台授权\" title=\"标题的直接链接\">​</a></h3><p>在您的终端中输入下面的命令</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tcb login</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>CloudBase CLI 会自动打开云开发控制台获取授权，您需要点击同意授权按钮允许 CloudBase CLI 获取授权。如您没有登录，您需要登录后才能进行此操作。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210905085929546.png\" alt=\"image-20210905085929546\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"腾讯云-云-api-密钥授权\">腾讯云-云 API 密钥授权<a class=\"hash-link\" href=\"#腾讯云-云-api-密钥授权\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docs.cloudbase.net/cli-v1/login.html\" target=\"_blank\" rel=\"noopener noreferrer\">登录方式 | 云开发 CloudBase - 一站式后端云服务</a></p><p>首先您需要到腾讯云官网获取<a href=\"https://console.cloud.tencent.com/cam/capi\" target=\"_blank\" rel=\"noopener noreferrer\">云 API 密钥 (opens new window)</a>，然后在终端中输入下面的命令：</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tcb login --key</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>回车后，请按提示输入云 API 密钥的 SecretId 和 SecretKey 既可完成登录。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ci-中的登录\">CI 中的登录<a class=\"hash-link\" href=\"#ci-中的登录\" title=\"标题的直接链接\">​</a></h3><p>在 CI（持续集成）构建中，您可以使用下面的方式通过 API 秘钥直接登录，避免交互式输入</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tcb login --apiKeyId xxx --apiKey xxx</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"临时秘钥登录\">临时秘钥登录<a class=\"hash-link\" href=\"#临时秘钥登录\" title=\"标题的直接链接\">​</a></h3><p>通过腾讯云临时秘钥登录，可以在某些比较敏感的场景下使用，使用短期有效的秘钥</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tcb login --apiKeyId xxx --apiKey xxx --token xxx</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"开始体验\">开始体验<a class=\"hash-link\" href=\"#开始体验\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://docs.cloudbase.net/api-reference/server/node-sdk/introduction.html\" target=\"_blank\" rel=\"noopener noreferrer\">介绍 | 云开发 CloudBase - 一站式后端云服务</a></p><p>所采用的是<code>Nodejs SDK API</code>进行体验</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装\">安装<a class=\"hash-link\" href=\"#安装\" title=\"标题的直接链接\">​</a></h3><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install --save @cloudbase/node-sdk</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"初始化\">初始化<a class=\"hash-link\" href=\"#初始化\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 初始化示例</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> tcb </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@cloudbase/node-sdk'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 初始化资源</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//云函数下使用默认环境</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> app </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> tcb</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云函数\">云函数<a class=\"hash-link\" href=\"#云函数\" title=\"标题的直接链接\">​</a></h3><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"创建云函数\">创建云函数<a class=\"hash-link\" href=\"#创建云函数\" title=\"标题的直接链接\">​</a></h4><p><a href=\"https://docs.cloudbase.net/cloud-function/introduce.html\" target=\"_blank\" rel=\"noopener noreferrer\">概述 | 云开发 CloudBase - 一站式后端云服务</a></p><p>创建一个项目，在项目的根目录创建 <strong>functions</strong> 文件夹。在 <strong>functions</strong> 下创建 <strong>hello_world</strong> 文件夹，包含 <strong>index.js</strong> 与 <strong>package.json</strong> 两个文件。</p><p>此时目录结构如下：</p><div class=\"language-text codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">└── functions</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    └── hello_world</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        ├── index.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        └── package.json</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>index.js</strong> 内容如下：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">exports</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">main</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Hello World!'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><strong>package.json</strong> 内容如下：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"hello_world\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"version\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"1.0.0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"main\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"index.js\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"发布云函数\">发布云函数<a class=\"hash-link\" href=\"#发布云函数\" title=\"标题的直接链接\">​</a></h4><p>通过前面安装的 CLI 工具，在<strong>项目根目录</strong>运行以下命令，并且使用<strong>默认配置</strong>：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cloudbase fn deploy hello_world -e </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">env-id</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>&lt;env-id&gt;</code>为环境 id，可在云开发 CloudBase 中环境查看，部署结果如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210905093035131.png\" alt=\"image-20210905093035131\" class=\"img_ev3q\"></p><p>在控制面板中也能看到对应的云函数列表</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210905093757875.png\" alt=\"image-20210905093757875\" class=\"img_ev3q\"></p><p>后台也是能完整看到对应的代码的</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210905094146730.png\" alt=\"image-20210905094146730\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"调用云函数\">调用云函数<a class=\"hash-link\" href=\"#调用云函数\" title=\"标题的直接链接\">​</a></h4><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-http-调用\">使用 HTTP 调用<a class=\"hash-link\" href=\"#使用-http-调用\" title=\"标题的直接链接\">​</a></h5><p>执行以下命令创建一条 HTTP 服务路由，路径为 <code>/hello</code>，指向的云函数为 <code>hello_world</code>：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cloudbase </span><span class=\"token function\" style=\"color:#e6db74\">service</span><span class=\"token plain\"> create -p hello -f hello_world -e </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\">env-id</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>随后便可以通过 <code>https://&lt;env-id&gt;.service.tcloudbase.com/hello</code> 调用云函数，并获得返回结果。如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210905093505618.png\" alt=\"image-20210905093505618\" class=\"img_ev3q\"></p><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nodejs-调用\">Nodejs 调用<a class=\"hash-link\" href=\"#nodejs-调用\" title=\"标题的直接链接\">​</a></h5><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> tcb </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@cloudbase/node-sdk'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> app </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> tcb</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">secretId</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'xxxxxx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">secretKey</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'xxxxxx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">env</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'env-id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">app</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">callFunction</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 云函数名称</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'hello_world'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 传给云函数的参数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">a</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">catch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>输出</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  result: 'Hello World!',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  requestId: 'xxxxx‘</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云数据库\">云数据库<a class=\"hash-link\" href=\"#云数据库\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docs.cloudbase.net/database/introduce.html\" target=\"_blank\" rel=\"noopener noreferrer\">概述 | 云开发 CloudBase - 一站式后端云服务</a></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实例代码如下\">实例代码如下<a class=\"hash-link\" href=\"#实例代码如下\" title=\"标题的直接链接\">​</a></h4><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> tcb </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'@cloudbase/node-sdk'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> app </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> tcb</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">init</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">secretId</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'xxxxx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">secretKey</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'xxxxx'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">env</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'env-id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> db </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> app</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">database</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 创建集合</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createCollection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'books'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// // 插入一条数据</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res1 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">collection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'books'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">category</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Computer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">name</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Thinking in Java'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">onSale</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">sales</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">100</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取数据库中的数据</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res2 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> db</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">collection</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'books'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">run</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>运行结果如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{ requestId: '17bb3e26ecb_1', message: 'success' }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{ id: '14139e12613431c809b949933c3209de', requestId: '17bb3e27010_2' }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  data: [</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      _id: '14139e12613431c809b949933c3209de',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      category: 'Computer',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      name: 'Thinking in Java',</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      onSale: true,</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      sales: 100</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    }</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ],</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  requestId: '17bb3e270ca_3'</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云存储\">云存储<a class=\"hash-link\" href=\"#云存储\" title=\"标题的直接链接\">​</a></h3><p>暂时用不到，就没体验</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"登录鉴权\">登录鉴权<a class=\"hash-link\" href=\"#登录鉴权\" title=\"标题的直接链接\">​</a></h3><p>暂时用不到，就没体验</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"体验感受\">体验感受<a class=\"hash-link\" href=\"#体验感受\" title=\"标题的直接链接\">​</a></h2><p>除了要钱外，我目前是找不到第二个缺点，我个人体验下来，整体流程可以说是非常爽的那种。因为部署项目是一件特别折腾的一件事情，而使用云开发门槛瞬间减少一半，只要会写 js 函数，会调用数据库，就足够搞定一个后端服务了。如果是搞小程序的，又要搞服务这些，直接上手云开发，微信用户，微信支付直接一条龙服务。</p><p>当然了如果要搞什么分布式，集群啥的，那还是老老实实的用后端框架吧。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/try-to-cloud-develop",
            "title": "尝试云开发",
            "summary": "在接触一个开源项目的时候，项目的后端采用的是云开发的模式（云函数，云数据库等等），本人又没接触过云开发，于是便有了这篇文章。",
            "date_modified": "2021-09-06T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "develop"
            ]
        },
        {
            "id": "mongodb-time-grouping",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"需求\">需求<a class=\"hash-link\" href=\"#需求\" title=\"标题的直接链接\">​</a></h2><p>需求是这样的，要统计每一周的各个商品的销售记录，使用 echarts 图表呈现，如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210830214556262.png\" alt=\"image-20210830214556262\" class=\"img_ev3q\"></p><p>说实话，一开始听到这个需求的时候，我是有点慌的，因为 MongoDB 的分组玩的比较少（Mysql 也差不多），又要按照对应的星期来进行分组，这在之前学习 MongoDB 的时候还没接触过，于是就准备写了这篇文章，来记录下我是如何进行分组的</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"mongodb-的一些时间操作符\">MongoDB 的一些时间操作符<a class=\"hash-link\" href=\"#mongodb-的一些时间操作符\" title=\"标题的直接链接\">​</a></h2><p>时间操作符（专业术语应该不是这个，后文暂且使用这个来描述），<strong>后面会用到的</strong></p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$dayOfYear: 返回该日期是这一年的第几天。（全年366天）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$dayOfMonth: 返回该日期是这一个月的第几天。（1到31）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$dayOfWeek: 返回的是这个周的星期几。（1：星期日，7：星期六）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$year: 返回该日期的年份部分</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$month： 返回该日期的月份部分（between 1 and 12.）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$week： 返回该日期是所在年的第几个星期（between 0 and 53）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$hour： 返回该日期的小时部分</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$minute: 返回该日期的分钟部分</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$second: 返回该日期的秒部分（以0到59之间的数字形式返回日期的第二部分，但可以是60来计算闰秒。）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$millisecond：返回该日期的毫秒部分（between 0 and 999.）</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">$dateToString：{ $dateToString: { format: &lt;formatString&gt;, date: &lt;dateExpression&gt; } }</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"日期分组\">日期分组<a class=\"hash-link\" href=\"#日期分组\" title=\"标题的直接链接\">​</a></h2><p><a href=\"https://blog.csdn.net/wangshu_liang/article/details/95326578?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0.essearch_pc_relevant&amp;spm=1001.2101.3001.4242\" target=\"_blank\" rel=\"noopener noreferrer\">mongdb 聚合查询日期 统计每天数据</a></p><p>关于日期分组的话，我是借鉴了这篇文章，也确实带我解惑了下如何按照日期分组。这里贴下我的代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dateToString</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">10</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$date'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sum</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 再使用$project将_id改名为date</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据日期倒序</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>或者使用时间操作符（更准确一点）</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dateToString</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">format</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'%Y-%m-%d'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$date'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sum</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 再使用$project将_id改名为date</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据日期倒序</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>通过</p><blockquote><p>要注意的是，$group 里的属性必须为<!-- -->_<!-- -->id，不然无法分组</p></blockquote><p>获取到的数据如下（这里只显示一周）</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">54</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-30\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">29</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-29\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-28\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">17</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-27\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">12</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-26\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">6</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-25\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-24\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果只是日期和总商品的话，上面就足以显示对应的数据了，可我要根据星期进行分组的话，就需要替换 MongoDB 的时间转化函数了</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"星期分组\">星期分组<a class=\"hash-link\" href=\"#星期分组\" title=\"标题的直接链接\">​</a></h2><p>星期分组的话，其实也挺简单的，只需要把上面的</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">day</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dateToString</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">format</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"%Y-%m-%d\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"$created_at\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>替换成</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dayOfWeek</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>完整代码如下</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 要获取的是一周前的零点时间</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> lastweekDay </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">dayjs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">dayjs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'day'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">format</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'YYYY-MM-DD'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueOf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$match</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">created_at</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$gte</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">lastweekDay</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//范围时间</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dayOfWeek</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$week'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sum</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 再使用$project将_id改名为week</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据星期正序</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>获取的结果如下</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">29</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期七(日)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">54</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期一</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期二</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期三</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">12</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期四</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">17</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">6</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期五</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期六</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但是，细心的你可能会发现，貌似数据对不上，注当天时间为 2021-08-30，星期一</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">54</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-30\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期一</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">29</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-29\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期七(日)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-28\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期六</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">17</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-27\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期五</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">12</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-26\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期四</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-25\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期三</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"date\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2021-08-24\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 星期二</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其实只需要把星期向后排序一位就行，因为星期本来就是将星期日作为第一天的，至此，按照星期分组总商品就算完毕了。同理，要按照月份，年份，甚至小时，分钟，都可以直接利用时间操作符转化时间来进行分组。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"多商品\">多商品<a class=\"hash-link\" href=\"#多商品\" title=\"标题的直接链接\">​</a></h2><p>上述只是获取了总商品了，要细分为多个商品的话，就需要再次利用聚合函数来进行分组了。</p><p>这里先演示分组多个商品先，就和正常分组一样</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">let list = await this.goodsModel.aggregate([</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{ $group: { _id: \"$type\", count: { $sum: 1 } } },</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">]).exec()</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>结果如下（这里输出<!-- -->_<!-- -->id，是因为没有进行$project 改别名，商品所采用的是数字表示）</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">111</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">18</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"_id\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"count\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">16</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以看到统计的是直接是所有商品的总和。</p><p>但问题来了，怎么样能分组星期的同时，又对每个商品所在星期进行分组，并且到底是优先分组星期期呢，还是优先分组商品呢，这让我陷入深深的思考。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最终实现\">最终实现<a class=\"hash-link\" href=\"#最终实现\" title=\"标题的直接链接\">​</a></h2><p>首先，绝对不可能使用两次<code>$group</code>，要么没有星期分组，要么没有商品分组，于是我就把思路放在<code>$project</code>与<code>$group</code>内，看看内部是否有其他方法可以实现。</p><p>其中<code>$group</code>可以将属性添加为数组，注意 <code>goods: { $push: \"$goods\" }</code></p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$match</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">created_at</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$gte</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">lastweekDay</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dayOfWeek</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$week'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$push</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$goods'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可得到的数据却是这样的</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">6</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>数据很接近了，如果我能把对应的商品总和算起来就行了，但问题是怎么合起来。。。</p><p>待会，goods 既然是数组的话，那我能不能<code>$unwind</code>全部展开，然后我再来一次聚合，说干就干！</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$match</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">created_at</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$gte</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">lastweekDay</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dayOfWeek</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$week'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$push</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$goods'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$unwind</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$goods'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>得到的数据（省略一堆）</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后我就卡住了，因为我无论如何都无法分组一个字段的时候，又加以限制条件，要么分组商品的时候，统计的是一周各商品总数据，要么就是分组星期的时候，统计的是总的商品数据。在搜索大量资料后，查看官方一些文档也未果，于是我决定自行写一个 js 函数来进行排序（实在是折腾不动了，能力有限 🥱）</p><p>最终完整代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> lastweekDay </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">dayjs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">dayjs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">add</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'day'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">format</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'YYYY-MM-DD'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">valueOf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goodsModel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">aggregate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$match</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">created_at</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$gte</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">lastweekDay</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$dayOfWeek</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$created_at'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$group</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$week'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$push</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$goods'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$project</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'$_id'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">_id</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">goods</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">$sort</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">week</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// { $unwind: \"$goods\" },</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">exec</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getEleNums</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> map </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">forEach</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">list </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> list</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">l</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  l</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goods</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getEleNums</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">l</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">goods</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> l</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cosnole</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">list</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>运行后的 list 结果为</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">26</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"4\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">53</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"4\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"5\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"3\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">8</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"4\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">4</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"3\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"4\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"3\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">6</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"goods\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"1\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">9</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"3\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">6</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"4\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"week\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">7</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果是要 goods 为分组的话，只需要把上面聚合代码中 week 和 goods 替换一下便可。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"另一种实现方式\">另一种实现方式<a class=\"hash-link\" href=\"#另一种实现方式\" title=\"标题的直接链接\">​</a></h2><p>专门新建一个表，用于统计每天的销售记录，然后分组的时候就根据该表就行了，具体代码就实现了，思路是挺简单的，但是需要新建一个表，增加记录的时候有需要增加代码，如果业务复杂的话。。。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/mongodb-time-grouping",
            "title": "MongoDB按时间分组",
            "summary": "需求",
            "date_modified": "2021-08-30T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "mongodb"
            ]
        },
        {
            "id": "axios-http-class-library",
            "content_html": "<p>一个基于 Axios 封装 HTTP 类库</p><p>源代码 <a href=\"https://github.com/kuizuo/kz-http\" target=\"_blank\" rel=\"noopener noreferrer\">kz-http</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用方法\">使用方法<a class=\"hash-link\" href=\"#使用方法\" title=\"标题的直接链接\">​</a></h2><p>npm 安装</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i kz-http -S</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"请求\">请求<a class=\"hash-link\" href=\"#请求\" title=\"标题的直接链接\">​</a></h3><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports maybe-class-name\">Http</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'kz-http'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> http </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'https://www.example.com'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"能解决什么\">能解决什么<a class=\"hash-link\" href=\"#能解决什么\" title=\"标题的直接链接\">​</a></h2><p>axios 明明那么好用，为啥又要基于 axios 重新造一个轮子。首先不得否认的是 axios 确实好用，Github 能斩获近 90k 的 star，且基本已成为前端作为数据交互的必备工具。但是它对我所使用的环境下还是存在一定的问题，也就是我为什么要重新造一个轮子。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"node-环境下无法自动封装-set-cookie\">Node 环境下无法自动封装 Set-Cookie<a class=\"hash-link\" href=\"#node-环境下无法自动封装-set-cookie\" title=\"标题的直接链接\">​</a></h3><p>如果 axios 是运行在浏览器那还好说，就算你无论怎么请求，浏览器都会自动将你的所有请求中的响应包含 set-cookie 参数，提供给下一次同域下的请求。但是，Node 环境并不是浏览器环境，在 Node 环境中运行并不会自动保存 Cookie，还需要手动保存，并将 Cookie 添加至协议头给下一个请求。（如果是 Python 的话，request 有个 session 方法可以自动保存 cookie，十分方便）</p><p>一开始我是自行封装，将响应中的 set-cookie 全都存在实例对象 http.cookies 上，但封装的不彻底，如果有的网站</p><p>间请求存在跨域，那么会将携带不该属于该域下的 Cookies。于是乎，我在 github 仓库找到了一个库可达到我的目的</p><p><a href=\"https://github.com/3846masa/axios-cookiejar-support\" target=\"_blank\" rel=\"noopener noreferrer\">3846masa/axios-cookiejar-support: Add tough-cookie support to axios. (github.com)</a></p><p>具体安装可以直接点击链接查看，这里贴下我<strong>之前</strong>的封装代码</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> tough </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'tough-cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> axiosCookieJarSupport </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'axios-cookiejar-support'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">axiosCookieJarSupport</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> cookieJar</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">public</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">instance</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token maybe-class-name\">AxiosInstance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">construction</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cookieJar</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">tough</span><span class=\"token class-name punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token class-name\" style=\"color:#e6db74\">CookieJar</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">allowSpecialUseDomain</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">instance</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">create</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">jar</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cookieJar</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">ignoreCookieErrors</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">withCredentials</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这样 axios 就会自动将响应中的 set-cookie 封装起来，供下次使用</p><p>但是正是由于导入了这个包，导致每次请求都需要处理，就会导致请求速度变慢，实测大约是在 100ms 左右，同时导入这个包之后，实例化的对象都将会携带对应 cookies，想要删除又得对应 Url，于是决定自行封装相关代码可查看 request 方法，实测下来大约有 10ms 左右的差距（前提都通过创建实例来请求），不过有个缺陷，我封装的代码是不进行同源判断的，如何你当前站点请求的是 api1.test.com，获取到 cookie1，那么请求 api2.test.com 的时候也会将 cookie1 携带，这边不做判断是不想在请求的时候耗费时间，比如网页与手机协议，一般这种情况建议实例化两个对象，如</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> http_api1 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> http_api2 </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"请求失败无法自动重试\">请求失败无法自动重试<a class=\"hash-link\" href=\"#请求失败无法自动重试\" title=\"标题的直接链接\">​</a></h3><p>在高并发的情况下，偶尔会出现请求超时，请求拒绝的情况，但是默认下 axios 是不支持自动重试请求的，不过可以借助插件<code>axios-retry</code>来达到这个目的</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> axiosRetry </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'axios-retry'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">class</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">constructor</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">retryConfig</span><span class=\"token parameter operator\" style=\"color:#66d9ef\">?</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">instance</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">create</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">retryConfig</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">axiosRetry</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">retries</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> retryConfig</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">retry</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 设置自动发送请求次数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function-variable function\" style=\"color:#e6db74\">retryDelay</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">retryCount</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> retryCount </span><span class=\"token operator\" style=\"color:#66d9ef\">*</span><span class=\"token plain\"> retryConfig</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">delay</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 重复请求延迟</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token literal-property property\" style=\"color:#f92672\">shouldResetTimeout</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 重置超时时间</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function-variable function\" style=\"color:#e6db74\">retryCondition</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">axiosRetry</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">isNetworkOrIdempotentRequestError</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ECONNABORTED'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">indexOf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'timeout'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'ECONNRESET'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ETIMEDOUT'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">includes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// , 'ENOTFOUND'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这边判断重新发送请求条件是连接拒绝，连接重置，和连接超时的情况。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置拦截器\">配置拦截器<a class=\"hash-link\" href=\"#配置拦截器\" title=\"标题的直接链接\">​</a></h3><p>有时候一个网站的协议是这样的，每一条 Post 都自动将所有参数进行拼接，然后进行 MD5 加密，并添加为 sign 参数，于是，不得不给每一条请求都进行这样的操作，那么有没有什么能在每次请求的时候，都自动的对参数进行 MD5 加密。如果使用过 axios 来配置过 JWT 效验，那自然就会熟悉给每条请求协议头都携带 JWT 数值。同样的，这里的加密例子同样使用，具体配置实例对象 http 的请求拦截器即可，如</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> http </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// axios实例instance是公开的</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">http</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 执行每条请求都要处理的操作</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> config</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同样的，响应拦截器也同理，例如请求返回的响应都进行加密处理，那么就可以通过响应拦截器进行统一解密，这里就不做过多描述，具体场景具体分析。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"封装一些常用方法\">封装一些常用方法<a class=\"hash-link\" href=\"#封装一些常用方法\" title=\"标题的直接链接\">​</a></h3><p>比如设置伪造 IP（setFakeIP），自动补全 referer 和 orgin 参数，禁止重定向等等，更详细的查看源码便可</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"发布-npm-包\">发布 npm 包<a class=\"hash-link\" href=\"#发布-npm-包\" title=\"标题的直接链接\">​</a></h2><p>如果要让别人使用的话，总不可能让他去下载源码然后编译吧，这里就借助 npm。</p><div class=\"admonition admonition-tip alert alert--success\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</h5></div><div class=\"admonition-content\"><p>在使用 npm 之前，请先使用<code>npm install -g npm@latest</code>升级为最新版，否则可能会提示 <strong>ERR! 426 Upgrade Required</strong>。原文 <a href=\"https://github.blog/2021-08-23-npm-registry-deprecating-tls-1-0-tls-1-1/\" target=\"_blank\" rel=\"noopener noreferrer\">The npm registry is deprecating TLS 1.0 and TLS 1.1 | The GitHub Blog</a></p></div></div><p>创建 npm 账号，创建 package.json</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">package.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kz-http\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"version\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"0.1.0\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"description\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"An HTTP class library based on axios\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"main\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"dist/index.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"scripts\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"build\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"tsc\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"license\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"ISC\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"dependencies\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"axios\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"^0.21.1\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"axios-retry\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"^3.1.9\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"devDependencies\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"typescript\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"^4.3.5\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"repository\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"type\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"git\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"url\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"git+https://github.com/kuizuo/kz-http.git\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"keywords\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"node\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"axios\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"http\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后通过<code>npm login</code>登录 npm 账号，接着输入<code>npm publish --access public</code>发布即可</p><p>发布的是要注意以下几点</p><ul><li><p>如果 npm 镜像必须是官方的，否则无法登录，镜像还原</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm config set registry https://registry.npmjs.org/</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>查看镜像配置地址</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm get registry</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></li><li><p>如果包有重名，那么就无法发布，就必须要要改名</p></li><li><p>邮箱必须要验证（会接受一条下图邮箱），不然就会发布失败\n<img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210826212258752.png\" alt=\"image-20210826212258752\" class=\"img_ev3q\"></p></li><li><p><strong>请勿随意删包，否则同名的包将需要 24 小时后才能发布（亲测）</strong></p><blockquote><p>npm ERR! 403 403 Forbidden - PUT <a href=\"http://registry.npmjs.org/kz-http\" target=\"_blank\" rel=\"noopener noreferrer\">http://registry.npmjs.org/kz-http</a> - kz-http cannot be republished until 24 hours have passed.</p></blockquote></li></ul><p>发布完成后，别人只需要通过<code>npm i kz-http</code>就可成功将模块下载至本地 node_modules 文件夹下</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/axios-http-class-library",
            "title": "基于Axios封装HTTP类库",
            "summary": "一个基于 Axios 封装 HTTP 类库",
            "date_modified": "2021-08-26T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "node",
                "http",
                "axios"
            ]
        },
        {
            "id": "second-blog-is-docusaurus",
            "content_html": "<p>博客地址: <a href=\"https://kuizuo.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">愧怍 (kuizuo.cn)</a></p><p>源码地址：<a href=\"https://github.com/kuizuo/blog\" target=\"_blank\" rel=\"noopener noreferrer\">kuizuo/blog: 愧怍的个人博客 (github.com)</a></p><p>时隔近半年没好好整理文章，博客也写的不像个人样。😂</p><p>大半年没更新博客，一直忙着写项目（写到手软的那种），然后无意间在 B 站看到一个 Up 主<a href=\"https://zxuqian.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">峰华前端工程师- 让你学会前端开发 (zxuqian.cn)</a>推荐的一个基于 React 驱动的静态网站生成器，其实也可以理解为就是 React 版的 Vuepress（主要都是文档类为主）。第一眼看到的时候惊艳到我了，代码也开源了，不妨搭建了一个，立马 git clone 了源码并翻看了下文档，就开始乏而无味的码字。</p><p>不过国内 docusaurus 的使用者是真的少。Vuepress 都快烂大街了...</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"搭建过程\">搭建过程<a class=\"hash-link\" href=\"#搭建过程\" title=\"标题的直接链接\">​</a></h2><p>首先还是要再鸣谢一下，基于这位大佬所开源的代码上进行二开（其实也就是换了个背景，删了一下谷歌的广告和 B 站视频的评论，还有一些不必要的百度推送和统计插件），然后就花了点是时间整理下这些年（其实就两年）所涉及的技术栈。</p><p>之所以会搭建该博客，主要是 kuizuo.cn 的域名也正好备案完了，但之前的那个博客实在些不下去了（毕竟半年没更新了），然后自己的技术栈也准备转型了，之前前端的技术栈，都是处于 Vue2.0 + JavaScript，vue2 差不多已经玩烂了（尤其是 element ui），书也看的差不多了，加之 Vue3 出了大半年了（前端技术更新迭代是真滴快），正好 B 站尚硅谷的视频出了<a href=\"https://www.bilibili.com/video/BV1Zy4y1K7SH\" target=\"_blank\" rel=\"noopener noreferrer\">【尚硅谷】2021 最新 Vue 迅速上手教程丨 vue3.0 入门到精通<!-- -->_<!-- -->哔哩哔哩<!-- -->_<!-- -->bilibili</a>（强烈推荐！！！），于是就趁暑假时间恶补了一手 Vue3，顺便找了一个开源项目<a href=\"https://vvbin.cn/doc-next/\" target=\"_blank\" rel=\"noopener noreferrer\">Vben Admin (vvbin.cn)</a>，所采用的都是最新的技术栈 Vue3、Vite、TypeScript（以后写新项目就靠它了），然后该博客又是基于 React ，所以索性把 React 给学了一下，便开始搭建该博客。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"背景\">背景<a class=\"hash-link\" href=\"#背景\" title=\"标题的直接链接\">​</a></h3><p>说一下部分更改的地方，首先就是主页的背景图了，这个是从网站<a href=\"https://undraw.co/\" target=\"_blank\" rel=\"noopener noreferrer\">unDraw - Open source illustrations for any idea</a>上找的一张 SVG 的图片，如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210815230103523.png\" alt=\"image-20210815230103523\" class=\"img_ev3q\"></p><p>怎么说呢，总感觉有些别扭（可能屏幕都是蓝色的搞得好像是 window 蓝屏似的），就暂时先用首页的这张图充当一下。到时候在重新设计一下吧。</p><p>补: 已更改为目前首页的背景</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"去谷歌广告\">去谷歌广告<a class=\"hash-link\" href=\"#去谷歌广告\" title=\"标题的直接链接\">​</a></h3><p>源代码中是有添加谷歌广告的，虽然说如果有一定的访问量，每个月也能有一笔额外收入，不过为了简洁和一些繁琐的广告，就在对应的代码处进行注释。（说不准以后会用的上呢）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"typescript-支持\">TypeScript 支持<a class=\"hash-link\" href=\"#typescript-支持\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docusaurus.io/zh-CN/docs/typescript-support\" target=\"_blank\" rel=\"noopener noreferrer\">TypeScript 支持 | Docusaurus</a></p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install --save-dev typescript @docusaurus/module-type-aliases @tsconfig/docusaurus</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>随后将以下内容添加到您的项目根目录的 <code>tsconfig.json</code>：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">tsconfig.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"extends\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"@tsconfig/docusaurus/tsconfig.json\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>但也只是改善编辑体验，不过就已经足够了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置-algolia\">配置 algolia<a class=\"hash-link\" href=\"#配置-algolia\" title=\"标题的直接链接\">​</a></h3><p><a href=\"https://docusaurus.io/zh-CN/docs/search\" target=\"_blank\" rel=\"noopener noreferrer\">搜索 | Docusaurus</a></p><p>有两种方式来配置algolia，一种是Docsearch 每周一次爬取你的网站，但前提是项目是<strong>开源的</strong>，其好处是申请后会直接给你<code>appId</code>、<code>apiKey</code>、<code>indexName</code>，直接填写至docusaurus.config.js即可。第二种则是自己运行DocSearch 爬虫，可以随时爬取，但需要自行去注册账号与搭建爬虫环境（docker）。</p><p>关于申请Algolia DocSearch在文档中有详细介绍，主要是要等，同时注意邮箱信息。如果申请成功后就可以在<a href=\"https://crawler.algolia.com/admin/crawlers\" target=\"_blank\" rel=\"noopener noreferrer\">Crawler Admin Console</a> 中查看</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220627232545640.png\" alt=\"image-20220627232545640\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"手动爬取\">手动爬取<a class=\"hash-link\" href=\"#手动爬取\" title=\"标题的直接链接\">​</a></h4><p><a href=\"https://docsearch.algolia.com/docs/run-your-own\" target=\"_blank\" rel=\"noopener noreferrer\">Run your own | DocSearch (algolia.com)</a></p><p>这里我叙述下第二种方式的配置的过程，首先去申请 <a href=\"https://www.algolia.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Algolia</a> 账号，然后在左侧 indices 创建索引，在 API Keys 中获取 Application ID 和 API Key（注意，有两个 API KEY）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210821230135749.png\" alt=\"image-20210821230135749\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210821230232837.png\" alt=\"image-20210821230232837\" class=\"img_ev3q\"></p><p>填入到<code>docusaurus.config.js</code>中的 API KEY 是 <strong>Search-Only API Key</strong></p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token literal-property property\" style=\"color:#f92672\">themeConfig</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">algolia</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">apiKey</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"xxxxxxxxxxx\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">appId</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"xxxxxxxxxxx\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">indexName</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>系统我选用的是 Linux，在 Docker 的环境下运行爬虫代码。不过要先 <a href=\"https://github.com/stedolan/jq/wiki/Installation#zero-install\" target=\"_blank\" rel=\"noopener noreferrer\">安装 jq </a> 我这里选择的是 0install 进行安装（安装可能稍慢），具体可以查看文档，然后在控制台查看安装结果</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">[root@kzserver kuizuo.cn]# jq --version</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">jq-1.6</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接着在任意目录中创建<code>.env</code>文件，填入对应的 APPID 和 API KEY（这里是<code>Admin API Key</code>，当时我还一直以为是 Search API Key 坑了我半天😭）</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token constant\" style=\"color:#e6db74\">APPLICATION_ID</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">YOUR_APP_ID</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">API_KEY</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#e6db74\">YOUR_API_KEY</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后创建<code>docsearch.json</code>文件，然后填入对应的配置代码，这里贴下配置<a href=\"https://github.com/algolia/docsearch-configs/blob/master/configs/docsearch.json\" target=\"_blank\" rel=\"noopener noreferrer\">docsearch-configs/docsearch.json</a></p><p>更改索引名与网站名</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockTitle_Ktv7\">docsearch.json</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"index_name\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"kuizuo\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"start_urls\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://kuizuo.cn/\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"sitemap_urls\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://kuizuo.cn/sitemap.xml\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  ...</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>运行 docker 命令</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">docker run -it --env-file=.env -e \"CONFIG=$(cat docsearch.json | jq -r tostring)\" algolia/docsearch-scraper</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接着等待容器运行，爬取你的网站即可。最终打开 algolia 控制台提示如下页面则表示成功</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210821225934002.png\" alt=\"image-20210821225934002\" class=\"img_ev3q\"></p><p>不过还是建议使用去申请Docsearch，其每周自动爬取站点，而不是手动爬取。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署\">部署<a class=\"hash-link\" href=\"#部署\" title=\"标题的直接链接\">​</a></h2><p>由于我是有个人的域名和服务器，所以之前部署项目都是直接将编译后的文件直接上传至服务器上，然后通过 nginx 就可以直接通过域名访问了，优点的话就是方便，但缺点很明显，每次更新一篇博客的话，就需要重新编译，然后重新拉去文件，并不能做到自动化编译部署。于是就想着采用第三方服务进行部署。</p><p>这里推荐使用Vercel，我写过一篇 <a href=\"/examenEbau/develop/Vercel部署个人博客\">Vercel部署个人博客</a> 的文章，部署十分简单。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"额外功能页面\">额外功能页面<a class=\"hash-link\" href=\"#额外功能页面\" title=\"标题的直接链接\">​</a></h2><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"资源导航\">资源导航<a class=\"hash-link\" href=\"#资源导航\" title=\"标题的直接链接\">​</a></h4><p>老早之前就想整理一下自己的网页书签，奈何一直都没怎么有空去处理（其实就是懒），有时候明明看到一个特别好的资源，然而几天后想在重新再找的时候就犹如海底捞针似的。书签收藏夹也是乱的不像样（咋和我电脑桌面和显示桌面一样乱呢，不过好在我有<a href=\"https://www.voidtools.com/zh-cn/\" target=\"_blank\" rel=\"noopener noreferrer\">EveryThing</a>）</p><p>相关链接：<a href=\"https://kuizuo.cn/resources\" target=\"_blank\" rel=\"noopener noreferrer\">资源导航</a></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"评论\">评论<a class=\"hash-link\" href=\"#评论\" title=\"标题的直接链接\">​</a></h4><p>相关文章: <a href=\"https://kuizuo.cn/develop/Docusaurus%E9%85%8D%E7%BD%AEGitalk%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6\" target=\"_blank\" rel=\"noopener noreferrer\">Docusaurus 配置 Gitalk 评论插件</a></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实战项目\">实战项目<a class=\"hash-link\" href=\"#实战项目\" title=\"标题的直接链接\">​</a></h4><p>相关链接：<a href=\"https://kuizuo.cn/project\" target=\"_blank\" rel=\"noopener noreferrer\">实战项目</a></p><p>确实写过挺多项目，但大多数不方便展示，要么是小工具类 demo，要么是客户定制的，这些总不好直接展示，所以一般展示的都是些非盈利性，功能性的，当然肯定是会附带源码的那种。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>我个人是比较满意该博客的，搜索，SEO，暗黑模式，博客列表，没有其他博客系统那么花里胡哨的，该有的整洁都有了，最主要是我个人不喜欢文章配背景图，尤其是那种与文章毫不相干的图，图片也许能减少阅读疲倦感，但欣赏的是内容的，而不是背景。</p><p>而且又是基于 Docusaurus，到时候是用来做一个项目的文档也方便许多。</p><p>还是要感谢下该大佬所开源的代码，同时 B 站视频教程也非常好，让我学到了一些前沿的前端技术。😄</p><p>也就不多浪费口舌了，博客既然搭建好了，那么接下来就可以专心的编写文章了。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/second-blog-is-docusaurus",
            "title": "第二个博客搭建之Docusaurus",
            "summary": "博客地址: 愧怍 (kuizuo.cn)",
            "date_modified": "2021-08-20T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "blog",
                "docusaurus",
                "project"
            ]
        },
        {
            "id": "lost-code-find-by-git",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"场景复现\">场景复现<a class=\"hash-link\" href=\"#场景复现\" title=\"标题的直接链接\">​</a></h2><p>今晚，我和往常一样对着电脑撸着代码，这时候我灵光一现，想到了一个好的功能，于是乎我就开始增加代码文件，更改之前已有的问题，当我实现完这个功能的时候，觉得可有可无，我想通过 Git 直接回退到我没有这个新功能的版本，把新增的文件和更改的文件全都给还原回去，然而在编写新功能的时候我忘记 Commit 了！！！（正常操作应该是新建一个分支，在新分支编写新功能），于是乎我点了如图操作（这里仅作为事件发生展示，并不为实际丢失个数）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210815141808996.png\" alt=\"image-20210815141808996\" class=\"img_ev3q\"></p><p>没错，清空所有更改过的代码。导致这些文件直接丢失（并不在回收站），包括写新功能前的代码和写新功能后的代码全都丢失了 😭！！！</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"找回前提\">找回前提<a class=\"hash-link\" href=\"#找回前提\" title=\"标题的直接链接\">​</a></h2><p>庆幸的时候，写新功能前的代码我成功 add 到了暂存区，只是未 Commit 而已，那么就能找回对应的文件（仅仅只是文件，并且没有文件名，项目结构都无法还原 ）。如果有 Commit 的话非常好找回，直接回退上一个版本即可，如果连 add 操作都没有的话，除非像 VScode 插件 Local History 或一些 IDE 有记录本地文件，不然恐怕是真的找不回了。。。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"开始找回\">开始找回<a class=\"hash-link\" href=\"#开始找回\" title=\"标题的直接链接\">​</a></h2><p>故，此次目的是找回 add 过而未 commit 的文件，首先打开 git bash 输入</p><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">git fsck --lost-found</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210815150520759.png\" alt=\"image-20210815150520759\" class=\"img_ev3q\"></p><p>进入<code>.git\\lost-found\\other</code></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210815153556495.png\" alt=\"image-20210815153556495\" class=\"img_ev3q\"></p><p>然后通过文本编辑器打开即可，如果是代码的话重命名对应的后缀，如果是图片这些就得对应删除前所对应的文件链接。名字是找不回来了，只能手动重命名。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"事后回想\">事后回想<a class=\"hash-link\" href=\"#事后回想\" title=\"标题的直接链接\">​</a></h2><p>可能这次丢失的仅仅只是几十个文件，下次丢失的可能就是一个项目了。所以在每次更改代码前做好备份才是首要做的，同时也感谢 git 这么好用的版本控制系统，不然这篇博客可能也不存在。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/lost-code-find-by-git",
            "title": "记一次git丢失代码找回",
            "summary": "场景复现",
            "date_modified": "2021-08-15T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "git",
                "code"
            ]
        },
        {
            "id": "redis-get-six-digit-number-invitation-code",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"需求\">需求<a class=\"hash-link\" href=\"#需求\" title=\"标题的直接链接\">​</a></h2><p>针对每一个用户（用户量在 10w 以下）随机生成的邀请码（仅限六位数字），<strong>且不重复</strong></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"思考\">思考<a class=\"hash-link\" href=\"#思考\" title=\"标题的直接链接\">​</a></h2><p>如果能把这个不重复条件去除，那么只需要使用<code>Math.random</code>然后取小数点后六位就行了，但可惜要求就是不能重复， 要是重复还得了，到时候注册的时候都不知道奖励给那个邀请码账号。同时还要求邀请码在六位且数字，这就导致即使随机生成的，会有一定的可能出现相同的邀请码。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"解决方案\">解决方案<a class=\"hash-link\" href=\"#解决方案\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"方案-1\">方案 1<a class=\"hash-link\" href=\"#方案-1\" title=\"标题的直接链接\">​</a></h3><p>先随机生成一个六位随机数字，然后在存的时候判断数据库是否存在该邀请码，如果存在那么就重新生成一个，直到该邀请码不存在，便存入。</p><p>优点：方便，如果用户量不大，完全可以\n缺点：用户量上来的情况下，判断邀请码是否存在有可能需要一段时间，并且由于需要判断，故性能欠缺</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"方案-2\">方案 2<a class=\"hash-link\" href=\"#方案-2\" title=\"标题的直接链接\">​</a></h3><p>利用 redis 的 set 数据类型，先将所有的邀请码存入到 set 中，然后通过 srandmember 随机获取一个数值，在通过 srem 删除该元素即可。</p><p>或者也可以通过 list 队列，将预先随机生成的六位不重复数字的所有集合统统添加到队列中，然后获取的时候通过 rpop 或 lpop 获取</p><p>优点：相当于空间换时间，无需判断，后期即便用户量上来的，也完全可以重新生成一批（七位或字母）重新导入</p><p>缺点：过于依赖 Redis，redis 服务一旦停止，便无法正常获取数据。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"实现\">实现<a class=\"hash-link\" href=\"#实现\" title=\"标题的直接链接\">​</a></h2><p>既然想都想了，那怎么能不实现呢。我这边仅仅是一个测试 Demo，利用的是方案 2，通过 set 数据类型进行获取相关代码如下</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"预先存入数据\">预先存入数据<a class=\"hash-link\" href=\"#预先存入数据\" title=\"标题的直接链接\">​</a></h3><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> key </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'code'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">genCode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> num </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">999999</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">100000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> num</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    client</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">sadd</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">err</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'数据导入完毕'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">genCode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"获取数据并删除\">获取数据并删除<a class=\"hash-link\" href=\"#获取数据并删除\" title=\"标题的直接链接\">​</a></h3><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 输出所有成员</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">client</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">smembers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">err</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 随机获取一个数据</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">client</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">srandmember</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">err</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  client</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">srem</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">key</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">err</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>整体耗时不会超过 3 分钟</p><p>通过<code>console.time()</code>获取数据耗时如下</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">default: 0.174ms</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>",
            "url": "https://onewhitethreee.github.io/examenEbau/redis-get-six-digit-number-invitation-code",
            "title": "Redis获取六位不重复数字（邀请码）",
            "summary": "需求",
            "date_modified": "2021-08-11T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "redis"
            ]
        },
        {
            "id": "api-style",
            "content_html": "<p>前后端数据交互，经常要和 Api 打交道，于是关于 Api 接口的设计，有必要好好写一写</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"restful-api-风格\">Restful api 风格<a class=\"hash-link\" href=\"#restful-api-风格\" title=\"标题的直接链接\">​</a></h2><p>首先还是得说一下<strong>REST 是设计风格而不是标准</strong>，也就是在写 api 接口的时候，喜欢就遵循。</p><p>这里举一个常见的 api 接口设计</p><p>常见的 CRUD 操作</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">list </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取列表</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token keyword\" style=\"color:#66d9ef\">get</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">add </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 添加用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">edit </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 编辑用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token keyword\" style=\"color:#66d9ef\">delete</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 删除用户</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>与之对应 Restful Api 风格</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token constant\" style=\"color:#e6db74\">GET</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> user </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取列表</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">GET</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> user </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获取用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> user </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 添加用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">PUT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> user </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 编辑用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">DELETE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> user </span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> id </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 删除用户</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// {id} 通过后端路由 参数Params可以获取到</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以看到 Restful 风格相比于正常的 POST 而言，少了请求的路径，而同时使用请求方法字段（GET,POST,PUT,DELETE） 要与之表明的意思也很明确（前提：在增删改查的时候），也就只是增删改查而已。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"我何时使用-restful\">我何时使用 Restful<a class=\"hash-link\" href=\"#我何时使用-restful\" title=\"标题的直接链接\">​</a></h2><p>这里我要说说我个人使用情况下，如果单单只是增删改查的话，我会使用 Restful 风格，好用是一方面，不必在修改数据的还要在 body 中添加 id 这个字段。其次 restful 确实也算广泛，但也仅仅只是在增删改查中。</p><p>实际业务中复杂情况太多了，有的时候仅仅这四个请求方法不能很明确的表达所要的意思，例如下面一些业务逻辑</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">login  发送登录请求</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">register  发送注册请求</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">info 获取个人信息</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">forget 忘记个人密码</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token constant\" style=\"color:#e6db74\">POST</span><span class=\"token plain\"> user</span><span class=\"token operator\" style=\"color:#66d9ef\">/</span><span class=\"token plain\">getCode  获取验证码</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>此外还有充值，获取消费记录、登录记录等等就不一一列举了，总之这时候我毫不犹豫会使用 POST，可能有人会好奇，为啥获取信息和获取验证码的时候要使用 POST 请求，用 GET 不好吗？好，但后文会说为什么。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"易猜测-api-接口\">易猜测 api 接口<a class=\"hash-link\" href=\"#易猜测-api-接口\" title=\"标题的直接链接\">​</a></h2><p>实际上，采用了 Restful 风格，几乎一猜就能猜到对应的 api。比如商品管理，无非就是获取商品列表，添加商品，编辑商品，删除商品。同时又传入的是对应的 ID，这要是 Mysql，ID 基本都是按顺序的，万一 api 鉴权没做好，都不知道数据怎么变动的。当然这种情况一般都是比较少见的了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"不易加密\">不易加密<a class=\"hash-link\" href=\"#不易加密\" title=\"标题的直接链接\">​</a></h2><p>上文不是说到为啥都要使用 POST 请求，原因也挺简单的，就是加密，GET 请求一般都不会携带过多参数，针对数据效验的话最多也就一个 MD5 效验，然而是远远不够的，而 POST 所能携带的数据不仅仅是 MD5 效验，还能携带风控算法，二次效验，浏览器指纹算法等等，能保证一定的防破解性。一些看似用 GET 请求方便的接口，但实际都要考虑所包含的风险，就如上面那个发送验证码的接口，如果不加以加密，特别容易仿造出与之对应的协议请求，再次仿造发送也不难。当然，对于这种限制类的业务，还是得要后端进行限制，例如 1 分钟只能发送一条，一天一号只能发送 10 条。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>其实可以发现绝大多数的网站基本上都不是采用 Restful 风格（貌似用的最多的也就是管理系统了），因为所涉及的业务逻辑实在是太复杂了，不单单只能使用请求方法来表明意思，有时候 Url 路径更能表达明确意思。</p><p>Restful 风格想的太美好了，然而实际业务中 很多时候并不能单纯的通过 get post put delete 这四种请求发送来表明真实意义，所以我在增删改查的时候才会使用 Restful api 风格。</p><p>在我写项目中遇到一些复杂业务逻辑，我是毫不犹豫使用 Post 请求的，然后通过 url 路径表明 api 所要请求的路径，同时编写 Swagger Api 文档。什么样的风格都因人而异，主要自己用的习惯就行，毕竟 api 接口只是风格，并不作为标准来衡量。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/api-style",
            "title": "Api接口风格",
            "summary": "前后端数据交互，经常要和 Api 打交道，于是关于 Api 接口的设计，有必要好好写一写",
            "date_modified": "2021-08-06T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "api"
            ]
        },
        {
            "id": "git-change-default-branch",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>GitHub 官方表示，从 2020 年 10 月 1 日起，在该平台上创建的所有新的源代码仓库将默认被命名为 \"main\"，而不是原先的\"master\"。值得注意的是，现有的存储库不会受到此更改影响。</p><p>也就是现在从 github 初始化的项目都是 main 分支，然而在此之前安装的 git 默认分支为 master，本地使用 git 创建项目都是 master，通过如下命令可更改默认分支的名字</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"命令\">命令<a class=\"hash-link\" href=\"#命令\" title=\"标题的直接链接\">​</a></h2><ul><li>修改默认分支为 <code>main</code> 分支</li></ul><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">git config --global init.defaultBranch main</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>修改当前项目的分支为 <code>main</code></li></ul><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">git branch -M main</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>要更改为其他名字 只需把 main 替换即可</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"要求\">要求<a class=\"hash-link\" href=\"#要求\" title=\"标题的直接链接\">​</a></h3><p>Git 版本为 <strong>v2.28</strong> 或更高 查看版本 <code>git --version</code></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/git-change-default-branch",
            "title": "git修改默认分支main",
            "summary": "前言",
            "date_modified": "2021-08-04T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "git"
            ]
        },
        {
            "id": "why-i-dont-use-qiniu-cloud",
            "content_html": "<p>七牛云是国内鲜有的免费提供对象存储服务的一个云服务商，和腾讯云，阿里云一样，但这两者收费，而七牛云不收费，当然也不是绝对免费，对象存储免费空间 10g，每个月还有 10g 的 cdn 加速服务（多数人基本用不完），超出部分额外收费，此外 https 收费。</p><p>我<strong>之前</strong>使用七牛云的主要原因，就是业内太多人推荐了，免费还带加速，存储博客图片好的不行，然而发生了如下的事情：</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"事情经过\">事情经过<a class=\"hash-link\" href=\"#事情经过\" title=\"标题的直接链接\">​</a></h2><p>让我不用七牛云的罪魁祸首其实是 Chrome 浏览器，先看一张图片。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201214211848873.png\" alt=\"image-20201214211848873\" class=\"img_ev3q\"></p><p>What？图片呢？第一时间毫不犹豫打开控制台查看问题所在，有这样几行报错</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201214212056058.png\" alt=\"image-20201214212056058\" class=\"img_ev3q\"></p><p>关注第一行</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Mixed Content: The page at '&lt;URL&gt;' was loaded over HTTPS, but requested an insecure element '&lt;URL&gt;'. This request was automatically upgraded to HTTPS, For more information see &lt;URL&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>翻译过来就是：网页混合内容:页面是通过 HTTPS 加载，但却请求一个不安全元素 HTTP。该请求被自动升级为 HTTPS，更多信息请参见。</p><p>管他啥意思，先百度，然后才了解到，在 Chrome 浏览器高版本中（具体多少忘了），如果当前站点是 https，那么会自动将页面请求的 http 升级为 https，也就是说，我当前站点是 https 协议，访问不了 http 的资源，然而这可坑惨我了，我的图片全都放在七牛云上，然而七牛云的 HTTPS 是收费的，那时候我也抱着白嫖的心态，去嫖了七牛云的对象存储来做图床，现在我将<a href=\"http://kzcode.cn\" target=\"_blank\" rel=\"noopener noreferrer\">http://kzcode.cn</a> 升级为<a href=\"https://kzcode.cn\" target=\"_blank\" rel=\"noopener noreferrer\">https://kzcode.cn</a> 的时候，就意味这我不能白嫖了？也就是出现了如上画面，然后又去相关了一些百度相关的知道，看看有没有解决办法，如下</p><ul><li>使用其他浏览器</li></ul><p>这个问题只有 Chrome 浏览器内才有，在 https 站点会将 http 请求自动升级为 https，在其他浏览器不会，上面的图片也会正常显示。</p><ul><li>要么都用 HTTP，要么都用 HTTPS</li></ul><p>http 站点去请求 https 资源会不安全，而 https 站点去请求 http 会自动升级为 https，而这没有很好的有效方法去让两者兼容。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"选择\">选择<a class=\"hash-link\" href=\"#选择\" title=\"标题的直接链接\">​</a></h2><p>既然搜到解决办法后，我心想，这网站怎么能不上 HTTPS，怎么能让左上角的锁不安全呢。用了 HTTPS 是不可能回去的了，同时怎么能保证别人用的浏览器不是 Chrome 浏览器呢，于是毅然决然的将所有将图片升级为 HTTPS 了，然而在对比后各家的对象存储服务，我选择了腾讯云，先放一张比对图：</p><table><thead><tr><th>运营商</th><th>价格(元/GB)</th><th>活动</th></tr></thead><tbody><tr><td>阿里云</td><td>HTTP 0.24<br>HTTPS 需要额外加一点请求费</td><td>无</td></tr><tr><td>腾讯云</td><td>HTTP 和 HTTPS <strong>统一 0.21</strong></td><td>前 6 个月每个月送 20GB 国内流量</td></tr><tr><td>七牛云</td><td>HTTP <strong>0.24</strong> (超出免费 10GB)<br>HTTPS <strong>0.28</strong></td><td>每个月送 <strong>10GB HTTP 流量</strong> (国内外均可使用) 以及 5 万次动态加速请求数</td></tr></tbody></table><p>可以看到如果你每个月的请求流量都在 10GB 以内，且不用 HTTPS，七牛云肯定是最好的选择，然而我目前的站点是需要 HTTPS 的，并且七牛的 HTTPS 费用高出其他两家，甚至可以说，用了 HTTPS，就没必要选择七牛云！一没优势，速度优化不到哪里去，二是你完全可以相信大厂，三是服务费用还比两者贵。同时我云服务器也是腾讯云的，肯定优先选择腾讯，于是把对象存储换为了腾讯云，早知道就一开始就直接用腾讯的对象存储服务，果然还是花钱实在，白嫖太麻烦了。</p><blockquote><p>参考链接 <a href=\"https://blog.txzhou.com/website/compare-cdn.html\" target=\"_blank\" rel=\"noopener noreferrer\">阿里云、腾讯云、七牛云 CDN 对比</a></p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"最后\">最后<a class=\"hash-link\" href=\"#最后\" title=\"标题的直接链接\">​</a></h2><p>本文的标题并不是说七牛云不好，而是我所遇到的情形让我放弃了使用七牛云，相信你看完了上面所说的，能对你的网站有个存储有个明确的配置，你在哪买服务器了，还是在哪去买其他相关的业务，没必要花费时间去折腾，说到底还是花钱实在。并且价格实际上对一个小网站来说，已经是可以非常低了（当然还是有些人会想着白嫖）</p><p>总结下来其实就是，如果你的网站不准备挂 SSL 证书，也就是通过 http 请求访问，那么白嫖七牛云，没问题，好用，但如果你的网站一旦挂了 SSL 证书，我的建议是直接删了七牛云的对象存储。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/why-i-dont-use-qiniu-cloud",
            "title": "为什么我不用七牛云",
            "summary": "七牛云是国内鲜有的免费提供对象存储服务的一个云服务商，和腾讯云，阿里云一样，但这两者收费，而七牛云不收费，当然也不是绝对免费，对象存储免费空间 10g，每个月还有 10g 的 cdn 加速服务（多数人基本用不完），超出部分额外收费，此外 https 收费。",
            "date_modified": "2020-12-23T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "cloud-service"
            ]
        },
        {
            "id": "tencent-cloud-cdn-and-ssl",
            "content_html": "<p>如题，本人所购买的服务器，以及对象存储，CDN，和 SSL 都是腾讯云的。</p><p>在这篇文章我会简单明细的讲一下我花了一个整个晚上都在腾讯云-控制台做了些什么，也助于自己到时候忘记腾讯云服务器相关操作做个笔记。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云服务器\">云服务器<a class=\"hash-link\" href=\"#云服务器\" title=\"标题的直接链接\">​</a></h2><p>先看看我的云服务器配置</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215004521965.png\" alt=\"image-20201215004521965\" class=\"img_ev3q\"></p><p>腾讯云那时候做活动，花了 298 块买了 3 年 1 核 2g 内存 1m 带宽，够了，这里我要提一点，如果了解过云服务器的话，可能还会看到轻量应用服务器，而且这个轻量应用服务器竟然配置和云服务器差不多，并且价格还便宜，我先放两张图看看</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215005635518.png\" alt=\"image-20201215005635518\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215005553889.png\" alt=\"image-20201215005553889\" class=\"img_ev3q\"></p><p>可以看到云服务器可以安装 Window，Linux 系统，而轻量应用服务器则是这些的分支，就这么说的，如果我的服务端只涉及到 nodejs 相关的，那么我大可购买轻量应用服务器，然而多数都是去买云服务器，毕竟可拓展高。两者价格在不是新用户的情况下，云服务器 1g1h1m 一年 662 元，而轻量应用服务器才 408 元。没错，不是新用户服务器就是这么贵。。。</p><p>说了这么多题外话，说下云服务器有一个重要的地方就是安全组<img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215011238478.png\" alt=\"image-20201215011238478\" class=\"img_ev3q\"></p><p>这里在宝塔面板中，设置了放行端口，此外腾讯云安全组也要设置，不过这里我是入站和出站都设置一键放通，主要方便，也懒得设置了。</p><p>此外云服务器大致就如此，基本上宝塔安装后，就没腾讯云的云服务器面板什么事情了，有关云服务器与域名备案我在另一篇文章也写到过 <a href=\"/examenEbau/云服务器与域名备案\">云服务器与域名备案</a></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"cdn\">CDN<a class=\"hash-link\" href=\"#cdn\" title=\"标题的直接链接\">​</a></h2><p>关于 CDN 的介绍，本人不敢多言，怕讲不好。简单来说，挂了 CDN，你的网站就能加速，然而实际原理没这么简单，就不过多叙述这些了，外面也有很多关于 CDN 的相关资料，可以自行翻阅。</p><p>首先，你需要开通 CDN，进入内容分发网络页面会有提示开启。此外到腾讯云有个优惠，新用户 6 个月每个月免费送 20g 回溯流量，此外付费的流量包中，一年也才 19 块，不说，先买了。</p><p>在腾讯云-控制台中，主要关注两个点</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215013943201.png\" alt=\"image-20201215013943201\" class=\"img_ev3q\"></p><p>一个是要加速网站的域名，还有一个就是网站的 SSL 证书，这在下文会说到。</p><p>在这里可以添加一个域名，比如<code>test.kzcode.cn</code>（后文也会以这个二级域名为例）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215014206851.png\" alt=\"image-20201215014206851\" class=\"img_ev3q\"></p><p>根据相应的业务需求来填写，点击下方的确认提交即可。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215014459988.png\" alt=\"image-20201215014459988\" class=\"img_ev3q\"></p><p>接着点击 DNS 解析页面，将 CNAME 的值复制到对应的 DNS 解析，如</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215014619557.png\" alt=\"image-20201215014619557\" class=\"img_ev3q\"></p><p>点击保存，然后回到 CDN 页面（内容分发网络），可以看到此时的状态已变为已启动。这时候你的网站就成功加速了，而不是用那 1m 的带宽去从服务器内拉去大的一笔的静态资源。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"ssl-证书\">SSL 证书<a class=\"hash-link\" href=\"#ssl-证书\" title=\"标题的直接链接\">​</a></h2><p>现在你的网站能访问速度得到了提升，但是出现了下面的这样警告（原谅我实在不想用 test.kzcode.cn 来测试）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215012031362.png\" alt=\"image-20201215012031362\" class=\"img_ev3q\"></p><p>如果你不希望你的网站出现像这样的不安全警告，那么就很有必要设置 SSL 证书，请求的时候就是 https 而不是 http，好在 SSL 证书不算太难，并且上面 CDN 加速你也弄了，这里我把腾讯云的 SSL 证书简单复刻一遍。</p><p>在 SSL 证书，点击申请免费证书</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215012211483.png\" alt=\"image-20201215012211483\" class=\"img_ev3q\"></p><p>点击确定，输入要绑定的域名，如<code>test.kzcode.cn</code>，和正常注册一样，默认下一步，下一步，接着稍等片刻，等待免费证书签发。SSL 证书有效期一年，一年后就需要重新部署了。然后返回到我的证书，看到成功添加了一条证书</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215013035429.png\" alt=\"image-20201215013035429\" class=\"img_ev3q\"></p><p><strong>先点击下载，下载到桌面，后面会用到的</strong>，不然待会还要回来下载。然后点击右边的部署。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210808150559353.png\" alt=\"image-20210808150559353\" class=\"img_ev3q\"></p><p>部署类型选择内容分发网络（CDN），点击确定\n随后会跳转到证书配置页面，刚刚设置的域名 test.kzcode.cn 还有申请的免费 SSL 证书 test，选择腾讯云托管证书，向下图这样提交</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215015319153.png\" alt=\"image-20201215015319153\" class=\"img_ev3q\"></p><p>提示配置成功，这时候打开宝塔面板。添加一个站点</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215015549597.png\" alt=\"image-20201215015549597\" class=\"img_ev3q\"></p><p>点击设置，在左侧侧边栏中的 SSL 中的选其他证书，上面叫你下载的证书下了吧，好的，打开它，其中一个文件为 Nginx，将里面的两个文件通过文本来打开（<strong>是通过文本，而不是双击直接打开</strong>），将.key 文件的内容放到密钥上，将.crt 文件的内容放到证书上，然后点击保存，顺便把右上角强制 HTTPS 勾选上</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215020231348.png\" alt=\"image-20201215020231348\" class=\"img_ev3q\"></p><p>打开网页，现在你访问<a href=\"https://test.kzcode.cn\" target=\"_blank\" rel=\"noopener noreferrer\">test.kzcode.cn</a>，就能得到如下结果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201215020429502.png\" alt=\"image-20201215020429502\" class=\"img_ev3q\"></p><p>连接是安全的，证书有效，恭喜，站点创建成功！</p><hr><p>至此，一个二级域名 test.kzcode.cn，并带有 SSL 证书与 CDN 加速的站点便成功部署！</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>整个过程写下来，其实给我的感受就是写给未来某一时刻去重新折腾腾讯云的一篇文章，从头到尾，我也只是把这些操作重新复刻一遍，然后写成这篇文章。</p><p>在折腾了一晚上的云服务器，腾讯云给我的一大特点就是好用，并且文档详细。果然这就是大厂的资本吗，爱了爱了。并且新用户所涉及的金额并不多，甚至我都没感觉到我到底有没有花钱在网站部署上（等到时候网站人流量来的，估计就要花大价钱了）。并且执行了上面的操作，我的网站确实有所提高速度，不过还没完，云服务中还有一个挺重要的一部分还没讲到，也就是对象存储，留个小坑，有时间在写。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/tencent-cloud-cdn-and-ssl",
            "title": "腾讯云之CDN与SSL配置",
            "summary": "如题，本人所购买的服务器，以及对象存储，CDN，和 SSL 都是腾讯云的。",
            "date_modified": "2020-12-15T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "cloud-services"
            ]
        },
        {
            "id": "content-type-of-http-request",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"content-type\">Content-type<a class=\"hash-link\" href=\"#content-type\" title=\"标题的直接链接\">​</a></h2><p>先看一条 HTTP 请求</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">POST https://xxx.kuizuo.cn/v2/login HTTP/1.1</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Host: xxx.kuizuo.cn</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Length: 121</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">// Content-Type: application/json;charset=UTF-8</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept: application/json, text/plain, */*</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{\"username\":\"kuizuo\",\"password\":\"a12345678\"}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>上面那个请求发送到我的服务器，服务器却接收到的是这样一串值</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"{\\\"username\\\":\\\"kuizuo\\\",\\\"password\\\":\\\"a12345678\\\"}\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>很显然，它把 json 格式解析成了 x-www-form-urlencoded。</p><p>一个很简单的登录请求，注意一个协议头<code>Content-Type</code>，它决定了你的数据发送到服务端上会是什么格式。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">类型格式：type/subtype(;parameter)?</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">type 主类型，任意的字符串，如text，如果是*号代表所有；</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">subtype 子类型，任意的字符串，如html，如果是*号代表所有；</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">parameter 可选，一些参数，如Accept请求头的q参数， Content-Type的charset参数。</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>常见的媒体格式类型如下：</p><ul><li><p>text/html ： HTML 格式</p></li><li><p>text/plain ：纯文本格式</p></li><li><p>text/xml ： XML 格式</p></li><li><p>image/gif ：gif 图片格式</p></li><li><p>image/jpeg ：jpg 图片格式</p></li><li><p>image/png：png 图片格式</p><p>以 application 开头的媒体格式类型：</p></li><li><p>application/xhtml+xml ：XHTML 格式</p></li><li><p>application/xml ： XML 数据格式</p></li><li><p>application/atom+xml ：Atom XML 聚合格式</p></li><li><p>application/json ： JSON 数据格式</p></li><li><p>application/pdf ：pdf 格式</p></li><li><p>application/msword ： Word 文档格式</p></li><li><p>application/octet-stream ： 二进制流数据（如常见的文件下载）</p></li><li><p>application/x-www-form-urlencoded ： form 表单数据被编码为 key/value 格式（通过=与&amp;拼接）发送到服务器（表单默认的提交数据的格式）格式如: username=kuizuo&amp;password=a12345678</p><p>另外一种常见的媒体格式是上传文件之时使用的：</p></li><li><p>multipart/form-data ： 需要在表单中进行文件上传时，就需要使用该格式</p></li></ul><p>实际上遇到最多的也就是 text/html，text/plain，application/json，application/x-www-form-urlencoded 这几个。</p><blockquote><p>参考资料 <a href=\"https://www.cnblogs.com/klb561/p/10090540.html\" target=\"_blank\" rel=\"noopener noreferrer\">Http 请求中 Content-Type</a></p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"说说我那时候的情况\">说说我那时候的情况<a class=\"hash-link\" href=\"#说说我那时候的情况\" title=\"标题的直接链接\">​</a></h3><p>这是在我帮别人分析登录算法的时候，由于协议头中少添加了一个<code>Content-Type</code>，导致我发送的数据，服务端解析不了，收到了这样的响应</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"code\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">500001</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"message\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"亲，我们的系统目前忙碌中或无法回应，请将此问题回报给我们的客服人员。 错误代碼(68523)\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"data\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然而实际响应应该是这样的</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"code\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">400020</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"message\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"密码错误\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"data\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"验证码错误\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>原因就是因为协议头没有添加<code>Content-Type: application/json;charset=UTF-8</code>所导致的。因为这个，坑了我近一个小时，还一直以为是数据错误，没想到仅仅只是少加了一些协议头导致的请求数据格式错误。</p><p>一个印象很深刻的教训，模拟 HTTP 请求的时候，一定不要吝啬补全协议头，不然坑的就是自己了。我已经给坑过两次了，所以在特意想借此记录一下，免得下次又是一番折腾。写个注意，醒目一点。</p><div class=\"admonition admonition-danger alert alert--danger\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"16\" viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z\"></path></svg></span>danger</h5></div><div class=\"admonition-content\"><p>发送的是 JSON 格式数据，切记一定要添加上协议头<code>Content-Type: application/json;charset=UTF-8</code>！！！</p></div></div>",
            "url": "https://onewhitethreee.github.io/examenEbau/content-type-of-http-request",
            "title": "HTTP请求之Content-Type",
            "summary": "Content-type",
            "date_modified": "2020-12-12T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "http"
            ]
        },
        {
            "id": "cookie-of-node-and-browser",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>记录一下自己在 nodejs 中使用 http 请求库 axios 中的一些坑（针对 Cookie 操作）</p><p>不敢说和别人封装的 axios 相比有多好，但绝对是你能收获到 axios 的一些知识，话不多说，开始</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"封装\">封装<a class=\"hash-link\" href=\"#封装\" title=\"标题的直接链接\">​</a></h2><p>一般而言，很少有裸装使用 axios 的，就我涉及的项目来说，我都会将 axios 的 request 封装成一个函数使用，接着在 api 目录下，引用该文件。项目结构一般是这样的：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">|-- src</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- api</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        |-- user.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        |-- goods.js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    |-- utils</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        |-- request.js</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"requestjs\">request.js<a class=\"hash-link\" href=\"#requestjs\" title=\"标题的直接链接\">​</a></h4><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">axios</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'axios'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> instance </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">create</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">baseURL</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> process</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">env</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token constant\" style=\"color:#e6db74\">API</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// node环境变量获取的Api地址</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">withCredentials</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 跨域携带Cookies</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">timeout</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 设置请求拦截器</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 在config可以添加自定义协议头 例如token</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'x-token'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'xxxxxxxx'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> config</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据对应的业务代码 对返回数据进行处理</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> response </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> error</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 状态码为4或5开头则会报错</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 根据根据对应的错误,反馈给前端显示</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">status</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">404</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'请求资源路径不存在'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 断网......</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> instance</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>实际上，上面那样的封装就够了，相对于的业务代码就不补充了，如果你的宿主环境是浏览器的话，很多东西你就没必要在折腾的，甚至下面的文章都没必要看（不过还是推荐你看看，会有帮助的）。不过没完，再看看 api 里怎么使用的</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"apiuserjs\">api/user.js<a class=\"hash-link\" href=\"#apiuserjs\" title=\"标题的直接链接\">​</a></h4><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">request</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'@/utils/request'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">login</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/user/login'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">method</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'post'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">info</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/user/info'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">method</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'get'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">logout</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'/user/logout'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">method</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'post'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>看来很简单，没错，就是这么简单，由于是运行在浏览器内的，所以像 cookies，headers 等等都没必要设置，浏览器会自行携带该有的设置，其实想设置也设置不了，主要就是浏览器内置跨域问题。<a href=\"https://fetch.spec.whatwg.org/#concept-header-name\" target=\"_blank\" rel=\"noopener noreferrer\">XMLHttpRequest</a></p><p>就这？感觉你写的跟别人没什么区别啊</p><p>别急，下面才是重头戏。也是我为啥标题只写 axios，而不写 vue-axios 或者 axios 封装的原因。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"踩坑-cookies-获取与设置\">踩坑 Cookies 获取与设置<a class=\"hash-link\" href=\"#踩坑-cookies-获取与设置\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"浏览器\">浏览器<a class=\"hash-link\" href=\"#浏览器\" title=\"标题的直接链接\">​</a></h3><p>运行环境在浏览器中，axios 是无法设置与获取 cookie，获取不到 set-cookies 这个协议头的（即使服务器设置了也没用），先看代码与输出</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'cookie=this_is_cookies;username=kuizuo;'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'config.headers'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> config</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">instance</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'response.headers'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>控制台结果：</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201210060704240.png\" alt=\"image-20201210060704240\" class=\"img_ev3q\"></p><p>首先，就是圈的这个，浏览器是不许允许设置一些不安全的协议头，例如 Cookie，Orgin，Referer 等等，即便你看到控制台 config.headers 确实有刚刚设置 cookie，但我们输出的也只是 headers 对象，在 Network 中找到这个请求，也同样看不到 Cookie 设置的（这就不放图了）。</p><p>同样的，通过响应拦截器中输出的 headers 中也没有 set-cookies 这个字样。网络上很多都是说，添加这么一行代码 <code>withCredentials: true</code>，确实，但是没说到重点，都没讲述到怎么获取 cookies 的，因为在<strong>浏览器环境中 axios 压根就获取不到 set-cookies 这个协议头</strong>，实际上 axios 就没必要，因为浏览器会自行帮你获取服务器返回的 Cookies，并将其写入在 Storage 里的 Cookies 中，再下次请求的时候根据同源策略携带上对应的 Cookie。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201210061627824.png\" alt=\"image-20201210061627824\" class=\"img_ev3q\"></p><p>要获取也很简单，vue 中通过<code>js-cookie</code>模块即可，而在 electron 中通过<code>const { session } = require('electron').remote</code> （electron 可以设置允许跨域，好用）有关更多可以自行查看文档。</p><p>那我就是想要设置 Cookies，来跳过登录等等咋办，我的建议是别用浏览器来伪装 http 请求。跨域是浏览器内不可少的一部分，并且要允许跨域过于麻烦。有关跨域，我推一篇文章<a href=\"https://juejin.cn/post/6844904126246027278\" target=\"_blank\" rel=\"noopener noreferrer\">10 种跨域解决方案（附终极大招）</a></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"完整封装代码\">完整封装代码<a class=\"hash-link\" href=\"#完整封装代码\" title=\"标题的直接链接\">​</a></h4><p>::: details 查看代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">axios</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'axios'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">MessageBox</span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token imports\"> </span><span class=\"token imports maybe-class-name\">Message</span><span class=\"token imports\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'element-ui'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">store</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'@/store'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token imports\"> getToken </span><span class=\"token imports punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'@/utils/auth'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> service </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">create</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">baseURL</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> process</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">env</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token constant\" style=\"color:#e6db74\">VUE_APP_BASE_API</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">withCredentials</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">timeout</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">service</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">store</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">getters</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">token</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      config</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'x-token'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">getToken</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> config</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">service</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">interceptors</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">code</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">200</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Error'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'未知错误'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">response</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">switch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">status</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">400</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'非法请求'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">401</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">MessageBox</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">alert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'当前登录已过期，请重新登录'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'提示'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">confirmButtonText</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'重新登录'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'warning'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            store</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">dispatch</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'user/logout'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">then</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">              </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">location</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">reload</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">403</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'非法请求'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          router</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">push</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'/401'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">404</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'请求资源不存在'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#66d9ef\">case</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">500</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'服务器开小差啦'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">break</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">statusText</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token maybe-class-name\">Message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">msg</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'请检查网络连接状态'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Promise</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">reject</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">error</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">default</span><span class=\"token plain\"> service</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>:::</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nodejs\">Nodejs<a class=\"hash-link\" href=\"#nodejs\" title=\"标题的直接链接\">​</a></h3><p>作为 nodejs 的主流 http 框架怎么能只用在浏览器上，nodejs 自然而然可以，不过 nodejs 需要配置的可就多了，在 nodejs 环境中，自然没有浏览器的同源策略，像上面设置不了的 Cookie，现在随便设置，先看看我是怎么封装的：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports\">axios</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'axios'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports operator\" style=\"color:#66d9ef\">*</span><span class=\"token imports\"> </span><span class=\"token imports keyword module\" style=\"color:#66d9ef\">as</span><span class=\"token imports\"> http</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'http'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">import</span><span class=\"token plain\"> </span><span class=\"token imports operator\" style=\"color:#66d9ef\">*</span><span class=\"token imports\"> </span><span class=\"token imports keyword module\" style=\"color:#66d9ef\">as</span><span class=\"token imports\"> https</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"color:#66d9ef\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'https'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"color:#66d9ef\">export</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">async</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">opt</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> method </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'get'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> headers </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> cookies</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> opt</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'User-Agent'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'Referer'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> url</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">typeof</span><span class=\"token plain\"> cookies </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'object'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'Cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">Object</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">keys</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cookies</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">k</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">encodeURIComponent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">k</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'='</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">encodeURIComponent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cookies</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">k</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">join</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'; '</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">typeof</span><span class=\"token plain\"> cookies </span><span class=\"token operator\" style=\"color:#66d9ef\">===</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'string'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'Cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> cookies</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> options </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">method</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> method</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">headers</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> queryString</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">httpAgent</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">http</span><span class=\"token class-name punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token class-name\" style=\"color:#e6db74\">Agent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">keepAlive</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">httpsAgent</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">https</span><span class=\"token class-name punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token class-name\" style=\"color:#e6db74\">Agent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">keepAlive</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">rejectUnauthorized</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">timeout</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">5000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">try</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">axios</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">options</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">catch</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">message</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// test.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">const</span><span class=\"token plain\"> request </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'./request'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> url </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'https://passport2.chaoxing.com/fanyalogin'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">fid</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'-1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">uname</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'15212345678'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">password</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'a12345678'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">refer</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'http%253A%252F%252Fi.mooc.chaoxing.com'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">t</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'true'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> headers </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> cookies </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'username=kuizuo;uid=123;'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> res </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">await</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    cookies</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'test -&gt; res.headers'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>测试一下，顺便抓一下包，看看请求包</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">GET /fanyalogin HTTP/1.1</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept: application/json, text/plain, */*</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Referer: https://passport2.chaoxing.com/fanyalogin</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Cookie: username=kuizuo;uid=123;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Host: passport2.chaoxing.com</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Length: 100</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">....</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>有我们自定义的 Cookie，在看看响应的协议头</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">test </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">headers</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">server</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Tengine'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">date</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Thu, 10 Dec 2020 00:24:15 GMT'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string-property property\" style=\"color:#f92672\">'content-type'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text/html'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string-property property\" style=\"color:#f92672\">'content-length'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'1852'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">connection</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'keep-alive'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">vary</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'Accept-Encoding'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string-property property\" style=\"color:#f92672\">'set-cookie'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">'JSESSIONID=4365A6B9FD8E0CBADDBDD7E7DA468F7E; Path=/; HttpOnly'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#a6e22e\">'route=b2eda164bddd148142a54809ef404926;Path=/'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string-property property\" style=\"color:#f92672\">'accept-ranges'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'bytes'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">etag</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'W/\"1852-1606444212000\"'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>同样能获取到 set-cookie，设置与获取都是这么 so easy ，不同于上面浏览器的配置。</p><p>这里我要说明一些东西，在封装代码中有个 httpAgent 与 httpsAgent，你可以字面翻译就是 http 代理，设置它用来干嘛呢，其中有这么个属性 <code>keepAlive: true</code> ，如果设置了协议头中的将会有 <code>Connection: keep-alive</code>，而不设置则 <code>Connection: close</code>，这里也不想过多说明 http 相关知识，如果只是请求一次,那么两者没有太大区别</p><p>然而如果我请求一次,过一会(几秒内)又要请求了,那么 keep-alive 一次连接就可以处理多个请求，而 close 则是一次请求后就断开，下次就需要再次连接。说白了就是快一点，而 close 需要不断连接，断开，自然而然就慢。一般来说设置 keep-alive 就对了。</p><p>其中在 httpsAgent 中，还有一个属性<code>rejectUnauthorized: false</code>，说简单点，就是不抛出验证错误，在抓 nodejs 包的时候，如果不通过设置代理服务器（Fiddler，Charles），而是通过网卡（HTTP Analyzer，Wireshark）就会抛出异常，一般就会出现这种错误。</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Error: unable to verify the first certificate</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然而问题就来了，服务端的返回的 set-cookie 该怎么保存。如果只是涉及客户端层面的，想写一个模拟 http 请求的，直接将获取到的 cookies 与原有的 cookie 合并即可。我那时候的代码就是这样：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newCookie </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">header</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'set-cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">header</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">'set-cookie'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">map</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> a</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">split</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">';'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">join</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'; '</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// mergeCookie 就是将两者cookie 拼接而成</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> newCookies </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">mergeCookie</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">cookies</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> newCookie</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">cookie</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> newCookies</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"> res</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后返回响应中携带 res.cookies 即可，下次请求的时候再将其在带上。</p><p>如果只是，利用 nodejs 来实现类似爬虫，模拟登录，然后利用登录后的 cookie，来获取用户信息。如果不希望手动处理 cookies 的话，我其实还是推荐一个 http 模块，superagent，做一些小爬虫和模拟请求挺好用的，就不做过多介绍了。不过由于 nestjs 中自带 axios 模块，加上需要转发 http 请求，于是我就自行封装了一个 axios。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>实际上，axios 会根据当前环境，来创建 xhr 对象（浏览器）还是 http 对象（nodejs），在我那时候都以为 axios 是两个共用的，初学 electron 的时候，一直卡在 http 请求的配置</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  // `adapter` allows custom handling of requests which makes testing easier.</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  // Return a promise and supply a valid response (see lib/adapters/README.md).</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  adapter: function (config) {</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    /* ... */</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  },</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 axios 中也有这么一段配置，翻看了 lib/adapters 下目录我才瞬间醒悟过来，两者环境是不同的。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201210214055696.png\" alt=\"image-20201210214055696\" class=\"img_ev3q\"></p><p>就我使用而言，在浏览器环境下 axios 处理的特别好，允许设置拦截器处理请求与响应，但在 nodejs 下在处理模拟请求确实不如 Python 的 request 模块，奈何 axios 最大的便携就是能直接在浏览器中，尤大推荐的 http 请求库也是 axios。</p><p>实际上还涉及到了 nodejs 中转发请求的，再给自己留一个坑。</p><p>在写这篇文章的时候，我其实都没读过 axios 的源码，说实话，那时候遇到问题，就不应该愚昧的去搜索，去不断尝试，有时候直接通过翻看底层代码，可以一目了然自己所面临问题的解决方式。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/cookie-of-node-and-browser",
            "title": "node与浏览器中的cookie",
            "summary": "前言",
            "date_modified": "2020-12-10T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "node",
                "axios",
                "cookie"
            ]
        },
        {
            "id": "server-and-domain-beian",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>首先，如果要做个人网站，域名备案是必不可少的，不必记录输了几十遍的 ip 还记不住的 ip，输入好记的域名即可访问。但有遗憾的地方就是没能注册到自己想要的域名（其实就是给别人先注册了），域名这东西请优先准备好。先买就完事了，备案解析啥的完全不急，一年也就是几十块钱，但是你不先买就很有可能给别人先注册，到时候想买都没得买，不然就是花大价格购买。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"云服务器\">云服务器<a class=\"hash-link\" href=\"#云服务器\" title=\"标题的直接链接\">​</a></h2><p>服务器说白就是全天 24 小时不停歇的运行一台电脑，同时分配一个 IP 给这个电脑，你只需要把你要的资源放置到这台电脑上，别人通过访问 IP 就能访问到这台电脑的资源，比如你放一个网页在上面，别人访问 IP 就能访问到这个网页显示给你。实际上，自己使用的电脑也能充当网络服务器，只需要连接路由器，对路由器进行公网的配置，别人访问你路由器的 IP 就能访问到你电脑的资源，但不推荐，容易被攻击（反正我是弄了半天没配置成功放弃了）。</p><p>我用过百度云的服务器，配置的还是 windows 系统。那时候的网络验证和图象识别服务器是易语言写的，只会打包 exe 文件，加上 windows 上手易用，所以就搞了 windows 系统。</p><p>这里我要吐槽一下，当时服务器买的贼便宜，带宽 1m、1 核 cpu、1g 内存，新用户实名一年 60 块（当初就买来玩，没想到还用上了），用 windows 系统做服务器的时候，开个 mysql 服务，直接没了近 800m 内存，然后软件后台在运行一下，服务器经常崩溃，也就是一周，我就要时不时重启个 1,2 次，然后等待重启的几分钟，然后在用远程桌面连接到服务器，然后手动在启动服务，接着在等待下一次未知的崩溃。</p><p>用百度云的服务器，我总结了几点</p><ol><li>再也不买 1g 运行内存</li><li>再也不搭建 windows 服务器</li><li>再也不买百度云的产品了。</li></ol><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"关于服务器的配置\">关于服务器的配置<a class=\"hash-link\" href=\"#关于服务器的配置\" title=\"标题的直接链接\">​</a></h3><p>一般来说，一些提供云服务器的厂商都会给新用户一个新用户价，差不多也就是 100 左右一年的云服务器,配置一般都是 2g 内存,1 核,1m 带宽,50g 硬盘说实话对于没有特殊需求的服务器够用了。而不是新用户的价格，这样的配置一个月差不多 70 元，算一下一年打折后 700 元，这还算便宜的了，服务器贵这很正常，全天不间断运行，电费，网费和一些服务费用，值了都。</p><p>其他几个配置没什么可说的，主要还是说一下这个带宽，1M 的宽带理论上传速度为 128kB/s，也就是我从服务器中下载一个 10m 的软件，需要 80 秒，这还只是理论速度，我实测过平均速度不到 100kB/s，一般来说只是搭建网站这些 1m 有些慢，但够，一个页面一般都不会超过 100kb（不涉及图片的情况下），但如果我要图片怎么办，放在图床上或云存储，将这些资源放在那边，然后在相应的代码块访问对应的资源即可。这在资金不够的前提下，算是较好的一种方式，带宽费用就不放图了，高带宽想想就好。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"windows-和-linus-服务器的区别\">windows 和 Linus 服务器的区别<a class=\"hash-link\" href=\"#windows-和-linus-服务器的区别\" title=\"标题的直接链接\">​</a></h3><p>这里可能会说的不对，毕竟我接触服务器相关等配置也没太多时间，但是我觉得有必要说一下，我那时候用 windows 服务器的时候，只要通过 windows<strong>专业版</strong>（一定要专业版才能远程连接别人的电脑）自带的远程桌面（cmd 中输入<code>mstsc</code>即可），然后输入 ip 地址，接着在输入相应的账号密码即可，但有可能无法连接，原因是防火墙和 ip 白名单没有配置好，服务器不允许连接。连接后，进行一系列相关配置如下<img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201119191204222.png\" alt=\"image-20201119191204222\" class=\"img_ev3q\"></p><p>而对于 Linux，用的最多的就是宝塔面板了，但是连接不是通过 windows 远程桌面，而是通过像终端那样连接登录，我一般是用 Xshell 来连接。但是连接完就开始输入命令安装宝塔面板，然后会有对应的面板地址和登录宝塔面板的账号密码，只要访问给定的面板地址加上用户密码即可登录。像对应的界面如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200918141519472.png\" alt=\"image-20200918141519472\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"为啥要备案\">为啥要备案<a class=\"hash-link\" href=\"#为啥要备案\" title=\"标题的直接链接\">​</a></h2><p>首先备案要提交负责人的身份信息（身份证正反，手持，人脸，手机号，住址等），记录你这个域名内的网站的负责人和单位，主要为了防止在网上从事非法的网站经营活动，打击不良互联网信息的传播，能给予警告和封禁。</p><p>总之不要去搞违规违法行为，天网恢恢疏而不漏，网警要找总归有方法。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"icp-备案\">ICP 备案<a class=\"hash-link\" href=\"#icp-备案\" title=\"标题的直接链接\">​</a></h3><p>9 月 3 号购买的腾讯云与域名，然后进行初步的服务器简单部署配置，第二天开始域名实名认证，接着实名后需要 3 天时间才可以进行开始域名备案，等了 3 天开始域名备案提交网站的用途信息等等，然后拍身份证，人脸，手持，接着到 9 月 9 日腾讯云服务器的客服打电话给我要我修改一些信息，比如网站详情写的不行，资料不全，过不了备案等等，然后修改重新提交一次，最终等待收到腾讯云助手的通知，直到 9 月 18 号，如下结果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200918113449612.png\" alt=\"image-20200918113449612\" class=\"img_ev3q\"></p><p>至此 ICP 备案就搞定了，ICP 还算轻松，然而还完没，接着往下看。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"公安备案\">公安备案<a class=\"hash-link\" href=\"#公安备案\" title=\"标题的直接链接\">​</a></h3><p>上面所说的只是 ICP 备案，现在你已经可以通过域名<a href=\"http://kzcode.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">kzcode.cn</a> 访问到我的个人空间。但还有一个公安备案，虽说不是强制的，但一般都是建议去公安备案一下，然而这个比 ICP 备案复杂老多了，首先需要登录 <a href=\"http://www.beian.gov.cn\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.beian.gov.cn</a> 注册并且登录填写的信息也比上面的多，放一张图片</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201119191204222.png\" alt=\"image-20201119191204222\" class=\"img_ev3q\"></p><p>填写资料折腾了半小时左右的时间，才提交上去，而且过了快两周后，我收到了如下的短信</p><p>【公安网站服务平台】尊敬的用户:您开办的网站(互联网技术文章分享:kzcode.cn)审核未通过，原因：网站信息检查有误，审核不通过，请尽快登录<a href=\"http://www.beian.gov.cn%E7%BD%91%E7%AB%99%EF%BC%8C%E5%9C%A8%E8%8D%89%E7%A8%BF%E4%B8%AD%E4%BF%AE%E6%94%B9%E5%B9%B6%E9%87%8D%E6%96%B0%E6%8F%90%E4%BA%A4%E7%BD%91%E7%AB%99%E5%A4%87%E6%A1%88%E7%94%B3%E8%AF%B7%EF%BC%8C%E5%A6%82%E6%9C%89%E7%96%91%E9%97%AE%E5%8F%AF%E5%9C%A8%E5%B7%A5%E4%BD%9C%E6%97%A5%EF%BC%88%E4%B8%8A%E5%8D%888:30-11:30%E3%80%81%E4%B8%8B%E5%8D%8814:00-17:00%EF%BC%89%E8%81%94%E7%B3%BB%E7%BD%91%E8%AD%A6%EF%BC%8C%E8%81%94%E7%B3%BB%E7%94%B5%E8%AF%9D%EF%BC%9A059xxxxxxxx%EF%BC%8C%E8%B0%A2%E8%B0%A2%E6%82%A8%E7%9A%84%E9%85%8D%E5%90%88%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">www.beian.gov.cn网站，在草稿中修改并重新提交网站备案申请，如有疑问可在工作日（上午8:30-11:30、下午14:00-17:00）联系网警，联系电话：059xxxxxxxx，谢谢您的配合。</a></p><p>工作人员电话和我联系是说我户籍转了，需要在我转入地去申请，于是又重新提交改数据，反正就是照着腾讯云的帮助文档填写自己的个人信息，中途有几次就这么磨着磨着到了 11 月 17 号，短信收到了这一条</p><p>【公安网站服务平台】尊敬的用户:您的开办主体已经审核通过，如果存在自动关联的待备案或待认领网站，请尽快核对归属，进行新网站备案以及已备案网站认领的申请。如有疑问可在工作时间（周一至周五上午 9:00-12:00、下午 14:00-17:00）联系网警，联系电话：059xxxxxxxx，谢谢您的配合。</p><p>然而，我登录了网站却没有看到已备案的网站，于是联系工作人员 ，然后叫我重新提交一次，这次不到半小时就搞定，最终短信结果如下</p><p>【公安网站服务平台】尊敬的用户:您开办的网站(互联网技术文章分享:kzcode.cn)已经审核通过，请尽快登录<a href=\"http://www.beian.gov.cn%E7%BD%91%E7%AB%99,%E4%B8%8B%E8%BD%BD%E5%A4%87%E6%A1%88%E5%8F%B7%E7%A0%81%EF%BC%8C%E9%99%84%E5%9C%A8%E7%BD%91%E7%AB%99%E5%BA%95%E9%83%A8%EF%BC%8C%E5%A6%82%E6%9C%89%E7%96%91%E9%97%AE%E5%8F%AF%E5%9C%A8%E5%B7%A5%E4%BD%9C%E6%97%A5%EF%BC%88%E4%B8%8A%E5%8D%889:00-12:00%E3%80%81%E4%B8%8B%E5%8D%8814:00-17:00%EF%BC%89%E8%81%94%E7%B3%BB%E7%BD%91%E8%AD%A6%EF%BC%8C%E8%81%94%E7%B3%BB%E7%94%B5%E8%AF%9D%EF%BC%9A059xxxxxxxx%EF%BC%8C%E8%B0%A2%E8%B0%A2%E6%82%A8%E7%9A%84%E9%85%8D%E5%90%88%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">www.beian.gov.cn网站,下载备案号码，附在网站底部，如有疑问可在工作日（上午9:00-12:00、下午14:00-17:00）联系网警，联系电话：059xxxxxxxx，谢谢您的配合。</a></p><p>然后登录公安备案网站，查看备案结果如下图，帅的不谈！</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201117152619474.png\" alt=\"image-20201117152619474\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"悬挂备案号\">悬挂备案号<a class=\"hash-link\" href=\"#悬挂备案号\" title=\"标题的直接链接\">​</a></h3><p>如果上面都已经弄好了也别太高兴，要在网页源代码将公安联网备案信息放置在网页底部。简单的说完成两项备案后都需要在网站页面底部显示备案号，并指明转到链接。在我的个人博客页面最下方，就会看到如下图这样。就是需要设置成这样。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201117153209037.png\" alt=\"image-20201117153209037\" class=\"img_ev3q\"></p><p><a href=\"http://www.gov.cn/gongbao/content/2005/content_93018.htm\" target=\"_blank\" rel=\"noopener noreferrer\">工信部原文</a> 第十三条和第二十五条</p><p>否则就会被处罚五千元以上一万元一下罚款，话是这么多，但是有些网站下面并未有备案号，懂得都懂。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h3><p>我之前就有想过域名备案，庆幸那时候放弃了，因为觉得太麻烦就没搞了，没想到不是觉得麻烦，是真的麻烦，此外等待更是特别漫长。</p><p>甚至在收到公安备案的结果我都想直接换个好的服务器来部署自己所写的网站了，那一刻心情激动，别说了，好好写网站去了。</p><p>最终耗时 2 个月半，不过结果是好的，可以说没什么“瑕疵”了，当然前提这个网站别搞违法的东西，网络可并非法外之地。搞个网站是真心不易。接下来就是漫长的发展网站了。</p><p>一般一个域名够用了，需要的话在域名解析中去添加域名的子域名（二级，三级等等），比如关于图片这些就放在 img.kzcode.cn，而博客这些则放在 blog.kzcode.cn 里，至于其他的就自行发挥了。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/server-and-domain-beian",
            "title": "服务器与域名备案",
            "summary": "前言",
            "date_modified": "2020-11-17T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "server"
            ]
        },
        {
            "id": "easy-language",
            "content_html": "<p>好歹自己学习易语言也快有一年了，也用易语言写了一些软件，特此记录一下以及对易语言的个人看法。</p><p>该文章有可能过于啰嗦，可吐槽的点太多了，也正有感悟才能写的这么多。</p><p>补: 2021 年 3 月，也就是我最后一次编写易语言项目，因为我已经好久不写 exe 项目了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"易语言介绍\">易语言介绍<a class=\"hash-link\" href=\"#易语言介绍\" title=\"标题的直接链接\">​</a></h2><p>还是简单介绍一些易语言吧，毕竟肯定有很多即使学过编程也没听过易语言的，易语言是一门以<strong>中文</strong>作为程序代码编程语言，简称 E 语言，创始人吴涛，2000 年一个人独立开发。有关易语言的特点如下：</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"易语言不开源\">易语言不开源<a class=\"hash-link\" href=\"#易语言不开源\" title=\"标题的直接链接\">​</a></h3><p>不像主流的编程语言 C，Java，Python 等是开源的，易语言是一款纯正的商业编程软件，易语言正版加密狗 618 元，不过有破解版，不然多数人都不会去接触易语言了。但不开源就已经注定了易语言的在整个生态就不行，并且易语言已不在维护了，也就是很久很久没更新过，或者说不会再更新了，作者也已不再管易语言了，目前也就一些易友去开发一些相关的插件模块库这些。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"全中文界面可视化-ui填表式的声明\">全中文界面，可视化 UI，填表式的声明<a class=\"hash-link\" href=\"#全中文界面可视化-ui填表式的声明\" title=\"标题的直接链接\">​</a></h3><p>我这里放几张图展示一下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200914010759872.png\" alt=\"image-20200914010759872\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200914011112087.png\" alt=\"image-20200914011112087\" class=\"img_ev3q\"></p><p>首先要吐槽一下，2000 年的页面与 2020 年的页面可以说是完全一模一样的。开发界面是真的丑，但有一点是，页面的语言命令都是全中文的，比如<code>if</code>所对应的的就是<code>如果</code>，<code>MessageBox</code>所对的就是<code>信息框</code>，很多命令都中文化就再举例了，并且每个函数都是以表格似的填写，也就是代码的格式都定死死的了，如果你学过其他的编程语言在来和易语言比对，你多半会学的够呛，很难理解为啥要这样。不过也正是填表式声明，导致易语言过于简单，后文也会提及。</p><p>在比对一些 C#的开发界面</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200924135324.png\" alt=\"image-20200924125428023\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200924135325.png\" alt=\"image-20200924125907216\" class=\"img_ev3q\"></p><p>可以看到页面肯定比易语言好看 100 倍，但是随之而来的就是难度的提升，先不说好写与不好写，你让一个没学过编程的看，多半看的云里雾里，这时候就会劝退很多人瞬间不想学了，相信很多学编程的都有这样的经历。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"上手容易可以做到极速开发\">上手容易，可以做到极速开发<a class=\"hash-link\" href=\"#上手容易可以做到极速开发\" title=\"标题的直接链接\">​</a></h4><p>接着再来说一下上手学习，正是由于有上面那个前提，易语言可以做到上手特别快，可以说会用电脑，有逻辑，会识中文，易语言好学的一批，基本上学个几天自行写个软件完全没问题。对于国人一点编程基础都没有的新手，并且英语还不好的话来说，易语言可能是真的好上手，我当初学易就有一部分就是给英文劝退了。</p><p>首先我要提的是可视化界面设计，你只需要将旁边的组件拖拽至窗口页面上即可，相对于的属性，例如内容，宽高，颜色在旁边显而易见，要修改只需要点击修改对应的数值即可，而对于其他的 IDE 来说，如果英文不咋好，并且还是第一次用，找可能都要找几分钟。而正是这个可视化界面，让我当初有信心学下去易语言，如果你学过 C 或者其他编程语言，一开始都是在那黑不溜秋的控制台显示，我就只是想写个软件用用，你给我讲那么多理论知识，甚至我还听不懂的那种有个嘚用。</p><p>同时还可以直接打包成 exe 文件，直接在 windows 上运行，发给别人也能运行，哇，瞬间感觉到写软件的牛逼之处了，直接小有成就一波。这里我放几张我当初学易语言写的一些界面吧：</p><p>例如写一个骗骗小学生的 2020 年最新刷 Q 币软件（用到了浏览器的填表功能改了 q 币的值）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200924135326.gif\" alt=\"demo\" class=\"img_ev3q\"></p><p>在比如做一个音乐播放器（是有声音的，只是我录制的是 gif）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031909.gif\" alt=\"demo1\" class=\"img_ev3q\"></p><p>在比如一些自动添加好友的</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031910.png\" alt=\"image-20200924191526221\" class=\"img_ev3q\"></p><p>在比如写一个注册机模板</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031911.png\" alt=\"image-20200924192403210\" class=\"img_ev3q\"></p><p>网络验证</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210819233054879.png\" alt=\"image-20210819233054879\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210819232928124.png\" alt=\"image-20210819232928124\" class=\"img_ev3q\"></p><p>还有特别特别多的例子我就不举例了，这些用其他的编程语言肯定能写，但是与之对应的就是学习成本，很多人学其他编程语言，甚至还没学到界面设计就开始放弃了，原因很简单，没兴趣学呗，易语言界面好设计，但是基本都是原生 windows 组件，对于新手来说这完全足够设计出自己的软件了。</p><p><strong>要是没能在最想学习的时候，满足自我的成就感，那很有可能就会学不下去</strong>。</p><p>我当初学易语言也是这样的，暑假学了两个月，其中第一个月学基础到还没什么，也就开始学习易语言的基本语法和编写一些程序来玩玩，但这些说实话没什么可看的，或者说没什么可用的，就想上面那个骗骗小学生的刷 q 币软件有用吗，没用呗。初学的一个月就都开始写这些可以说毫无软用的东西，直到我照着视频一个字一个字的模仿着敲一遍扫雷一键秒杀的代码，没错，就是这个激起了我对编程，让我感受到编程的魅力。放上一张 gif 图片。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031912.gif\" alt=\"demo2\" class=\"img_ev3q\"></p><p>当初照着视频一步一步来最终完成了该软件，但那时候的我其实根本不知道为什么可以这样，直到后续了解到汇编与游戏内存相关的知识，我才算真正懂的当初扫雷外挂的原理。</p><p>也正是因这个扫雷的外挂，让我接下来的几个天疯狂的学习，去写其他的游戏外挂，比如连连看的一键秒杀，消消乐，植物大战僵尸等等。这里我也放一张图吧（还特意去下载 qq 游戏）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031913.gif\" alt=\"demo3\" class=\"img_ev3q\"></p><p>不过后面就没怎么学习游戏外挂相关的，一是所看的教程是 11 年的，中途没更新了，二是目前热门游戏以我目前能力写不出来，只要加上了检测，就过不了，并且容易封号（注：我 QQ 可不是开外挂给搞封了，就算开外挂最多也只是封游戏账号），最近接触的也就是 CF 越南服的外挂，有教程于是就学了点皮毛，不过教程又教到一半，就没深入去学习。这里提醒一句，写游戏外挂并销售是可是会给抓的。</p><p>不过有点扯远了，就凭这一手界面设计，易语言其实就足以容易上手写出个软件出来。在叙述几点易语言容易上手的地方，自带提示，全中文文档，比如下图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031914.png\" alt=\"image-20200924220413124\" class=\"img_ev3q\"></p><p>只要你鼠标选到对应的函数上，按下 F1 或者点击提示，就有对应的函数提示，对应其他语言也有，但是纯英文的，门槛就高一个档次。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"精易模块\">精易模块<a class=\"hash-link\" href=\"#精易模块\" title=\"标题的直接链接\">​</a></h4><p>如果没有这个模块也就易语言跟其他语言的区别可能就是一个是中文一个是英文了。我就举我用的最多的一个命令<code>文本_取出中间文本</code></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031915.png\" alt=\"image-20200924220908502\" class=\"img_ev3q\"></p><p>而对于其他的编程语言，这类语言还需要自行编写一个函数来调用，而精易模块则是直接封装好好的供你使用。你都没必要去了解底层的函数，直接把门槛降了一个大档次。</p><p>至于相关的程序编写我也不多概述，下面就是易语言的缺点。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"易语言的缺点\">易语言的缺点<a class=\"hash-link\" href=\"#易语言的缺点\" title=\"标题的直接链接\">​</a></h3><p>我说说我用易语言的缺点，也是我最不推荐别人学易语言的了</p><p>我上面也说到过 2000 年的页面与 2020 年的页面可以说是完全一模一样的。虽然有易友开发了仿 VS 界面的，但启动起来影响运行速度，我就没安装了。虽说我不是强迫症，但用多了 vscode 与其他的 IDE 相比，看到易语言就能想到是几年前的软件了。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"占用空间与运行\">占用空间与运行<a class=\"hash-link\" href=\"#占用空间与运行\" title=\"标题的直接链接\">​</a></h4><p>易语言毕竟还是一种封装过的语言，带来的方便，同时也牺牲了性能空间，与原生的桌面级开发相比易语言是无法比的。就比如用 C#开发的所占用空间肯定比易语言少，相关的性能优化更好，这里我就不放图了。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"软件报毒即使没毒也会给杀毒软件报\">软件报毒，即使没毒也会给杀毒软件报<a class=\"hash-link\" href=\"#软件报毒即使没毒也会给杀毒软件报\" title=\"标题的直接链接\">​</a></h4><p>这里我有必要说说关于易语言的一段故事，这里我放几个链接，可以去了解一番 <a href=\"https://www.bilibili.com/video/BV1WE411E7mQ/?spm_id_from=333.788.videocard.0\" target=\"_blank\" rel=\"noopener noreferrer\">刷枪改图强登游戏 CF 外挂</a></p><p><a href=\"https://www.zhihu.com/question/20690643?sort=created\" target=\"_blank\" rel=\"noopener noreferrer\">为什么多数外挂都用易语言？</a></p><p>如果你在 2010 年左右接触过网络游戏，你肯定遇到过各种各样的外挂，而这类外挂多数都是出自易语言之手，甚至你现在在外面遇到的很多游戏脚本外挂，易语言也能占据多数。你随便百度一些易语言，相关的评论都是有关外挂这些。但事实上你只会易语言是根本不够写外挂的，我学过相关外挂制作，虽然学的浅，但至少学过。是需要汇编这类基础，但又为什么会很多外挂是用易语言写,，而且都是些水平不是特别高的人，原因很简单，因为那些写挂的很多都不会真正写挂，只是调用别人封装好了的库，甚至就连易语言自身都带了外挂库这些。让他们写一款新游戏的外挂，他们多半是写不出来了，原因就是他们不懂汇编这些，但是调用写好的库就 6 的飞起。当然这其中还是有些利益相关的方面，我也不多提了。</p><p>如我上面所的我一个初中同学，要不是我接触了编写外挂这些，我还真信了他当初能写的，实际上都是修改外面的源码，或者是直接调用写好的库，直接偷源码用。</p><p>因为外挂行业的崛起，导致一些厂商不得不进行一定的处理。总之，目前易语言写过的项目，多数是会报毒的，即便没毒，也已经给杀毒软件的厂商给拉入黑名单了，所以可以说没公司要易语言的程序员，即使软件没毒，但是还是报毒，你是信杀毒软件还是易语言？</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"说说我用到的一些坑\">说说我用到的一些坑<a class=\"hash-link\" href=\"#说说我用到的一些坑\" title=\"标题的直接链接\">​</a></h4><p>我在做一些网页数据获取的时候，竟然连个 DOM 对象都没有提供，当时没接触前端，不知道有 DOM 对象，还是用正则去匹配，那时候是真的 nc。接触了前端，发现易语言竟然没提供 DOM 对象操作，我还是用别人封装的 DOM 类，并且还有可能出现匹配不到情况。</p><p>其次是调试的时候，对于变量值长度过长竟然无法直接查看，还需要保存为文本才能查看，并且我调试的时候常常崩溃，导致我每次找一个 bug 的时候都需要重启易语言好几遍才行。</p><p>由于是类似表格式的填写变量，参数与类型，也就导致了无法在其他编辑器上进行编写易语言代码比如我复制一个函数，给我的结果是</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">.版本 2</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">.子程序 子程序1, 整数型</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">.参数 参数1, 文本型</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">.局部变量 变量1, 整数型</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">变量1 ＝ 到整数 (参数1)</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">返回 (变量1)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>而在易语言所对的是</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/20200927031916.png\" alt=\"image-20200924222319462\" class=\"img_ev3q\"></p><p>在易语言中的引号<code>\"\"</code>，只能通过常量<code>#引号</code>，或者通过常量表，就比如下面这个 jsoin 字符串 <code>{\"a\"=\"123\",\"b\"=\"321\"}</code>，而易语言的写法就是，<code>\"{”+#引号+“a”+#引号+“=”+#引号+“123”+#引号+“,”+#引号+“b”+#引号+“=”+#引号+“321”+#引号+“}\"</code>，一个个通过字符串来拼接，巨麻烦，也是我最想吐槽易语言的，不过也可以通过常量表来替换，但依旧很麻烦。</p><p>还有易语言自身是不支持 utf-8 编码显示，原因很简单，当初只是为了给国人用，gbk 显然是更好的选择。但有时需要 utf-8 的，这时候就莫得办法。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"没公司要易语言程序员\">没公司要易语言程序员<a class=\"hash-link\" href=\"#没公司要易语言程序员\" title=\"标题的直接链接\">​</a></h4><p>几乎没有公司招聘易语言程序员，实际上上面所说的就足以证明易语言不行了。并且很多人都不看好易语言，黑易语言，至于为什么黑，百度或者知乎想必会有更好的答案，这里我也就不再赘述了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"小总结\">小总结<a class=\"hash-link\" href=\"#小总结\" title=\"标题的直接链接\">​</a></h3><p>写到这，我其实有点想把介绍易语言的一部分给删了， 我不推荐新手去学易语言，因为易语言相比于其他语言，它还是太弱了。但如果没有这半年的易语言学习，让我天真的以为编程的简单，又怎么鼓舞真正入坑，让我去学习更多更深奥的知识。</p><p>不过就目前而已，我已经很少用易语言写东西了，但如果要写桌面级软件，我还是会首选易语言（因为只会易语言），毕竟写了也有半年了，开发效率也高。如果有机会的话，会深入学一下 C#还有 Qt，不过也不知道是什么时候才会有机会。</p><p>关于英语方面的话，我是挺惧怕英语的，我高中英语就没怎么及格过，甚至我大学英语还挂科了，但易语言给我带来了编程希望。就我目前学习来说，编程还真的不怎么吃英语，看不懂英语文档，翻译成中文文档不就完事，而且学多了就会发现太多都是死代码，需要的时候翻阅文档直接 Ctrl C V 使用即可。英语对编程来说只是为辅，英语好并不能提高编程的上限，同时也决定不了下限，就这么说吧，你让一个学英语专业的人来看一份几百行的代码，基本注释写得在详细，他没学过编程，能看的懂吗？但有很多开源的项目都是英文的，会英文固然是好，但不会就不行了吗，看不懂英文文档，我翻译还不行吗？说这些，就是希望别用自己的短处来阻劝自己的目标，很多时候都是学了才知道这个有没有用，没学有锤子用！</p><p>易语言是我接触过的第一款编程语言。那时候曾是我最喜欢的编程语言，也是最能让我感到成就感的编程语言，不过在这行学多了，还是不得不放弃易语言开发，原因就是因为易语言不够强大，但也莫得办法，如今易语言的生态就是如此。</p><p><strong>如果易语言不是我的第一门编程语言，那么其他编程语言就是最后一门。</strong></p>",
            "url": "https://onewhitethreee.github.io/examenEbau/easy-language",
            "title": "易语言",
            "summary": "好歹自己学习易语言也快有一年了，也用易语言写了一些软件，特此记录一下以及对易语言的个人看法。",
            "date_modified": "2020-10-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "随笔",
                "easy-language"
            ]
        },
        {
            "id": "2019.7-2020.7-log",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>写篇年记，记录一下自己这一年的所学。</p><p>能有幸在这个行业有两点关键因素</p><ol><li><p>QQ 永久冻结</p></li><li><p>易语言</p></li></ol><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"qq-永久冻结\">QQ 永久冻结<a class=\"hash-link\" href=\"#qq-永久冻结\" title=\"标题的直接链接\">​</a></h3><p>有些认识我的人可能会知道我的 QQ804493238 给永久冻结了，可以说这个号码是不可能再搞回来的。一个幸幸苦苦养了十年的 QQ ，说没就没的那种，与之相对应的就是游戏账号没了，没了游戏能干嘛，当然不能干嘛，生活还是得过的，但又要有个东西来打发时间，没错就是编程。于是高中毕业后的暑假，就开始了学习编程。不过这里要先介绍一下易语言，作为我的第一门编程语言。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"初识易语言\">初识易语言<a class=\"hash-link\" href=\"#初识易语言\" title=\"标题的直接链接\">​</a></h3><p>初识易语言的时候还是在初中，那时候有个同学给我讲诉了他用易语言刷 CF 永久枪，用易语言写游戏外挂的故事，也是那时候我也才刚接触网络游戏，一把永久枪 888 还免费刷，别说有多牛逼了好吧。可以说从那时候开始，下了个目标，以后有时间一定要学易语言！（不过那时候没条件学或者说是给游戏耽搁了）果不其然，在高中毕业后，就开始了易语言的学习（最主要的原因就是号没了，完全没有心思再玩游戏）。</p><p>有关易语言的详细介绍我划分在另一篇文章 <a href=\"/examenEbau/易语言\">易语言</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"http-请求\">HTTP 请求<a class=\"hash-link\" href=\"#http-请求\" title=\"标题的直接链接\">​</a></h3><p>这里我需要简单说一下这门技术，就是因为这门技术才能让我能写上软件，并且是有实质性用处的。有关这个介绍可以点击文章 <a href=\"/examenEbau/docs/skill/reverse/Web/浅谈HTTP\">浅谈 HTTP</a></p><p>在开学军训一个月期间，也没有放弃学习易语言，不过那一个月应该不算学易语言这个语言，而是在学一个网络协议 HTTP，在这行的术语应该叫 POST 与 JS 逆向（基于易语言），这里我需要放一个我当时学习的链接 <a href=\"https://www.zygx8.com/thread-7162-1-6.html\" target=\"_blank\" rel=\"noopener noreferrer\">零基础易语言 POST 入门到精通</a>，导师教的非常好，是真心推荐，我从他的课程学到了非常多的知识，就凭我听了他的这一期课，就能自行写出超星刷课软件，我觉得这就足够我去报他的班。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"qq-机器人-\">qq 机器人 &nbsp;<a class=\"hash-link\" href=\"#qq-机器人-\" title=\"标题的直接链接\">​</a></h3><p>非常可惜之前写了一段时间的 qq 机器人代码无法使用了，相关文章 <a href=\"https://www.bilibili.com/read/mobile/7009209?share_medium=iphone&amp;share_plat=ios&amp;share_source=QQ&amp;share_tag=s_i&amp;timestamp=1596387202&amp;unique_k=vdFqN2\" target=\"_blank\" rel=\"noopener noreferrer\">纪念 QQ 机器人业黑暗的一天</a></p><p>我用的是酷 Q 框架，用易语言写的代码，花了也有半个月的时间去写<img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200926164358137.png\" alt=\"image-20200926164358137\" class=\"img_ev3q\"></p><p>那时候封装了好几个功能，最终就因为腾讯的封杀，导致自己辛辛苦苦写了半个月的代码灰飞烟灭。这时候的心情与当初 QQ 被永久冻结一样，不过现在也看淡了，就算回来说实话也高兴不到哪里去，也就在以前群在多吹吹牛逼罢了。（泽宇是我之前玩网的一个艺名）</p><p>这个 qq 机器人算是我手机端和电脑端一个变通的交互方式，以下是一些相关的菜单图，有些功能不方便展示，仅作为个人使用。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20220517010245349.png\" alt=\"image-20220517010245349\" class=\"img_ev3q\"></p><ol><li>对接网络验证服务端，购买卡密，实现购买卡密</li></ol><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200928204705890.png\" alt=\"image-20200928204705890\" class=\"img_ev3q\"></p><ol start=\"2\"><li>实现一些注册，例如一些软件注册给新用户多少时间使用，就不必在通过电脑，而是直接通过机器人发送命令来注册即可。</li><li>群监控，监控群里的一些不良信息进行撤回，监控刷屏进行禁言操作。</li></ol><p>只要你想，然后给上对应的代码就行了，那时候也是沉迷于 qq 机器人花了很多时间写这些接口。这里的话我说说那时候我用机器人来写一个学校的用手机进行超星线下考试。</p><p>事情是这样的，这个考试是<strong>用手机考试</strong>的，但只能带一部手机，同时老师提供了题库，<strong>允许带资料</strong>，差不多就是开卷考。而且用于考试的软件（超星学习通）是<strong>不允许切换的后台</strong>来进行搜题的（或者说切换到后台会扣分），有些手机是无法分屏的（但是有悬浮窗）。这时候该怎么办，难不成真的去把题库打印一遍？还真有，十几张来着，先不说好不好，找一题都要找半天，有没有更有效的办法，有，我那时候就是通过机器人。</p><p>首先，将老师发的题库，存入文件（那时候的我还不会数据库，就只好读文件），然后通过则匹配，将对应的题目，将答案全部都记录到数组里面去。接着在通过给机器人发送对应的命令如 查题+关键词即可搜到相关的题目。这里就放一个我当初录制的一个视频，（其他人操作也就是通过悬浮窗来）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/demo6.gif\" alt=\"demo6\" class=\"img_ev3q\"></p><p>即便眼睛再也好，也比不过可靠的搜索，搜索可靠也不及关键词筛选，当初考试就是通过这样方式来通过这场用手机的考试，但是也有缺点，只能说当初写软意识不好，没考虑周全，像这个搜题我还要再打一遍【查题】这个关键词，很傻，而不是发送【搜题模式】，然后直接发送题目获取就行，再发送【退出搜题】（那时候花了一天时间去写）。并且对于这样的搜题还要切换特别麻烦，好一点的办法，有，自写安卓悬浮窗，不过现在也没这样的考试了，也是我后面学了点安卓后随手写的，悬浮窗大致如下。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/floating.png\" alt=\"搜题悬浮窗\" class=\"img_ev3q\"></p><p>qq 机器人算是我特别想写的一个东西，但很可惜腾讯封杀外面大部分 qq 机器人框架，我使用的同样框架无疑避免，同时腾讯自己的机器人又不给开发者提供合适的开发接口，这就是腾讯吗，这本来就是腾讯的作风。</p><p>至于后续如果有时间，或者要发展 qq 群的话，肯定会重新再写一份 qq 机器人，到时候想要实现功能可就多了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"疫情期间也是进步最快的时候\">疫情期间，也是进步最快的时候<a class=\"hash-link\" href=\"#疫情期间也是进步最快的时候\" title=\"标题的直接链接\">​</a></h2><p>上一阶段学习期间，从 7 月到下半年 1 个月，这一阶段主要就是易语言与脚本开发，相关也就是上述了，而下一阶段，也就是从 1 月中旬到开学（5 月 23 号），也就是差不多这期间，开始了逆向初步学习和 Web 开发方面，而这段时间，可以说除了编程，就只有编程了。</p><p>先说下生物钟，晚上 6 点左右起来，然后早上 9 点左右睡觉，没错，这 4 个月基本上是这么熬过来的。（其中期间调整了两次作息习惯），因为疫情的因素，开不了学，又不方便出去，加上我本来也不喜欢出去，所以这阶段对我来说无疑是最好不过的，而这一阶段，也是我学习最多的时候，见识最多的时候，让我再一次感觉到编程的魅力，但同时让我感受到真正的编程和难。下面则会按时间顺序简单介绍下我学了什么。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"资源共享吧\">资源共享吧<a class=\"hash-link\" href=\"#资源共享吧\" title=\"标题的直接链接\">​</a></h3><p>首先要提一个这个学习论坛，因为我在这个论坛上找到的很多教程，可以说没有这个论坛，我视频教程都不好找，先放个论坛链接 <a href=\"https://www.zygx8.com/forum.php\" target=\"_blank\" rel=\"noopener noreferrer\">资源共享吧</a>，首先这个论坛从名字上应该可以知道是资源共享的，是关于编程相关技术方面的资源，可不是那啥，我先放一张图片，看看到底都有啥资源。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201005025855844.png\" alt=\"image-20201005025855844\" class=\"img_ev3q\"></p><p>别说，基本上有关编程的你在这都能看到，当然肯定不是免费了，是需要交 VIP 的，但只要 199 元，终身高级 VIP 会员，别提有多值了，你知道外面一套培训有多贵吗，这我就不提了，自己搜一搜就知道了，我在写超星刷课不是提过一个讲师，我报了它的班，4000 安卓 VIP+3000 网页逆向 VIP 来着，而这里你只需要 199 元，并且在该论坛你也能看到他的一些相关课程。当然，和培训相比还是有一定的区别，但在这里的教程真不差。</p><p>关于付费学习，可能有些人不解，为啥要收费，没为啥，就是你听付费的课程，能比别人学的快，能少走点坑路，很多免费课程要么就是为了推荐他的付费课程，要么就是为了推荐他写的书，总之，免费之中必有付费，单纯的免费课程能学，但想要走个捷径，付费应该是最快捷的方法。</p><p>是真心推荐这个论坛，一点广告费都没收，因为在这个论坛上我下载了特别多有关编程相关的知识，奈何时间不允许，不然我真的都学了。正是因为我在这个论坛上学习到特别多的知识，这就是我推荐的理由之一。</p><p>下面的大多数学习都是基于这个论坛上的视频教程。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安卓逆向\">安卓逆向<a class=\"hash-link\" href=\"#安卓逆向\" title=\"标题的直接链接\">​</a></h3><p>这上半年，我也只会网页端的数据分析与 JS 逆向，很多时候并没有网页版的，只有安卓应用，这时候想要偷其中的 api 接口，找到对应的加密点，该咋办，学呗。就必须要会安卓逆向，并且这个不比网页端简单。</p><p>在我开始提笔写的时候，已经有半年没怎么碰过安卓方面的了，我都快忘记了我安卓逆向的好多知识，而且当初还没有写笔记的习惯，就连我一开始怎么入门的都没什么印象了，总之就是看了教程，然后一步步照抄，视频教程怎做就怎么仿，就完事了。</p><p>同时也正是因为安卓，花了 10 天左右用 2.5 倍速度把毕向东的 java25 天速成教程看完了，而 java 才算是我真正第一门主流的编程语言，之前的 javascript 我是连 ES6 语法都不会的，甚至很多基本的语法我都不知道。但学完了 Java 的基础语法，但对于安卓逆向或者开发来说还是差太多了，虽说对于当时的我看的明白，但实际上整个安卓的项目结构我依旧不明白，不会点开发去搞逆向是真的折腾。</p><p>合理来说我安卓逆向压根就没学完，或者说我只学到了 java 层的源码分析（java 是真的好反编译了），我还没什么能拿的出手的东西，没有破解过安卓软件，只是分析了跟网页端差不多的 HTTP 请求，差不多的加密算法，在这方面我还真的不知道该说写什么，即使说了，很多没了解过安卓逆向人也不懂，后续的话会再学安卓这方面，从开发到逆向，到时候会这方面的知识在进行一个分类总结。（主要是我真的忘了太多了）</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"autojs\">Auto.js<a class=\"hash-link\" href=\"#autojs\" title=\"标题的直接链接\">​</a></h3><p>我先简单介绍一下这个是什么，这个也就是专门针对安卓端的无 root 脚本操作，看到后缀名你应该能想到 js，正是用 JavaScript 作为脚本语言。可以说用这个开发工具也能开发些安卓软件，但主要还是针对脚本操作，比如做一个 qq 自动点赞的， 贴吧签到脚本，抖音自动刷视频，双十一用过淘宝叠过猫猫吧，用 Auto.js 也能写个自动浏览商品，刷金币的，此外有太多例子了。</p><p>在之前的脚本操作，我也只会电脑端的，而对手机端无奈只好投屏到电脑，通过电脑的鼠标操作来实现脚本，而现在有了这个软件，则就不用在连接电脑，直接将写好的脚本打包成安装包安装，点击运行即可。但对比原生安卓开发，这个开发工具还是略显下风，不过对于安卓的自动化操作已经足够了，我也只说说我用这个写了个什么软件。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"钉钉签到脚本\">钉钉签到脚本<a class=\"hash-link\" href=\"#钉钉签到脚本\" title=\"标题的直接链接\">​</a></h4><p>像抖音自动刷视频和贴吧签到这些我就不多举例，主要还是这个软件，听名字就知道是钉钉签到的，有些在疫情期间，学校老师又要求同学使用钉钉，并且签到，但是有的同学就是会忘记签到或者没起来（说的是我），怎么办，记旷课？这不写个脚挂在那边时间到了自动签到呗。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/ddqd1.png\" alt=\"ddqd1\" class=\"img_ev3q\"></p><p>这是我当时写的页面，只需要填写对应的课程名和开始的时间即可，时间一到，手机自动亮屏，开始签到。主要的代码就下面这一个函数</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">ddSign</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">courseName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">launchApp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'钉钉'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">waitForActivity</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'android.widget.FrameLayout'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> course </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">courseName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">course</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    course</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> sign </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">text</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'群签到'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">sign</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!=</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    sign</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">parent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">sleep</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">3000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">desc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'群签到'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">sleep</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token number\" style=\"color:#ae81ff\">3000</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> btn_sign </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">className</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'android.view.View'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">desc</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'签到'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">findOne</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> btn_sign</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">click</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function maybe-class-name\" style=\"color:#e6db74\">Log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'签到结果'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> result</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">toastLog</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'不在群签到页面'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>启动钉钉，等待钉钉启动完毕，找到对应的课程名，点击课程名，找到群签到按钮，点击群签到按钮，进入群签到找签到按钮，点击签到，签到成功。就这么完事了，脚本就是这样的。</p><p>不过最终有个缺点，对于一些没有 root 的手机，需要每次运行就要不断的打开无障碍服务，特别繁琐，但没办法，这是安卓的机制问题。</p><p>这里要提及的一句是为啥不用 HTTP 发送请求要来签到，而是要这种脚本方式，对比一下你就会发现，用脚本写基本无压力，就是简单判断一些字或者图在哪，然后点击对应的坐标，而通过 HTTP 请求的话，一是要过钉钉登录，二是要处理各种加密算法。不过钉钉登录算法难不难我就不知道了，我也懒得分析，加上正好学了 Auto.js，索性就写一个这样的签到脚本得了。但说实话签到就不应该这样用这种定时脚本，而是应该选择协议更好。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"深度学习之图像识别\">深度学习之图像识别<a class=\"hash-link\" href=\"#深度学习之图像识别\" title=\"标题的直接链接\">​</a></h3><p>可以去了解一些深度学习，颠覆我对机器的认知，至少让我又觉得编程的强大，重拾学下去的信心。首先，先看张图片</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/QQ%E5%9B%BE%E7%89%8720201004030419.png\" alt=\"QQ图片20201004030419\" class=\"img_ev3q\"></p><p>看图也能看明白，这个就是识别一个缺口的图片软件，可能对没接触过这行业的人觉得这并没有什么软用，这个滑块的意义主要还是防止人为操作和机器操作。对于人而已，自然而然知道缺口的位置，但是对于机器而言要怎么知道这个缺口的位置，就针对上面这类图片，可以通过图片颜色深度来定位到缺口的地方，同时也可以使用深度学习，简单来说深度学习就是 AI，不过这里的 AI 是用来让它识别这个缺口，至于怎么让它识别和对应的算法我就没过多了解了，我接触这个主要还是用现成的模型来训练识别的。说一下我是怎么让机器训练的。</p><p>这个过程其实就跟教小孩一样，现在有一个小孩，他不知道这个缺口的位置，这时候我告诉它缺口的位置在那，对应的操作也就是标注，如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201004031417625.png\" alt=\"image-20201004031417625\" class=\"img_ev3q\"></p><p>我把缺口的地方标注一下，并记录对应的坐标，然后告诉这个小孩，缺口是我标注的地方，你下次遇到的时候记得是缺口这样的，但是小孩毕竟是小孩，这是我换一张类似的图片，这时候他可能就蒙了，所以就需要不断的给他标注好的缺口图片，让这个小孩一直看，一直记，直到下一次看到一张陌生的图片，但是它已经把之前训练的给记住了，很快他就能找到缺口的位置，这整个过程其实就是告诉小孩，然后让小孩一直训练，这就达到了我们想要的目的，这个小孩也会知道缺口的位置了。现在把这个小孩换成机器，那么这就是深度学习，并且机器是机器，可以封装的“记忆”远比人类可比，人是会感到疲惫的，而机器不会。再比如下面这张图片</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201004033445666.png\" alt=\"image-20201004033445666\" class=\"img_ev3q\"></p><p>对于我们来说显示屏，键盘等等这些在常见不过了，深度学习就可以做到识别图片对应的物体分别是什么，不过这要的训练量就比上面那个滑块大多了。我这里简单说说主要的通途，现在我想拍一张人脸照，还有风景照，但是时间旧了，我想找可能就要一定的时间，这时候就可以通过识别图片，进行分类，例如头像照，风景照，食物照等等，现在大多数相册都有上述图片分类的功能，不止如此，通过训练还可以识别文字，快递单号，车牌号，识别人脸等等，总之想训练的东西，都能训练，不过就是吃训练量和显卡，一般来说都是用现成的模型直接用就完事了。对我目前而言，我深度学习学的是非常浅了，也只会用用模型，跑个显卡训练训练。</p><p>此外，既然图片训练是这样的，能不能训练其他的，当然，语音识别，模拟一些明星的声音，游戏 AI，甚至让机器自己去学习怎么打游戏，游戏内的人机也就如此，通过训练满分作文，实现写一篇条理清晰的作文等等，太多例子都能看到人工智能。</p><p>关于这方面我也不敢做过多讲述，毕竟也还没开始从事这方面的真正学习。但确实，惊艳到我了，也让我想去学习这方面的知识。想自己写一个属于自己的语音 AI 助手，训练出一个能自己玩小游戏的模型，总之想学的太多了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"chrome-扩展开发\">Chrome 扩展开发<a class=\"hash-link\" href=\"#chrome-扩展开发\" title=\"标题的直接链接\">​</a></h3><p>关于这个的话可以查看我写过的一篇文章 <a href=\"/examenEbau/docs/skill/develop/Chrome插件开发\">Chrome 插件开发</a>，我总结了一下我那时候学习的插件，和自写的一些模板，不在这做过多赘述了。</p><p>疫情这期间说句闭关学习应该不成问题，不过学的东西远不止于此，主要其他的没写出啥玩意，而且学的很浅很浅，比如汇编基础（不过应该已经忘得差不多了），又深入学习了编写游戏外挂，TCP 协议（和 HTTP 一样），还有就是一些开发工具的使用。期间也写过一些东西，例如疫情填表，网课签到等等，不过都是临时写来自用的，也懒得放图了，原理基本和超星刷课一样，有时间再整理一下。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"web-开发\">Web 开发<a class=\"hash-link\" href=\"#web-开发\" title=\"标题的直接链接\">​</a></h2><p>在进入了这个阶段，我就很久没再用易语言开发新的软件了。到目前为止也真的快半年没怎么动易语言的代码了（也快半年没怎么写项目了），就那个超星刷课而言，没想到半年后还能用。而这一阶段主要接触的也就是 Web 开发方面。</p><p>实际上，我在接触易语言就已经接触了一些 Web 方面，因为要针对网页的一些操作就不得不接触这些，比如 HTTP 协议，DOM 解析，CSS 选择器，JS。不过那时候这对真正的 Web 开发远远不够。当然要说一下为什么会想学习 Web，在学 Web 之前，实际上还接触了一些 js 高端操作，例如 AST 语法树（混淆 js 代码），WebSocket，但发现有点没学明白，用都有点没用明白，然后就是想搞明白这些操作，于是进阶学习 js。</p><p>其实决定性的也就是一门编程语言——JavaScript，那时候感觉到易语言的不足，恰好手头在学的一门编程也就是 JavaScript，于是就开始了 JavaScript 的学习，可以说不是 JavaScript，Web 想都没带想的。js 作为我目前的主力语言，就目前而言，基本屏幕上，必有 vscode 的痕迹，而且还是 js。js 吸引我的一个地方就是其他语言都能调用，加上语法清晰，不过要我硬说 js 哪里好，我也说不清楚，可能这就是对一件事物的热爱吧。</p><p>于是改变了当初原有的想法——搞安卓开发与深度学习，转行到 Web 开发去了，和学习其他技术一样，找教程，跟教程做一遍，自己在举一反三一波才不多就明了。</p><p>Web 学习确实比逆向轻松，并且学完 Web 能写的东西也算比较多。也算可以自己动手设计出一个界面或者功能出来，上手特别容易。这里我就不献丑了，之前前端写的那些代码真没脸丢出来。就连当初的笔记我都不敢看，写的是什么玩意，竟然还是在 js 文件上用注释来记录笔记。</p><p>就这样学习了几周，然后收到了开学通知，没错是开学通知，疫情的时候，开学一个月，于是就停滞了学习近一个月了，前面也说到，生物钟的问题，开学了就不得不强行调整生物钟，把我学习节奏给打乱了。其次突然开学，心态是真崩了，开学各种繁琐的事情搞得压根学不进去。原本不出意外在保持这样的学习状态一直学下去，暑假结束前就能把 Web 大部分知识都能搞完，然而却拖到现在。</p><p>不过也不能说开学不好，从 1 月 10 号放假，到 5 月 23 号开学，在家好像也就出门了 2 次，要是再这样拖到暑假估计身体可真要出问题。停滞了学习，但保住了身体，是赚是亏，对我来说血亏吧。</p><p>然而暑假由于学车的因素，加上外出玩了一波，整个暑假并没有像去年那样全身心投入去学习，不过业余时间会去摄取有关这行的知识与科普，也就是刷刷知乎，公众号，博客文章等等。而也就是在这段了解到了 Nodejs 与 Vue，暑假开始学习。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"nodejs\">Nodejs<a class=\"hash-link\" href=\"#nodejs\" title=\"标题的直接链接\">​</a></h3><p>不过学前端，Nodejs 基本是必接触，基本可以说只要是个前端开发者，就肯定会 Nodejs，关于 Nodejs 不做过多介绍，我能推荐的也只是一些 npm 包，总之在这期间 也就是只学了点 Nodejs 的基本使用，还有 npm (Node 包管理器)。</p><p>主要接触两个 Web 框架 Puppeteer 与 Express，关于这两个我在 Node 的那个目录内有简单说明到，这里也就不放链接了。这里简单说说 Express</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"express\">Express<a class=\"hash-link\" href=\"#express\" title=\"标题的直接链接\">​</a></h3><p>学 node 大多数就是为了搞服务端，那么肯定也有对应的服务端框架，Express 就是其中之一。</p><p>在此之前，我是写过点后端的，也就是一个网络验证的系统，不过那时候是基于易语言和 HP-Socket 的库，但有一个很大缺陷，就是我这个后端服务器编译出来的是 exe 文件，也就是只能在 windows 上运行，这对 Linux 系统服务器很不友好，于是乎就想搞一个基于 Express 的网络验证服务端。</p><p>而这期间才算学会用 Mysql，之前易语言写的网络验证时连 Sql 语句都不会，还都是用易语言自带命令帮我封装好来进行增删改查。也简单的将易语言写的网络验证接口全都搬运至 Express 中，然而有个问题来了，我要怎么查看数据？难不成直接打开数据库查，怎么可能，而这就开始了 vue-element-admin 开发，后文会说到，因为这里要涉及到一个新的技能——Vue。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vue\">Vue<a class=\"hash-link\" href=\"#vue\" title=\"标题的直接链接\">​</a></h3><p>可以说没有 Vue，我多半不会去继续学习前端（怎么感觉这句话好像说过了），和大多数人学 Web 一样，都是从基本的 HTML CSS JS 这前端三件套开始学起，然而在学到一半的时候，想写一写 Web 小项目的时候，就需要在一个 HTML 上写上大量代码，并且页面还不好设计，并且在用了 Express 一段时间后，发现如果要做动态网站的时候，就需要将数据渲染到对应的模板语言上（如 ejs），于是想知道有没有啥能解决这上述问题，于是便开始搜索有关前端的一些相关知识扩展，果不其然，困惑了我一段时间是否继续学习前端，因 Vue 而解惑。</p><p>如果要我评价一句 Vue，我只能说后悔学 Vue，后悔学晚了。我花了挺多时间在原生的前端开发，在了解到 Vue 时，还在用着 Jquery。Vue 让我继续学前端并不是数据交互方面，而是模块化，在我接触原生前端开发的时候，这个问题尤为困扰我，每次写一个页面都需要重复大量相同代码，即便是复制粘贴也觉得烦躁，而 Vue 组件化就不一样。例如我当前的博客页面，你会看到导航栏，侧边栏，与正文，评论系统，乃至打赏按钮都是一个个组件拼接而成，只需要在单个 Vue 文件中，引入对应的组件，然后想 html 标签那样直接写在视图层上即可显示，当然，相关代码也展示了，有关 Vue 的我也都放在 Vue 这个目录下。</p><p>然后就是基于 Vue 而开发的组件库，在 Web 开发难免不了页面设计，然而并非所有程序员又兼设计师，想要设计出一个好看的按钮或其他组件并非容易的事情，而组件库便提供了一个好看的组件供开发者使用，例如通过引入 element 的样式与组件库</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!-- 引入样式 --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">link</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">rel</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">stylesheet</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">href</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://unpkg.com/element-ui/lib/theme-chalk/index.css</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!-- 引入组件库 --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">https://unpkg.com/element-ui/lib/index.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后在官网中找到需要的组件，如下按钮</p><p><el-button type=\"primary\" plain=\"true\">主要按钮</el-button></p><p>而对于的代码也就是</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">el-button</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">primary</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">plain</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">主要按钮</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">el-button</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>只需要简单修改一下参数就能生成相应的组件。哪里还需要花费大量时间去写 css，不断改参数，上手即用，快速成型。</p><p>Vue 模板语法也是，显示后端传递的数据也简单，比如下面这行</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">h1</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">标题: {{ title }}</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">h1</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>只要接收到后端发送来的标题，即可渲染在<code>{{title}}</code>内，此外还有数据的双向绑定，关于这些等等不在这细说了，需要的话可以自行翻阅 Vue 文档。</p><p>而且就这么说吧，前端框架如果不学 Vue 和 React 其中之一，面试都不给你面试的。甚至可以说，Vue 和 React 是前端开发必学之一，不学就跟不学前端没两样。</p><p>同时 Vue 还是国人尤大大（尤雨溪）开发的，在国内生态好，社区活跃高。基本上目前国内的大部分 Web 项目都有 Vue 的身影，同时 Vue 不止于前端，小程序的开发等等也有它的身影，如 uniapp 就是使用 Vue.js 所开发的。</p><p>Vue 能做的太多了，如果你恰好准备学 Web 方面，尤其是前端，毫不犹豫，直接学 Vue，Vue 在 github 上排名第三，star 高达 175k，凭这，就足以去学习一番。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"vuepress\">Vuepress<a class=\"hash-link\" href=\"#vuepress\" title=\"标题的直接链接\">​</a></h3><p>Vuepress 一个 Vue 驱动的静态网站生成器，可以用 Vuepress 来写文档，写博客，而我目前这个博客便是通过 Vuepress 实现而成。关于这个博客搭建过程就不在这花费口舌了。我有一篇文章专门讲述这个博客的搭建过程。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"对-web-开发做个小总结\">对 Web 开发做个小总结<a class=\"hash-link\" href=\"#对-web-开发做个小总结\" title=\"标题的直接链接\">​</a></h3><p>可以说没有前半年易语言学习所接触到的 Web 知识，就别说 Web 开发了，JS 估计都不会了解到，也因 JS，误打误撞闯进了 Web 开发的坑，让我领略到更多知识。</p><p>我算是作为 JS 语言的粉丝，听说过一句名言：凡是能用 JS 实现的最终都将用 JS 实现。即便不理解这句话的意思，但依旧这句话很喜欢，也许这就是对 JS 语言的一种爱吧。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/javascript.jpg\" alt=\"javascript\" class=\"img_ev3q\"></p><p>写到这，其实 Web 开发真就要告一段落了，实在是不想在折腾 Web 了，主要就两点</p><ul><li>不会设计，不知道该设计什么，实现什么功能</li><li>后端数据接口写的非常痛苦，Express 折磨了我一个月</li></ul><p>在页面设计方面，有组件库很方便，但是不知道要写什么好，就那个网络验证而言，我已经绞尽脑汁想添加写功能，但是奈何后端写的折磨，很多我都写不下去，就比如用户-角色-权限 这三者关系，我只写了用户-角色 还有权限没写，还有积分，与 nodejs 模拟数据这些写的都特别鸡肋，实在是写不动了（甚至说实在不想写了）。想转型写点其他的，后续有时间才把这个在做过多优化。</p><p>目前把博客和网络验证基本搭建好，现在脑子只想好好写写博客，把这一年要学过的东西好好巩固一番，尤其是这一段 Vue 的学习，收获到太多知识，都有点来不及消化。后续会将这些都部署在该博客上（不妨点个收藏收藏个书签呗）</p><p>不过我目前的 Web 开发还有很多没学到，而关于 Web 后续的学习的话，以目前的话应该是不会在花费大量时间去学了，学了也有半年了，自我感觉 Web 这方面还是不适合我，但确实这半年的 Web 学习挺充实的，不会接着深入学习,会用已学过的知识去写一些东西出来。（主要还是太想学习其他技术了）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结这一年学习经历\">总结这一年学习经历<a class=\"hash-link\" href=\"#总结这一年学习经历\" title=\"标题的直接链接\">​</a></h2><p>这一年学的确实多，相比于刚接触这行一年的人来说的话，我挺知足这一年能花费大量心思在这上面，同时还能坚持学下去，并爱上编程，于是乎从数学系转到了计算机系，但学还是自己学自己的，在我看来学校老师能教的，不如我课下自己学习的，况且编程单靠别人教是教不出什么玩意的，还真没听说过什么大神是另一个大神教出来了。</p><p>不过正是因为这种心态，也导致如今我连学校的课基本也都不会去上，能旷的课尽可能旷，旷课补觉，或者是宅在宿舍，坐在电脑前，盯着这赏心悦目的代码，和平时分相比它不香吗。既然旷课，那怎么能不挂科，虽然都是公共课，不过挺无所谓了。说件好玩事情，我大学英语挂了，没错，我英语说实在话就是不行，甚至我都没打算过四级考试，但这影响编写代码吗？不言而喻。</p><p>专业课的话，有的老师一般会认可我的能力，允许不去上课只考试就行，或者是不去也不会记名字，甚至和老师说一声不去就完事了。至少在我看来有时间在学校拿个文凭，不如直接用自己写过的项目去面试，至于看学历还是看能力，面试官一般都不看，因为只看简历呗。目前的话除了有关编程的事啥也不想干，估摸着在学一段时间就说不定真就辍学了呗，不，说不准还是给学校开除。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"身体状态\">身体状态<a class=\"hash-link\" href=\"#身体状态\" title=\"标题的直接链接\">​</a></h3><p>早已习惯了凌晨晚睡晚起，早上的课基本也都是旷了的那种，就已经习惯了旷课。再看看下午的课，不出意外的话，一般就是坐在电脑前到，到点了吃个饭，接着到凌晨 3,4 点，每天反复这样。我都不敢说我在这方面有天赋，我只觉得我每天花费在这方面的时间是别人的几倍罢了。</p><p><strong>哪有什么天生，一切不过是摧残出来罢了。</strong></p><p>说实在话，挺享受整天在电脑前办公的生活（相比于躺在床上玩游戏而言），不过熬夜，久坐，与长时间盯着屏幕，甚至是掉发，身体难免有些遭不住，并且我是能感受到，身体一天不如一天了。但它改变了我原有枯燥的生活，成天的游戏与娱乐，迷茫到不知所措， 如果没有 QQ 冻结，还有易语言，JS 这些，说真的，我现在极有可能还在某个床角玩着游戏，还对着屏幕傻笑（现在就特别想笑）。即使都是宅在家的生活，但编程能成为我养家糊口的资本，而游戏，它不行！甚至还可能成为我颓废的资本。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"事实告诉我我还有很多要学\">事实告诉我，我还有很多要学<a class=\"hash-link\" href=\"#事实告诉我我还有很多要学\" title=\"标题的直接链接\">​</a></h3><p>就在 9 月初，参加了一场网络安防（CTF）的比赛，真的是小巫见大巫，瞬间觉得自己还有很多要学的，虽然其他选手都很强，但也印衬了自己在这方面就是技不如人。说白就是自己菜，就是学的不够多，要是能在多学一点，说不定就多解一道题，多拿一点分，说不准就苟一波，吃个烂分。而事实是这是场没拿奖的比赛，而我是这场比赛的失败者。</p><p>不过有参与必有收获，确实让我学到了 Web 的一些渗透知识与一些工具的使用，也让我更加觉得外面的大佬是真的多，自己离他们还需要更加努力一把，这场比赛值了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"给别人的一些建议\">给别人的一些建议<a class=\"hash-link\" href=\"#给别人的一些建议\" title=\"标题的直接链接\">​</a></h3><p>我也仅能给别人一些我学习上的建议，也仅仅是当前，毕竟我接触这样也才一年多。我其实都不推荐去学编程这玩意，但我常常和别人说多花点时间在这上面，能写出些东西来。话是这么说，但真正肯去学的又有几个，即便学了坚持下去的又有几个，即便花费口舌去和他们介绍，但多数觉得难，但你说这个东西难吗，很难，但你说学不进去吗，也不至于，如今网络上生态这么好，学习编程的人越来越多，相互帮助的人也多，只要肯学，肯下功夫，随便一百度就有的结果，怎么可能学不会。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"多搜索少问人\">多搜索，少问人<a class=\"hash-link\" href=\"#多搜索少问人\" title=\"标题的直接链接\">​</a></h4><p>我这一年学习中，基本上就是看视频跟着视频教程一步一步照做，我一开始学习的时候也会在群里问过别人，也私下问过别人，但是有用吗？压根就没用，基本就没什么人会去鸟你的。百度它解决不了吗，如今强大搜索引擎会是你解决问题的最好选择（甚至我帮别人解决问题还是我将百度结果链接给别人）。有两句话，百度 5 分钟，问人 2 小时。百度能解决你百分之 99 的问题，但问人并不一定解决其中的百分之 1。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/006ARE9vgy1fwntelg0mlj30b40b4gm1.jpg\" alt=\"006ARE9vgy1fwntelg0mlj30b40b4gm1\" class=\"img_ev3q\"></p><p><strong>没点自行解决问题的能力真心劝别碰这行。</strong></p><p>我现在都有点反感那些没自行尝试，就直接问人的那种，有什么好问的，要么你学的不够多看不懂呗，要么就是你那里少做了什么步骤，大不了重新卸载安装重启来一遍嘛。主要没点自行解决问题的能力，到时候项目一来，出了一个 bug，或者开发环境与生产环境有问题，你问谁去？问了会回复你吗？能不能先自行看看是不是哪里少改的，或者版本的问题。说太多就是想强调一点，自行解决很重要，决定你适不适合干这行。</p><p>话也不能说的这么绝对，有时候搜索引擎确实不能有效的给到你想要的答案，比如我所用过的一个博客主题，是有交流群的，但有时候我百度了半天就是得不到我想要的结果，然后一问群，<strong>可能</strong>会一些<strong>热心伙伴</strong>会给你<strong>正确</strong>的答案，但往往是在你<strong>实在解决不了</strong>的情况问。毕竟，问了不一定答，但是不问一定不答。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"复制粘贴也是一门技术\">复制粘贴也是一门技术<a class=\"hash-link\" href=\"#复制粘贴也是一门技术\" title=\"标题的直接链接\">​</a></h4><p>别觉得偷别人代码有什么丢脸了，有的人甚至连偷都不会偷，而你早早就把项目给搞定了，别人会认可你的过程还是认可你的结果，必定是结果好吧，而且干这行的，基本上你见不到一个程序员是真的每一行每一行开始写起，而用的最多的三个键 Ctrl C V，不会真有程序员一行一行的敲吧，不会吧，不会吧。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/7280a4701a0daf98.jpg\" alt=\"7280a4701a0daf98\" class=\"img_ev3q\"></p><p>当然，上面也只是说笑了，只是现在都是模块化编程，什么意思呢，就比如我要实现一个自动发送邮件的功能，怎么办，直接搜索，比如 nodejs 中实现发送邮箱，于是就搜索到了 nodemailer 这个模块，二话不说，直接运行官方的 demo 案例，发现可以运行，能达到我想要的目的，接着就是自己简单的封装一下，直接给项目来使用，这不就成了吗？</p><p>然而要从 0 开始写一个发送邮件的服务端，别有这种想法，大概率不会想写的。就我目前而言吧，除了一开始学习新的技术外，会跟着敲一遍磨磨手感，到后面基本上都是从网络上偷各种源码，然后自己看一遍主要的地方是怎么实现的，然后对源码进行修改来达到我需要的目的。如今网络环境这么好，想要的功能随便一搜就有了，如果你能做到改别人的代码，那么别人这份代码你肯定也学进去了不少。为啥还要自己造轮子，尽可能利用别人已经写好的代码，而不是自己在手动写一份类似功能。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"定一下明年的目标\">定一下明年的目标<a class=\"hash-link\" href=\"#定一下明年的目标\" title=\"标题的直接链接\">​</a></h2><p>到目前为止，我还有好多想写的东西没写，好多好多都写了一半由于一些某某原因没继续写下去。同时还有好多想学的技术，好多都是之前学到一半卡着就没接着学下去了。至于能学多少，尽力而为吧，希望明年的这个时候，在回头看看自己所写的一些代码，都能感到一些惬意。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"进阶-web-开发\">进阶 Web 开发<a class=\"hash-link\" href=\"#进阶-web-开发\" title=\"标题的直接链接\">​</a></h3><p>Vue 才学了点皮毛，很多 HTML5 特性都没玩明白，CSS 也只会基本样式，就别说设计网页特效啥的，能看的过去就不错了，如果有时间的话一定会去接触写 React，毕竟和 Vue 一样，都属于人气爆棚的前端框架，很多大厂都使用 React 作为前端框架使用。</p><p>像 Webpack，Eslint 等等前端工具库，再如 JavaScript 的超集 Typescript，这些肯定都会去学习一番。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"进阶-python\">进阶 Python<a class=\"hash-link\" href=\"#进阶-python\" title=\"标题的直接链接\">​</a></h3><p>学过点 Python，但并非精通，有特别多的库都还没用过。主要说说为什么想学 Python，最主要的就是深度学习这方面，在前面我也写过，深度识别之图象识别，其次就是模拟数据请求这些，如果知道 Python，说到爬虫自然不陌生，不过爬虫对我来说并不敢兴趣，主要是 Python 好做模拟请求，http 协议这些，在易语言这些操作都是乱写，基本没啥难度，当然，http 协议难得不是模拟数据请求，而是在逆向分析数据加密，风控算法，所以网页逆向的基本功还是要有的。</p><p>当然，如果有可能还会接触一些 Python 的后端框架 Djongo 和 Flask，看看会不会符合自己的编程风格，再考虑是否要重写一些后端接口，当然最主要的还是想学习 tensorflow，我本地环境都搭建好了，然而却没有花大量时间去在这方面学习！</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安卓逆向与安卓开发\">安卓逆向与安卓开发<a class=\"hash-link\" href=\"#安卓逆向与安卓开发\" title=\"标题的直接链接\">​</a></h3><p>干这行前，我就是个重度手机使用者，或者说是玩机者。对于手机特别感兴趣，刷过机，拆修过手机，手头目前就有 5 台手机，对于电子设备可以说是又爱又恨了。用过的 APP 多，然而有些 APP 并不能达到我想要的目的，或者说有限制，于是就想尝试利用逆向技术去修改，奈何那时学了皮毛的安装逆向，根本不够用，也感到困难，于是就没继续学习，一开始的本心还是想搞安卓这方面。</p><p>如果可以的话，我更希望的是当一个安卓开发人员或者逆向分析工程师，而不是一个 Web 开发人员或者网络安全工程师。至于最后能如何，谁又能说的准呢。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"github\">github<a class=\"hash-link\" href=\"#github\" title=\"标题的直接链接\">​</a></h3><p>就目前而言，git 还有很多没玩明白，主要手头也没啥好开源的玩意，明年，一定多刷 github，当然最想的还是搞一个开源项目，还能在 github 上小有知名，那干这行真就无悔了。有点小野心，但以目前能力估计是够呛，想想就好，到时候技术上来的指不定就真成了呢。</p><p>这不才学了一年，才 20 出头，留给我的时间还多着很，在学个十年不成问题吧。但话是这么说，自己心里很清楚，已经有点学不进去了，就我写 Web 项目的这段时间，写着写着就去搞其他东西去了，实在是写的憋屈。总之已经没有一开始那么想学，那么有想法与灵感，那么肯于去学习新的技术，估摸着在学几年也许就会停滞于学习。</p><p>本以为年轻有的是精力，还曾妄想把好几门技术都学进去，但事实告诉我，能精通一个就不错了，学那么多意义又在哪，只是为了满足当初高中不认真学习的而又渴望学习的心吧。</p><p>总之，能学就尽量学，明年，理应更强。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"感谢\">感谢<a class=\"hash-link\" href=\"#感谢\" title=\"标题的直接链接\">​</a></h2><p>最后还是要感谢互联网的前辈们，与当下互联网的环境，不然的话我还可能在迷茫中四处摸索人生的真正意图，耗费着年轻所带来的资本。往着曾经写过的代码，眼角不禁也会湿润起来（绝不是熬夜太困），感叹当初为啥会去学这东西呢，也许这就是编程所带来的魅力吧。</p><p align=\"right\">写于2020年11月18日 &nbsp; &nbsp;By 愧怍</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/2019.7-2020.7-log",
            "title": "2019.7-2020.7编程年记",
            "summary": "前言",
            "date_modified": "2020-10-08T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "年终总结",
                "summary"
            ]
        },
        {
            "id": "brief-talk-http",
            "content_html": "<p>关于 HTTP 我不讲理论，只讲一下具体的用途。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"get-请求之发送验证码\">GET 请求之发送验证码<a class=\"hash-link\" href=\"#get-请求之发送验证码\" title=\"标题的直接链接\">​</a></h2><p>首先我举一个例子，收过短信验证码吧，一般来说在你注册账号的时候就会用到，会有一个点击发送验证码的按钮，这里以 网址 <a href=\"https://www.114yygh.com/\" target=\"_blank\" rel=\"noopener noreferrer\">114 预约挂号</a> 为例</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200928234944932.png\" alt=\"image-20200928234944932\" class=\"img_ev3q\"></p><p>输入完手机号，点击获取验证码就能收到验证码，但这背后的原理又是啥，服务器那边怎么知道我要验证码，并且我输入正确的验证码就进入，错误的就不行。而这正是网络协议 HTTP（关于 HTTP 相关的这里不做过多讲述，希望读者能自行百度了解），我先说下点击了获取验证码发生了什么，通过抓包工具可以获取到如下请求</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">GET https://www.114yygh.com/web/common/verify-code/get?_time=1601308153790&amp;mobile=15212345678&amp;smsKey=LOGIN HTTP/1.1</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Host: www.114yygh.com</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept: application/json, text/plain, */*</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Request-Source: PC</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.25 Safari/537.36 Core/1.70.3775.400 QQBrowser/10.6.4208.400</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Type: application/json;charset=UTF-8</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Referer: https://www.114yygh.com/</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept-Encoding: gzip, deflate, br</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept-Language: zh-CN,zh;q=0.9</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>首先我们向服务器发送了一个如上的请求，这是一个 GET 请求，同时请求的链接（url）为<code>https://www.114yygh.com/web/common/verify-code/get?_time=1601308153790&amp;mobile=15212345678&amp;smsKey=LOGIN</code></p><p>如果你会点英文的话，可能会理解其中的含义，主要就这几个参数<code>verify-code</code>验证码，<code>_time=1601308153790</code>时间戳（时间戳是一个记录时间的东西，用当前时间减去<code>1970-01-01 08:00:00</code>即可得到，你可以通过这个工具<a href=\"https://tool.lu/timestamp/\" target=\"_blank\" rel=\"noopener noreferrer\">时间戳在线转化</a>，这里的<code>1601308153790</code>所对应的时间为<code>2020-09-28 23:58:06</code>）还有一个<code>mobile=15212345678</code>，这个<code>15212345678</code>是我刚刚输入的手机号。这是向服务器请求的数据，那在来看看服务器返回给我们的是什么</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">HTTP/1.1 200</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Date: Mon, 28 Sep 2020 15:49:15 GMT</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Type: application/json;charset=UTF-8</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Length: 57</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Set-Cookie: hyde_session=Kd10cra3X4yNBePaaQTKUkuYgX9J6Hfx_5337693</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Set-Cookie: hyde_session_tm=1601308154470; Domain=.114yygh.com; Path=/; HttpOnly</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Security-Policy: : default-src *.114yygh.com *.qq.com *.baidu.com; font-src * data:</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-Content-Type-Options: nosniff</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-XSS-Protection: 1; mode=block</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-Frame-Options: SAMEORIGIN</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-Via-JSL: d8c5e31,-</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-Cache: bypass</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{\"resCode\":0,\"msg\":null,\"data\":{\"endMilliseconds\":59997}}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>只需要关注最后一行即可，其中 resCode 为 0，同时手机号<code>15212345678</code>也收到了验证码，貌似 resCode 为 0 就决定了服务器是否有给手机号发送短信，事实上也是的，那么说了这么多，有什么用呢，用处可大了。</p><p>既然这样，我知道了发送上面的那个请求服务器就能给对应的手机号发送验证码，那么我能不能将上面那个请求的手机号给改一下，改成<code>15287654321</code>，事实上是完全没问题的，这里我就放一张 HTTP 测试工具的截图。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929001306474.png\" alt=\"image-20200929001306474\" class=\"img_ev3q\"></p><p>那么是不是我多请求这样像服务器请求，我就能源源不断的收到验证码，现实很美好，人家服务器也不傻，我再一次向服务器发送请求，服务器给我的结果是</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{\"resCode\":10000,\"msg\":\"请58秒后重试\",\"data\":null}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>没错，就需要等，而且这里的 resCode 也不为 0，那么既然要等一分钟的话，我能不能写个定时脚本，每隔一分钟发送一次，人家服务器也不傻，一般来说，一个手机号最多也就收 5 次验证码，多了就会提示明天再重试，或者今天收到的验证码过多等等。而外面的炸则是通过收集几百个这样的请求，然后将手机号替换成要轰炸的，即可实现多平台验证码轰炸一个手机号。</p><p>现在你可能已经知道了初步了解 HTTP 请求，但一般的网站都不会像这个这么简单的，明文标码，通常都会进行效验，例如图片验证码，滑块，点字，点图等等，并且还会进行加密操作处理，而这才算真正的难点。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"post-请求之登录\">POST 请求之登录<a class=\"hash-link\" href=\"#post-请求之登录\" title=\"标题的直接链接\">​</a></h2><p>既然发验证码是这样，那如果是登录呢，下面就用网站 <a href=\"https://m.wcbchina.com/\" target=\"_blank\" rel=\"noopener noreferrer\">万创帮</a> 为例，首先进入登录界面</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929003119277.png\" alt=\"image-20200929003119277\" class=\"img_ev3q\"></p><p>输入手机号和密码，点击登录，同样的我们可以通过抓包工具获取到对应的 HTTP 请求，如下</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">POST https://m.wcbchina.com/api/login/login?rnd=0.6463111465399551 HTTP/1.1</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Host: m.wcbchina.com</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Connection: keep-alive</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Length: 149</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Pragma: no-cache</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Cache-Control: no-cache</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept: application/json, text/javascript, */*; q=0.01</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Origin: https://m.wcbchina.com</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">X-Requested-With: XMLHttpRequest</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">User-Agent: Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.25 Mobile Safari/537.36</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Content-Type: application/json</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept-Encoding: gzip, deflate, br</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">Accept-Language: zh-CN,zh;q=0.9</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">{\"auth\":{\"timestamp\":1601312429287,\"sign\":\"777473FB2A1838DBD64BA7A11C98911B\"},\"username\":\"15212345678\",\"password\":\"E9BC0E13A8A16CBB07B175D92A113126\"}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>貌似比上面那个发验证码的复杂，确实，这是一个 POST 请求，你在链接上看不出什么有效信息，在最后一行才是关键。这里的<code>timestamp</code>也就是时间戳，记录时间的，username 是我们输入的手机号（账号）没什么问题，这里的 sign 和 password 的内容又是啥？这就是加密，让你不能简单单纯的通过替换文本来实现登录，这就来分析一下他到底怎么加密的。</p><p>通过在浏览器按下 F12 键，打开控制台面板，接着点击 Network，这里会将我们发送的请求记录下来</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929004247182.png\" alt=\"image-20200929004247182\" class=\"img_ev3q\"></p><p>同时鼠标停在 Initiator 上有如下结果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929004449660.png\" alt=\"image-20200929004449660\" class=\"img_ev3q\"></p><p>不管三七二十一，点击跳转到对应的代码先，然后在左边下一个断点</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929004628978.png\" alt=\"image-20200929004628978\" class=\"img_ev3q\"></p><p>这时候我们在点击登录按钮看看</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929004713733.png\" alt=\"image-20200929004713733\" class=\"img_ev3q\"></p><p>没错，浏览器这时候停了下来，停在了我下断点的地方，通过函数名也可以猜到这个是发送的，对应的肯定在上面，通过右边的 Call Stack 函数调用栈即可追随上一函数</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929004943674.png\" alt=\"image-20200929004943674\" class=\"img_ev3q\"></p><p>在这里我看到了原文的信息，这是通过 Jquery 通过 id 获取元素的值，也就是这里的手机号和密码，在这里还都是原文，点到下一个函数则变成了密文，那么肯定是上一个函数做了手脚。</p><p>认真观察，N 这个是我们的密码，但对 N 进行了一个操作也就是 <code>a.hex_md5(N)</code>，没错，这就是 md5 加密。有关加密的可以看看我写过的 <a href=\"/examenEbau/浅谈加密算法\">浅谈加密算法</a></p><p>那么通过加密工具将 md5 加密是否能得到我们要的加密结果，如下</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929005711500.png\" alt=\"image-20200929005711500\" class=\"img_ev3q\"></p><p><code>E9BC0E13A8A16CBB07B175D92A113126</code>在看看 Password 的值，一模一样，看来已经解决了一个参数，那么还有一个<code>sign</code>呢。貌似右边的函数调用栈都不好使，我试试搜索字符串 sign 看看</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929005911119.png\" alt=\"image-20200929005911119\" class=\"img_ev3q\"></p><p>好家伙，直接定位到了，那么同样的在这里下一个断点，查看一下到底发生了什么（实际上 js 静态分析就完事了，这个网站太简单了）</p><p>这里的 N 看来就决定了 sign，而 N 也是通过 md5 加密的，不过原文我还不知道，让代码执行到这一行看看结果</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929010417525.png\" alt=\"image-20200929010417525\" class=\"img_ev3q\"></p><p>这里的 c 就是时间戳，而 token 和 password 都是未定义，那么就好办了。这里明文也就是 c <code>1601312429287</code>，那么用加密工具即可得到<code>777473FB2A1838DBD64BA7A11C98911B</code>，那么参数都搞定好了， 只需要替换一下账号，然后将正确的密码通过加密算法（这里为 md5）生成，同时对 sign 也生成出来，然后提交给服务器就能收到我们登录的请求，就认定为我们登录了，记录为在线用户。</p><p>如果我用的加密算法错了，或者我分析错了，提交给服务器会是怎么样的</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200929011055451.png\" alt=\"image-20200929011055451\" class=\"img_ev3q\"></p><p>例如我这里的 sign 算法是错了（将结尾的 B 改成了 A），发送给服务器，服务器返回给我们则是失败的结果，原因很简单，就是为了防止别人恶意登录所添加的效验，提交的数据伪成败，就决定了服务器给我们结果是成败。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>通过上面的一些例子，只要能伪造请求，发送给服务器，就能获取我们想要的结果或者目的，事实上也是如此，但伪造数据的难易则要由所对应的网站而定，有的网站压根就没没什么难度，而有的你搞一天都未必能搞的出来。如今的网站在这方面也都下足了功夫，想要轻松的伪造请求可不是件容易的事情了。</p><p>也正是因为我学了 HTTP 请求与 JS 逆向分析，我能做的也就更多，而正是基于 HTTP 协议下，其中一个就是有关于超星刷课软件的例子，如果我没有学过这些，我就不可能写出来。</p><p>后续会有关 HTTP 请求这方面都会放在逆向这个分类下，比如一些网站的加密算法和常见的坑等等。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/brief-talk-http",
            "title": "浅谈HTTP",
            "summary": "关于 HTTP 我不讲理论，只讲一下具体的用途。",
            "date_modified": "2020-09-29T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "http"
            ]
        },
        {
            "id": "chrome-plugin-development",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"前言\">前言<a class=\"hash-link\" href=\"#前言\" title=\"标题的直接链接\">​</a></h2><p>相关文章 <a href=\"https://developer.chrome.com/extensions/manifest\" target=\"_blank\" rel=\"noopener noreferrer\">谷歌官方文档</a> (需翻墙)</p><p><a href=\"http://blog.haoji.me/chrome-plugin-develop.html\" target=\"_blank\" rel=\"noopener noreferrer\">Chrome 插件开发全攻略</a> （强烈推荐看这一篇！）</p><p>你只需要看完上面那篇文章和掌握一些前端开发基础，就足以自行编写一个 Chrome 插件。本文也是基于上面文章加上自己之前写的插件所记。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"什么是-chrome-插件\">什么是 Chrome 插件<a class=\"hash-link\" href=\"#什么是-chrome-插件\" title=\"标题的直接链接\">​</a></h3><p>如果你用过 Chrome 浏览器的话，也许会用到过一些插件，其中比较知名的就是油猴插件，通过这些插件能够帮你例如自动完成一些功能，屏蔽广告，相当于一个浏览器内置的脚本。应该来说这是 Chrome 扩展开发，不过说 Chrome 插件更顺口，后文也会说成 Chrome 插件。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装-chrome-插件\">安装 Chrome 插件<a class=\"hash-link\" href=\"#安装-chrome-插件\" title=\"标题的直接链接\">​</a></h3><p>首先打开 Chrome，如下图即可进入插件的管理页面</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200922225606159.png\" alt=\"image-20200922225606159\" class=\"img_ev3q\"></p><p>这时候记得把右上角的开发者模式给勾上，如果不勾上的话你无法直接将文件夹拖入 Chrome 进行安装，就只能安装<code>.crx</code>格式的文件。Chrome 要求插件必须从它的 Chrome 应用商店（需要翻墙）安装，其它任何网站下载的都无法直接安装，所以可以把<code>crx</code>文件解压，然后通过开发者模式直接加载。</p><p>然后将写好的 Chrome 插件文件夹拖入到刚刚打开的插件管理页面即可。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"chrome-插件知识\">Chrome 插件知识<a class=\"hash-link\" href=\"#chrome-插件知识\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"manifestjson\">manifest.json<a class=\"hash-link\" href=\"#manifestjson\" title=\"标题的直接链接\">​</a></h3><p>是<code>manifest.json</code>切记不要英文单词打错字，一定要有这个文件，且需要放在根目录上，否则就会出现未能成功加载扩展程序的错误。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"backgroundhtml-和-backgroundjs\">background.html 和 background.js<a class=\"hash-link\" href=\"#backgroundhtml-和-backgroundjs\" title=\"标题的直接链接\">​</a></h3><p>可以理解为后台，同时这个页面会一直常驻在浏览器中，而主要 background 权限非常高，几乎可以调用所有的 Chrome 扩展 API（除了 devtools），基本很多操作都是放在 background 执行，返回给 content，而且它可以<strong>无限制跨域</strong>，也就是可以跨域访问任何网站而无需要求对方设置<code>CORS</code>。这对我们后面要在 content 中发送跨域请求至关重要！</p><p>我习惯的做法是通过<code>”page”：\"background.html\"</code>来导入<code>background.js</code>或其他 js 代码，如下</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// manifest.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"> </span><span class=\"token property\" style=\"color:#f92672\">\"background\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#f92672\">\"page\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"background.html\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!-- background.html --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token doctype punctuation\" style=\"color:#f8f8f2;font-style:italic\">&lt;!</span><span class=\"token doctype doctype-tag\" style=\"color:#8292a2;font-style:italic\">DOCTYPE</span><span class=\"token doctype\" style=\"color:#8292a2;font-style:italic\"> </span><span class=\"token doctype name\" style=\"color:#8292a2;font-style:italic\">html</span><span class=\"token doctype punctuation\" style=\"color:#f8f8f2;font-style:italic\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">html</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">head</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">背景页</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">title</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">meta</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">charset</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">utf-8</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">meta</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">http-equiv</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">Content-Type</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">content</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">text/html; charset=utf-8</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">head</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">body</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">text/javascript</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">js/jquery.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">text/javascript</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">js/background.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">body</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">html</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果是 scripts 方式导入 js 文件则需要反复修改<code>manifest.json</code>文件。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"关于乱码\">关于乱码<a class=\"hash-link\" href=\"#关于乱码\" title=\"标题的直接链接\">​</a></h4><p>有时候你在编写代码中出现了中文可能会出现了如下的乱码，</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200923214834081.png\" alt=\"image-20200923214834081\" class=\"img_ev3q\"></p><p>我遇到的原因是就是我原先的<code>background.html</code>代码写成如下的情况</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">text/javascript</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">js/jquery.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">text/javascript</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">src</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">js/background.js</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token script\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">script</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>没错，就只写了这两个行，就出现乱码（将 UTF-8 的编码变为了 windows1252），而只需要把 background.html 代码修改成正常的 HTML 结构，也就是上上面的那个代码即可解决该乱码情况。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"contentjs\">content.js<a class=\"hash-link\" href=\"#contentjs\" title=\"标题的直接链接\">​</a></h3><p>我们主要的向页面注入脚本就依靠这个文件，相当于给页面添加了一个 js 文件，但是<code>content</code>和原始页面<strong>共享 DOM</strong>，但是不共享 JS，如要<strong>访问页面 JS（例如某个 JS 变量）</strong>，只能通过<code>injected js</code>来实现（后文会提到）。并且<code>content</code>不能访问绝大部分<code>chrome.xxx.api</code>，除了下面这 4 种：</p><ul><li>chrome.extension(getURL , inIncognitoContext , lastError , onRequest , sendRequest)</li><li>chrome.i18n</li><li>chrome.runtime(connect , getManifest , getURL , id , onConnect , onMessage , sendMessage)</li><li>chrome.storage</li></ul><p>这些 API 绝大部分时候都够用了，非要调用其它 API 的话，你还可以通过通信来实现让 background 来帮你调用。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"injectjs\">inject.js<a class=\"hash-link\" href=\"#injectjs\" title=\"标题的直接链接\">​</a></h3><p>上文也说到了<code>content</code>是<strong>无法访问页面中的 JS</strong>，可以操作 DOM，但是 DOM 却不能调用它，也就是无法在 DOM 中通过绑定事件的方式调用<code>content</code>中的代码（包括直接写<code>onclick</code>和<code>addEventListener</code>2 种方式都不行），但是，<strong>在页面上添加一个按钮并调用插件的扩展 API</strong>是一个很常见的需求，那该怎么办呢？这时候就需要注入 inject.js 这个文件</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'DOMContentLoaded'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">injectCustomJs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 向页面注入JS</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">injectCustomJs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">jsPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  jsPath </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> jsPath </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'js/inject.js'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> temp </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">createElement</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'script'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  temp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">setAttribute</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'type'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text/javascript'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 获得的地址类似：chrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  temp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">src</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extension</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getURL</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">jsPath</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  temp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onload</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 放在页面不好看，执行完后移除掉</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">parentNode</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">removeChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">head</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">appendChild</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">temp</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>还没有完，因为注入有权限，所以需要在 manifest.json 声明一下这个文件。也就是下面的这行代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"web_accessible_resources\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"js/inject.js\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这样你就能调用</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"关于消息通信\">关于消息通信<a class=\"hash-link\" href=\"#关于消息通信\" title=\"标题的直接链接\">​</a></h3><p>Chrome 插件主要就 4 个部分组成，injected，content，popup，background，但这 4 个部分所对应的权限，应用都有可能各自不一，这时候就需要通过消息通信，将对应的数据发送到对应的文件，主要也就如下四种通信方式：</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"popup-和-background\">popup 和 background<a class=\"hash-link\" href=\"#popup-和-background\" title=\"标题的直接链接\">​</a></h4><p>popup 可以直接调用 background 中的 JS 方法，也可以直接访问 background 的 DOM：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// background.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">alert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'我是background！'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// popup.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> bg </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extension</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getBackgroundPage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">bg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">test</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 访问bg的函数</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">alert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">bg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">body</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">innerHTML</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 访问bg的DOM</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>background</code>访问<code>popup</code>如下（前提是<code>popup</code>已经打开）：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> views </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">extension</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getViews</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'popup'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">views</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">views</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"popup-或-bg-与-content\">popup 或 bg 与 content<a class=\"hash-link\" href=\"#popup-或-bg-与-content\" title=\"标题的直接链接\">​</a></h4><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"popup-或-bg-向-content-发送请求\">popup 或 bg 向 content 发送请求<a class=\"hash-link\" href=\"#popup-或-bg-向-content-发送请求\" title=\"标题的直接链接\">​</a></h5><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//background.js或popup.js：</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">sendMessageToContentScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">message</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> callback</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">tabs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">query</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">active</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">currentWindow</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">tabs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">tabs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">sendMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">tabs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> message</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">callback</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">callback</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">sendMessageToContentScript</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">cmd</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'test'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">value</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'你好，我是popup！'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'来自content的回复：'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>content.js</code>通过监听事件接收：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">onMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">request</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sender</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// console.log(sender.tab ?\"from a content script:\" + sender.tab.url :\"from the extension\");</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cmd</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'test'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">alert</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'我收到了你的消息！'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"content-向-popup-或-bg\">content 向 popup 或 bg<a class=\"hash-link\" href=\"#content-向-popup-或-bg\" title=\"标题的直接链接\">​</a></h5><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// content.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">sendMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">greeting</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'你好，我是content呀，我主动发消息给后台！'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'收到来自后台的回复：'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//background.js 或 popup.js：</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// 监听来自content的消息</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">onMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">request</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sender</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'收到来自content的消息：'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> sender</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'我是后台，我已收到你的消息：'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token known-class-name class-name\" style=\"color:#e6db74\">JSON</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stringify</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">request</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>注意：</p><ul><li>content_scripts 向<code>popup</code>主动发消息的前提是 popup 必须打开！否则需要利用 background 作中转；</li><li>如果 background 和 popup 同时监听，那么它们都可以同时收到消息，但是只有一个可以 sendResponse，一个先发送了，那么另外一个再发送就无效；</li></ul><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"injected-和-content\">injected 和 content<a class=\"hash-link\" href=\"#injected-和-content\" title=\"标题的直接链接\">​</a></h4><p>主要就是<code>injected</code>向<code>content</code>发送，<code>injected</code>无需监听。</p><p><code>content</code>和页面内的脚本（<code>injected</code>自然也属于页面内的脚本）之间唯一共享的东西就是页面的 DOM 元素，有 2 种方法可以实现二者通讯，：</p><ol><li>可以通过<code>window.postMessage</code>和<code>window.addEventListener</code>来实现二者消息通讯；（推荐）</li><li>通过自定义 DOM 事件来实现（我就懒得写了，没怎么用到）；</li></ol><p><code>injected</code>中：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">postMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">test</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'你好！'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'*'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>content script中</code>：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">window</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token string\" style=\"color:#a6e22e\">'message'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"injected-与-popup\">injected 与 popup<a class=\"hash-link\" href=\"#injected-与-popup\" title=\"标题的直接链接\">​</a></h4><p><code>injected</code>无法直接和<code>popup</code>通信，必须借助<code>content</code>作为中间人。不过一般这种都少，直接和 bg 通信即可。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"我的模板\">我的模板<a class=\"hash-link\" href=\"#我的模板\" title=\"标题的直接链接\">​</a></h2><p>关于 Chrome 的主要内容也就这些，实际开发如果有个模板就能大大方便开发，在原文章中该作者已经分享了有对应的源代码，这里放上我自写的 Chrome 模板编写过程。</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210820004414785.png\" alt=\"image-20210820004414785\" class=\"img_ev3q\"></p><p>当然，这里需要提几点地方：</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"配置项与-storage\">配置项与 storage<a class=\"hash-link\" href=\"#配置项与-storage\" title=\"标题的直接链接\">​</a></h3><p>首先是配置方面，有时候插件的内的选项是要记录，以便下一次在启动插件的时候还是上一次的配置。先看代码</p><div class=\"language-html codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-html codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!-- popup.js --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config-item</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">input</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">checkbox</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">id</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config1</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">box configs</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">label</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">hand</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">for</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config1</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">title</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">配置1</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">配置1</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">label</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config-item</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">input</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">type</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">checkbox</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">id</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config2</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">box configs</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">/&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;</span><span class=\"token tag\" style=\"color:#f92672\">label</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">class</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">hand</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">for</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">config2</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag\" style=\"color:#f92672\"> </span><span class=\"token tag attr-name\" style=\"color:#a6e22e !important\">title</span><span class=\"token tag attr-value punctuation attr-equals\" style=\"color:#f8f8f2\">=</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag attr-value\" style=\"color:#f92672\">配置2</span><span class=\"token tag attr-value punctuation\" style=\"color:#f8f8f2\">\"</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\">配置2</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">label</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&lt;/</span><span class=\"token tag\" style=\"color:#f92672\">div</span><span class=\"token tag punctuation\" style=\"color:#f8f8f2\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// popup.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> configs </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getElementsByClassName</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'configs'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> type </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">type</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'checkbox'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onchange</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">storage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">sync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">checked</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">storage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">sync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">items</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">checked</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> items</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">else</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">type </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'text'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> type </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'password'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method-variable function-variable method function property-access\" style=\"color:#e6db74\">onblur</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">storage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">sync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">set</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">storage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">sync</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">get</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">items</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">value</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> items</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">configs</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">''</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可能需要多花点时间才能理解上面代码的意思，首先我在需要记录配置的地方添加了一个类<code>configs</code>，然后通过 js 代码遍历类名为<code>configs</code>，接着判断是多选框，还是输入框，input 的 id 为键名，value 为键值，来 set 或 get <code>chrome.storage</code>的值，然后进行事件绑定为修改配置后在记录一下配置。这里需要注意一下，写配置的时候<code>{ [this.id]: this.value }</code>这里的<code>this.id</code>是加了中括号的，原因就是这个 this.id 是变量，如果不加的话默认为字符串，但在这里有.所以是会报错的。</p><p>强烈不建议用 localStorage，我当初第一遍学的时候没学明白，我还通过消息通信将配置信息发给<code>content</code>，然后还用 localStorage 记录一遍，现在才发现<code>chrome.storage</code>是针对插件全局的，即使你在<code>background</code>或者<code>popup中</code>保存的数据，在<code>content</code>也能获取到。</p><p>当然这种读写配置的也算麻烦了，不像桌面级开发的读写配置。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"悬浮窗\">悬浮窗<a class=\"hash-link\" href=\"#悬浮窗\" title=\"标题的直接链接\">​</a></h3><p>首先，一般对于网页端的插件，能提供的页面最好方式就是悬浮窗了，这里我也是通过 DOM 创建元素生成对象。而这个悬浮窗是针对页面的，而不是像 popup 那样。相关的页面初始化代码如下，</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token keyword\" style=\"color:#66d9ef\">var</span><span class=\"token plain\"> view </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">show</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">cache</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">count</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">mouse_x</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#f92672\">mouse_y</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">initView</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token template-string string\" style=\"color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;div id=\"box\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">style=\"position: fixed;border: 1px double rgb(0,0,0); width: 300px; top: 30px; right: 1%; z-index: 999999; font-size: 15px; background-color: rgb(255,255,255); color: #000000;user-select:none;\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;div style=\"position: relative;\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;button name=\"show\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">        style=\"position: absolute;top: 50%;right:1%; margin-top: 7px; line-height: 18px;overflow:hidden;border: 0px double rgb(0,0,0);cursor:pointer;font-size: 18px;background-color: rgb(255,255,255);\"&gt;－</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;/button&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;div id=\"kz_title\" style=\"height: auto; margin: 5px; font-size: 16px;\"&gt;日志&lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"display:inline-block;color:#a6e22e\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;div id=\"kz_main\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;hr&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;form&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">        &lt;div style=\"margin-top: 5px;overflow-y: auto;\"&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;button id=\"kz_id1\" name=\"cleanlog\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">                style=\"margin-left: 10px;float:left;border-radius:0em;overflow:hidden;border: 1px double rgb(0,0,0);background-color: rgb(255,255,255);\"&gt;功能按钮&lt;/button&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">            &lt;button id=\"kz_id2\" name=\"cleanlog\"</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">                style=\"margin-left: 10px;float:left;border-radius:0em;overflow:hidden;border: 1px double rgb(0,0,0);background-color: rgb(255,255,255);\"&gt;功能按钮&lt;/button&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">        &lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;/form&gt;&lt;br&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    &lt;div id=\"logList\"&gt;&lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">&lt;/div&gt;</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token template-string string\" style=\"color:#a6e22e\">    </span><span class=\"token template-string template-punctuation string\" style=\"color:#a6e22e\">`</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">info</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#info'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_title</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#kz_title'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_main</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">find</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#kz_main'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">appendTo</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'body'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">delegate</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'button'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'click'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stopImmediatePropagation</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">stopPropagation</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    e</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">preventDefault</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> name </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">attr</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'name'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">name </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'show'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">html</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">show</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">?</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'＋'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'－'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">show</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!</span><span class=\"token plain\">view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">show</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_main</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">slideToggle</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">addViewMouseListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'日志输出1'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'日志输出2'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'日志输出3'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">addViewMouseListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">bind</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'mousedown'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">x</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">left</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">this</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">position</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">top</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_x</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">originalEvent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientX</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">originalEvent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientY</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//console.log(view.cache.mouse_x, view.cache.mouse_y, view.cache.x, view.cache.y)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">bind</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'mousemove'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//计算出现在的位置是多少</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_x</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">kz_title</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">return</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">originalEvent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientX</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_x</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">x</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">originalEvent</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">clientY</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">y</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//加上边界限制</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//当上边的偏移量小于0的时候，就是上边的临界点，就让新的位置为0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//如果向下的偏移量大于文档对象的高度减去自身的高度，就让它等于这个高度</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&amp;&amp;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">height</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//右限制</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">width</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">&lt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">//左边的偏移量小于0的时候设置 左边的位置为0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">float</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">css</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">left</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> new_position_left </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'px'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">top</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> new_position_top </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'px'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">bind</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'mouseup'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_x</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    view</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cache</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">mouse_y</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">msg</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> color</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> date </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:#e6db74\">Date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> t </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getHours</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">':'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getMinutes</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">':'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> date</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">getSeconds</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  msg </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> t </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'  '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> msg</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> div </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'&lt;div class=\"log\"&gt;&lt;/div&gt;'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">css</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token string-property property\" style=\"color:#f92672\">'border-color'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'rgba(121, 187, 255, 0.2)'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string-property property\" style=\"color:#f92672\">'background-color'</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'rgba(121, 187, 255, 0.2)'</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> log </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'&lt;p&gt;&lt;span style=\"color: '</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">color </span><span class=\"token operator\" style=\"color:#66d9ef\">||</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'#409EFF'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'\"&gt;'</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> msg </span><span class=\"token operator\" style=\"color:#66d9ef\">+</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'&lt;/span&gt;&lt;/p&gt;'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'.log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">for</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">0</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'.log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">length</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">15</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"> i</span><span class=\"token operator\" style=\"color:#66d9ef\">++</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'.log'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\">i</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">remove</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:#e6db74\">$</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'#logList'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">append</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">div</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">append</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后在 content.js 内容的对页面 url 判断是否需要初始化悬浮窗即可</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token dom variable\" style=\"color:#f8f8f2\">document</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addEventListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'DOMContentLoaded'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token dom variable\" style=\"color:#f8f8f2\">location</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">host</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">indexOf</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">'chaoxing'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">!=</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">-</span><span class=\"token number\" style=\"color:#ae81ff\">1</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">initView</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如何发挥就看各位了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"跨域请求\">跨域请求<a class=\"hash-link\" href=\"#跨域请求\" title=\"标题的直接链接\">​</a></h3><p>关于跨域请求，我当初在学习 Chrome 插件的时候，就是卡在了跨域这个地方，那时候前端学的浅，对跨域都不知道处理，然后放弃学习了 Chrome 插件一段时间，后来有时间了，想在补一补之前没写完的 Chrome 扩展搞完。然而跨域请求非常简单，而我那时候之所以卡住就是因为没好好看文档，搞不定的地方就多看几遍说不准就搞定了。</p><p>首先要使 Chrome 插件访问跨域资源，需要在 manifest.json 文件中声明要访问的域如下：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"permissions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"http://www.google.com/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"http://*.google.com/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://*.google.com/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"http://*/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>建议直接直接暴力点写上</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">\"permissions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token string\" style=\"color:#a6e22e\">\"http://*/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://*/*\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>然后封装一下对应的 ajax 请求，因为在 content 内进行 ajax 请求，是会在控制台输出跨域请求拦截，或者是 HTTPS 访问 HTTP 不安全等问题，这时候就需要通过消息通信，将 content 要发送的请求发送给 bg，让 bg 请求，然后等 bg 请求完毕，再将数据返回到 content 即可。下面是我对应的封装代码</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// background.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">onMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">addListener</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">req</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sender</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> sender</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"color:#66d9ef\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">cmd</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ajax'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    $</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">ajax</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> req</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token literal-property property\" style=\"color:#f92672\">async</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">false</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token function-variable function\" style=\"color:#e6db74\">success</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token function\" style=\"color:#e6db74\">sendResponse</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">res</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">// content.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#e6db74\">sendAjaxToBg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">url</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> type</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> data</span><span class=\"token parameter punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token parameter\"> callback</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  chrome</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">runtime</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">sendMessage</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">cmd</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'ajax'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">url</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> url</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">type</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> type</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token literal-property property\" style=\"color:#f92672\">data</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> data </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#e6db74\">callback</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这里的话我通信发送的是 js 对象，其中 cmd 决定了我要的操作，后台通过判断 cmd 来执行对应的操作。比较不好理解的是回调函数，由于 JS 自身语言的因素与浏览器的问题，很多事件都是先挂着，后做完在回调，所以我这里就封装成这种形式，例如</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">sendAjaxToBg</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"http://...\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"GET\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword null nil\" style=\"color:#66d9ef\">null</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#66d9ef\">function</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token console class-name\" style=\"color:#e6db74\">console</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">log</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token plain\">response</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token spread operator\" style=\"color:#66d9ef\">...</span><span class=\"token plain\">code</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这只是一个简单的 http 封装发送，如果要更复杂的话还可以添加协议头和 cookies，这里就不在补充了。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"一些自写-chrome-插件\">一些自写 Chrome 插件<a class=\"hash-link\" href=\"#一些自写-chrome-插件\" title=\"标题的直接链接\">​</a></h3><p>实际上已经写过一些 Chrome 插件了，奈何写的比较烂或没搞完，也就暂时先不发，有时间会再整理一下自己所写的。</p><p>一个验证码识别，有时候在登录的时候需要输入验证码是件非常痛苦的事情。于是乎我就通过调用打码 Api 接口写了个自动识别验证码并填写的。也提供了非常方便的右键识别验证码的功能。具体效果如图（实际上还是得第一次先确认要识别的图片框与输入框，下次加载的时候需要手动点击验证码才会自动生效，还是不够智能的，不过成就感十足）</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20210820001938051.png\" alt=\"image-20210820001938051\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/wydm.gif\" alt=\"wydm\" class=\"img_ev3q\"></p><p>另一个是基于某布大佬的 WebHook 工具，所更改的，不过一直停滞着，有空将其完善一下。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/chrome-plugin-development",
            "title": "Chrome插件开发",
            "summary": "前言",
            "date_modified": "2020-09-28T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "chrome",
                "plugin",
                "develop"
            ]
        },
        {
            "id": "first-blog-is-vuepress",
            "content_html": "<p>感谢 <a href=\"https://vuepress-theme-reco.recoluan.com/\" target=\"_blank\" rel=\"noopener noreferrer\">vuepress-theme-reco</a>主题与一篇博客使用文章<a href=\"https://lookroot.cn/views/article/vuepress.html#reco%E4%B8%BB%E9%A2%98\" target=\"_blank\" rel=\"noopener noreferrer\">使用 vuepress 构建个人博客</a></p><p>在写这篇文章前，本人非前端专业人士，只是一时兴起想开始搭建一个博客，在该博客上记录与分享一下自己所学的一切内容。（然后现在都在往前端这方向走了😂）</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"补充\">补充<a class=\"hash-link\" href=\"#补充\" title=\"标题的直接链接\">​</a></h2><p>不打算破坏之前所写的一些内容，将一些补充的内容写在开头，目前访问 kzcode.cn 依旧能访问到该站，不过文章都保留原有未变动，图片都是直接跟随 MD 文档下，加上服务器又比较拉，所以访问会稍带卡顿。这篇合理来说也算我的第一篇博客，所以还是有必要记录一下的。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"为什么写博客\">为什么写博客<a class=\"hash-link\" href=\"#为什么写博客\" title=\"标题的直接链接\">​</a></h2><p>在接触软件行业的这一年里，也学到了很多很多很多的知识，也让我感受到代码的魅力与强大。在这学习过程中，百度到了各种相关学习文章，而这些正式前辈们所分享的学习经历，倘若没有这些，我可能早已停下学习的步伐。一时兴起，萌生了搭建博客的想法，然后开始搜索搭建博客的知识，于是乎就有了这篇文章。</p><p>写博客是为了记录自己，记录自己学习中的过程，知识，遇到的坑，写成一篇文章，也许过了几个月后的自己脑子不好使，忘记是如何解决的，回过头来看，瞬间焕然大悟。同时也能巩固自己所学的，在如今这个时代，技术更新换代是真的快，而要求学的东西也就越来越多。有时候学过的一项技术，过了几个月真的说忘就忘，不时常记录一下当初写的笔记，翻看之前写过的代码，那真的就和重新学习没什么两样了。</p><p>在此期间曾遇到许多坑，而解决最好的办法就是百度。在百度搜索过程中看到了许许多多的学习者分享自己那时候与我遇到一样的问题，说明他是如何解决的，并写文章。有时运气好可能他的解决办法同样也是我的解决办法，但往往总是不尽人意，这时需要再看下一个相关搜索或者下下个才能解决我的问题，这在学习过程中是必不可少的一个环节。而他们所分享的内容，就是一篇篇的博客。正是这一篇篇博客解惑学习者学习中的问题，让他们有自信再去学习下去！</p><p>于是就萌生的一种想法，利用自己所学的 Web 知识开始搭建属于自己的个人博客，分享自己所遇到的坑，希望能解决遇到同样问题的人。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"初步搭建博客界面\">初步搭建博客界面<a class=\"hash-link\" href=\"#初步搭建博客界面\" title=\"标题的直接链接\">​</a></h3><p>要展示给别人看，就必须得搞前端 UI 界面，同时为了快速开发，我又百度了相关的前端 UI 框架，其中决定用 layui，界面风格布局可以接受，于是乎在搜索用过 layui 框架搭建的个人博客，成功找到一篇博主<a href=\"https://www.yanshisan.cn/\" target=\"_blank\" rel=\"noopener noreferrer\">燕十三一个人的江湖</a>分享的模板源码，然后开始大改，最终花了几个小时修改了大致页面</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200901012343086.png\" alt=\"image-20200901012343086\" class=\"img_ev3q\"></p><p>然后问题来了，前端大致界面设计好了，我最关心的文章要怎么写。。。而这份源码是没有给后端这些的（此时的我刚入前端，后端毛也不会），就一个纯前端页面，连文章模板都没有，可能是真的没什么可整理的，于是就放弃了自己手动搭建，主要还是那时候太菜了。</p><p>就在想用纯静态页面，还是用动态页面，对于动态页面获取文章数据的技能并不熟练。然后发现这种想法并不行，还是得借助外界提供现有的博客系统来写，于是乎停滞了一段时间，去搜索一系列相关的博客系统（合理来说应该是静态文件生成器），如 Hexo 或 WordPress，不过为啥选择 vuepress，因为我那时候正好在学 Vue，于是乎又开始新的一番折腾。不过也好，如果以后写技术文档，vuepress 也是一个非常推荐的选择。后续的话可能会去接触一下 Hexo 的 butterfly 主题，希望学到点东西，能给自己的博客在增添几份美感。</p><p>我所用的主题是<a href=\"https://vuepress-theme-reco.recoluan.com/\" target=\"_blank\" rel=\"noopener noreferrer\">vuepress-theme-reco</a> 也非常推荐用这个主题来写博客，下面会简单介绍这款主题</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"reco-主题\">reco 主题<a class=\"hash-link\" href=\"#reco-主题\" title=\"标题的直接链接\">​</a></h2><blockquote><p>一款简洁而优雅的 vuepress 博客 &amp; 文档 主题。官方文档<a href=\"https://vuepress-theme-reco.recoluan.com/\" target=\"_blank\" rel=\"noopener noreferrer\">立即前往</a></p></blockquote><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/152702-539475.png\" alt=\"image-20200515152702435\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安装\"><strong>安装</strong><a class=\"hash-link\" href=\"#安装\" title=\"标题的直接链接\">​</a></h3><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#全局安装vuepress-reco</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install @vuepress-reco/theme-cli -g</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 初始化 (blog改成你要的文件名)  然后填写项目标题等等</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">theme-cli init blog</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 进入项目目录</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">cd blog</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">#安装依赖包</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm install</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 运行</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run dev</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"># 编译</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm run build</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>执行完<code>npm run dev</code>运行后，点击控制台的对应地址 你就能看到</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200901191643031.png\" alt=\"image-20200901191643031\" class=\"img_ev3q\"></p><p>当然，可能标题和一些会不一样，因为我更改了两处地方一处是<code>blog</code>下的<code>README.md</code>文件，文件结构如下</p><div class=\"language-markdown codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-markdown codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token hr punctuation\" style=\"color:#f8f8f2\">---</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">home: true</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">heroText: 愧怍的个人空间</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">tagline: 我是愧怍,沉迷于代码无法自拔</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">...</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>这个是决定首页的样式，具体要什么背景，内容就因人而异。</p><p>另一处是<code>.vuepress\\config.js</code>里的内容，内容有点多，我依次来讲</p><p>首先是开头几行的，title 决定你网站的标题，description 则是一开始出场界面的描述</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#66d9ef\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">title</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'愧怍的小站'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">description</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">'如果代码都解决不了的话,那可能真的解决不了'</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>随后你要关注的就是 themeConfig 下的 author，也就是作者名，改成你的名字就行</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"logo\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/logo.png\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"search\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:#ae81ff\">true</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"searchMaxSuggestions\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">10</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"lastUpdated\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Last Updated\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"author\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"愧怍\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"authorAvatar\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/logo.png\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"record\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"xxxx\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"startYear\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"2017\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其余的一些，比如<code>logo.png</code>与<code>avatar.png</code>啊，你换成你的想要的头像就行，他们都存放在.<code>vuepress\\public</code>下,然后就是修改标题栏，他们都放在<code>themeConfig</code>下的<code>nav</code>里，这里你想修改哪个导航栏，就改哪个导航栏与标题，文末我会放上我的全部代码。</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string-property property\" style=\"color:#f92672\">\"themeConfig\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token string-property property\" style=\"color:#f92672\">\"nav\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Home\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"link\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reco-home\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"TimeLine\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"link\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/timeline/\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reco-date\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Docs\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reco-message\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"items\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"vuepress-reco\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"link\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"/docs/theme-reco/\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Contact\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reco-message\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"items\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"GitHub\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"link\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"https://github.com/recoluan\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">            </span><span class=\"token string-property property\" style=\"color:#f92672\">\"icon\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"reco-github\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">]</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>还有一个是主题自带的导航栏配置，这里你只需要更改 text 与 location 即可，其余不建议更改，你到时候写的文章都在依靠这两个</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token string-property property\" style=\"color:#f92672\">\"blogConfig\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token string-property property\" style=\"color:#f92672\">\"category\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"location\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">2</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Category\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token string-property property\" style=\"color:#f92672\">\"tag\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"location\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#ae81ff\">3</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">        </span><span class=\"token string-property property\" style=\"color:#f92672\">\"text\"</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#a6e22e\">\"Tag\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>zhuyi 你每次修改修改 config 的内容，就需要重新<code>npm run dev</code> vuepress 不支持热更新，也就是文件内容给修改了你需要重新编译运行，这是初学接触会遇到的坑。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"编写文章\">编写文章<a class=\"hash-link\" href=\"#编写文章\" title=\"标题的直接链接\">​</a></h3><p>现在有了一个页面风格不错，同时还是响应式页面，就差文章了。这时候你就需要了解 vuepress 的<a href=\"https://vuepress.vuejs.org/zh/guide/markdown.html#front-matter\" target=\"_blank\" rel=\"noopener noreferrer\">Markdown 拓展</a>，我这里简单叙述一下，你该怎么写文章，下面是你要写文章的模板，你只需要关注几个内容就行了，</p><div class=\"language-markdown codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-markdown codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block punctuation\" style=\"color:#f8f8f2\">---</span><span class=\"token front-matter-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">title</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> 笔记模板</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">date</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> </span><span class=\"token front-matter-block front-matter yaml language-yaml datetime number\" style=\"color:#ae81ff\">2020-08-21</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">tags</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\">  </span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> 笔记</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">categories</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\">  </span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> 个人学习笔记</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">author</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> 愧怍</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">keys</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\">  </span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> </span><span class=\"token front-matter-block front-matter yaml language-yaml string\" style=\"color:#a6e22e\">'e9bc0e13a8a16cbb07b175d92a113126'</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">publish</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> </span><span class=\"token front-matter-block front-matter yaml language-yaml boolean important\" style=\"color:#ae81ff\">false</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">sticky</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> </span><span class=\"token front-matter-block front-matter yaml language-yaml number\" style=\"color:#ae81ff\">1</span><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block front-matter yaml language-yaml\"></span><span class=\"token front-matter-block front-matter yaml language-yaml key atrule\">isShowComments</span><span class=\"token front-matter-block front-matter yaml language-yaml punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token front-matter-block front-matter yaml language-yaml\"> </span><span class=\"token front-matter-block front-matter yaml language-yaml boolean important\" style=\"color:#ae81ff\">false</span><span class=\"token front-matter-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token front-matter-block\"></span><span class=\"token front-matter-block punctuation\" style=\"color:#f8f8f2\">---</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">::: tip</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">这是 tip</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">:::</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#8292a2;font-style:italic\">&lt;!--more --&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token title important punctuation\" style=\"color:#f8f8f2\">##</span><span class=\"token title important\"> 这是你的文章内容</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">正文内容</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>---</code> 所包裹的内容就文章简述像下面这样</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200901034715126.png\" alt=\"image-20200901034715126\" class=\"img_ev3q\"></p><p>要更改标题，日期外，你还需要更改的是分类 categories 和标签 tags，举个例子，现在我想写一篇文章，标题是 ES6 语法，那么我可以这么写</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token key atrule\">tags</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> ES6</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> javascript</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> js</span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token key atrule\">categories</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">-</span><span class=\"token plain\"> JavaScript</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>分类只写一个，可以写<code>JavaScript</code>（分类建议大写），标签写多个，然后你把你写的这篇文章，切记放在<code>blogs</code>目录下(以后写的博客都放在这里)，同时建一个文件夹名为<code>JavaScript</code>，的然后把文章放在这个目录下，文章名随意，建议和标题一样，如 ES6 语法.md。便于你以后分类，请按这样的方式归类文章。</p><p>万一我不小心<code>- JavaScript</code> 写成了 <code>- Java</code>，而并没有文件夹是<code>Java</code>的，没关系，也就是你在分类上看到 Java，文章分类不取决于文件夹名，而取决于<code>categories</code> 只是文件夹名和<code>categories</code>名一致便于分类罢了。</p><p>在标签页上，就能看到 ES6，javascript，与 js 的标签，方便定位相关文章</p><p>接着把要写的文章内容全都在写在<!-- -->下即可，这里要注意一下，正文内容的标题，从二级标题开始，一级标题就已经是 title 了，在写也没用。</p><p>其余相关的 key 和 publish 等相关参数还请读者查看 reco 主题的官方文档<a href=\"https://vuepress-theme-reco.recoluan.com/\" target=\"_blank\" rel=\"noopener noreferrer\">立即前往</a>与 vuepress 官网<a href=\"https://vuepress.vuejs.org/zh/\" target=\"_blank\" rel=\"noopener noreferrer\">立即前往</a></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"样式修改\">样式修改<a class=\"hash-link\" href=\"#样式修改\" title=\"标题的直接链接\">​</a></h3><p>可能你会局限于 reco 主题的默认样式，这里就说下如何修改样式。如果你会点前端，这应该来说非常简单。</p><ol><li>先参考这篇文章 <a href=\"https://vuepress-theme-reco.recoluan.com/views/other/reco-optimization.html\" target=\"_blank\" rel=\"noopener noreferrer\">个人向优化</a>，我这里简单说明一下，首先一定要把<code>node_modules</code>里的<code>vuepress-theme-reco</code>这个主题文件夹整个放在<code>.vuepress\\theme\\</code>下，因为有些时候我们是要修改源码来更改样式的，如果你不这样做的话，而是直接修改<code>node_modules</code>里面的文件，你<code>npm install</code>就会覆盖你修改后的，所以要这一步操作。</li><li>当然你已经觉得 reco 主题都很完美了，不需要更改源码，那么你只需要在 <code>.vuepress/styles/</code> 来创建文件<code>index.styl</code>来方便地添加额外样式（还有一个默认样式，不推荐修改），然后把你要修改的样式代码写在<code>index.styl</code>文件里即可，例如我要修改首页的字体颜色，右键检查找到对应的 css 选择器，然后在<code>index.styl</code>添加就行，如</li></ol><div class=\"language-css codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-css codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.home-blog</span><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"> </span><span class=\"token selector class\" style=\"color:#a6e22e;font-style:italic\">.hero</span><span class=\"token selector\" style=\"color:#a6e22e;font-style:italic\"> h1</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token property\" style=\"color:#f92672\">color</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">:</span><span class=\"token plain\"> </span><span class=\"token hexcode color\">#fff</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"部署到服务器上\">部署到服务器上<a class=\"hash-link\" href=\"#部署到服务器上\" title=\"标题的直接链接\">​</a></h3><p>关于部署到服务器上，如果只是为了让别人能看到你搭建的博客，而不是要购买域名和服务器这些，直接参考文章<a href=\"https://lookroot.cn/views/article/vuepress.html#reco%E4%B8%BB%E9%A2%98\" target=\"_blank\" rel=\"noopener noreferrer\">使用 vuepress 构建个人博客</a>即可，如果有服务器和域名我这里简单说下怎么个部署法。</p><div class=\"language-shell codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token function\" style=\"color:#e6db74\">npm</span><span class=\"token plain\"> run bulid</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>首先执行上一行代码，然后在目录下会生成<code>public</code>文件夹，这个文件夹就是你所有的网站静态文件，这时候你需要你的服务器开启一个 web 服务，我这里用的是腾讯云 CentOS 与宝塔面板（至于这两个怎么搞，外面教程太多了），这里我就用 Nginx。然后如下图添加站点</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200918194540550.png\" alt=\"image-20200918194540550\" class=\"img_ev3q\"></p><p>因个人情况填写域名，FTP，数据库等等，然后通过 ftp 工具直接传文件至站点对应的目录下，然后访问服务器对应的 ip 地址或者个人域名解析就行了。</p><p>不过这个还要手动部署特别麻烦，有没有什么命令能一键部署的，有，这里我推荐一篇文章<a href=\"https://reinness.com/views/technology-sharing/vuepress/auto_deploy.html#index-js\" target=\"_blank\" rel=\"noopener noreferrer\">一键部署到服务器</a>，解决了我当初一直用 ftp 的痛点。不过有个更简单的自动部署脚本，scp2，有兴趣可以自行查阅。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自己搭建遇到的坑\">自己搭建遇到的坑<a class=\"hash-link\" href=\"#自己搭建遇到的坑\" title=\"标题的直接链接\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"图片路径\">图片路径<a class=\"hash-link\" href=\"#图片路径\" title=\"标题的直接链接\">​</a></h3><p>首先就是 markdown 图片相对路径的坑，在写文章的话，如果涉及的本地图片引入，那么默认不操作的，也就是需要配置一下，默认在当前同级文件下，在创建一个文件名相同的文件夹来存放图片，我这里就以 Typora 为例，如图</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20200901180754412.png\" alt=\"image-20200901180754412\" class=\"img_ev3q\"></p><p>其次，Typora 的路径是不带<code>./</code>，在 vuepress 会被编译成绝对路径。需要在前面添加上<code>./</code>，不过主题内已自带插件<code>markdown-it</code>，这个问题无需担心。</p><p>但常常我们的 md 文件名是中文的，这时候相对路径带有中文，但是 vuepress 会将中文路径进行 url 编码，</p><p>不会将你的这些图片编译到静态文件上，所以需要做一些操作</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"解决方法\">解决方法<a class=\"hash-link\" href=\"#解决方法\" title=\"标题的直接链接\">​</a></h4><ol><li>安装 markdown-it-disable-url-encode</li></ol><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">npm i markdown-it-disable-url-encode</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"2\"><li>在.vuepress/config.js 中配置如下</li></ol><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#f8f8f2;--prism-background-color:#272822\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token literal-property property\" style=\"color:#f92672\">markdown</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token function-variable function\" style=\"color:#e6db74\">extendMarkdown</span><span class=\"token operator\" style=\"color:#66d9ef\">:</span><span class=\"token plain\"> </span><span class=\"token parameter\">md</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:#66d9ef\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">      md</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">.</span><span class=\"token method function property-access\" style=\"color:#e6db74\">use</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token function\" style=\"color:#e6db74\">require</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">(</span><span class=\"token string\" style=\"color:#a6e22e\">\"markdown-it-disable-url-encode\"</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">)</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#f8f8f2\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#f8f8f2\">}</span><span class=\"token punctuation\" style=\"color:#f8f8f2\">,</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"复制代码到剪贴板\" title=\"复制\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>现在你用 Typora 就引用本地图片就可以在 vuepress 中完美显示了。</p><blockquote><p>参考 <a href=\"https://segmentfault.com/a/1190000022275001\" target=\"_blank\" rel=\"noopener noreferrer\">Vuepress 图片资源中文路径问题</a> 完美解决上述问题</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"引入-ui-组件库报错\">引入 UI 组件库报错<a class=\"hash-link\" href=\"#引入-ui-组件库报错\" title=\"标题的直接链接\">​</a></h3><p>如果你在该主题使用其他 UI 组件库，如 element，ant design，那么你很有可能会编译失败，官方解释</p><p><img loading=\"lazy\" src=\"https://img.kuizuo.cn/image-20201223042921876.png\" alt=\"image-20201223042921876\" class=\"img_ev3q\"></p><p>解决办法很简单，先删除 node_modules，然后<strong>再安装 ui 组件库</strong>依赖后，再安装其他依赖就行了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"放一些链接\">放一些链接<a class=\"hash-link\" href=\"#放一些链接\" title=\"标题的直接链接\">​</a></h2><p>放一些自己搭建这个博客过程中用到的一些链接地址，主要针对插件安装这些</p><ul><li><a href=\"https://vuepress.vuejs.org/zh/\" target=\"_blank\" rel=\"noopener noreferrer\">VuePress 官网</a></li><li><a href=\"https://vuepress.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">VuePress 社区</a></li><li><a href=\"https://github.com/vuepress/awesome-vuepress\" target=\"_blank\" rel=\"noopener noreferrer\">awesome-vuepress</a></li><li><a href=\"https://vuepress-theme-reco.recoluan.com/\" target=\"_blank\" rel=\"noopener noreferrer\">reco 主题</a></li><li><a href=\"https://blog.csdn.net/sudadaipeng1/article/details/102971008#%e6%b7%bb%e5%8a%a0svg-label%e6%a0%87%e7%ad%be\" target=\"_blank\" rel=\"noopener noreferrer\">一个非常详细的搭建教程</a></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"总结\">总结<a class=\"hash-link\" href=\"#总结\" title=\"标题的直接链接\">​</a></h2><p>就此，就可以好好的编写文章，主题固然方便，快捷搭建博客同时也别光顾这美化博客，注重分享文章，这才是博客的真正意义。reco 的主题也是希望帮助更多的人花更多的时间在内容创作上，而不是博客搭建上。</p><p>在使用 Vuepress 的一段时间，发现他更适合写的是文档，写博客可以，但花里胡哨的点少，比较简约，对于我这种又爱折腾的人来说，后续有可能会借鉴 Hexo 博客的一款主题 butterfly，将其源码复制到目前这个博客上，顺便巩固下自己的前端设计基础。</p><p>但还是要说的，要看自己到底要不要搭建博客，记录与分享文章，别盲目跟从。同时如果搭建博客，请把重心放在创作和笔记上，反复去美化主题对技术的提升远不如一篇有技术性的文章总结。</p><p>最后，希望我所分享的所有内容，正是你目前所遇到的难题，能为你排坑，便足矣。</p>",
            "url": "https://onewhitethreee.github.io/examenEbau/first-blog-is-vuepress",
            "title": "第一个博客搭建之Vuepress",
            "summary": "感谢 vuepress-theme-reco主题与一篇博客使用文章使用 vuepress 构建个人博客",
            "date_modified": "2020-08-30T00:00:00.000Z",
            "author": {
                "name": "愧怍",
                "url": "https://github.com/kuizuo"
            },
            "tags": [
                "blog",
                "vuepress",
                "project"
            ]
        }
    ]
}